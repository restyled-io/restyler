<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- |</span><span>
</span><a name="line-2"></a><span class="hs-comment">-- Module      : Crypto.Hash.Blake2</span><span>
</span><a name="line-3"></a><span class="hs-comment">-- License     : BSD-style</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- Maintainer  : Nicolas Di Prima &lt;nicolas@primetype.co.uk&gt;</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- Stability   : experimental</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- Portability : unknown</span><span>
</span><a name="line-7"></a><span class="hs-comment">--</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- Module containing the binding functions to work with the</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- Blake2</span><span>
</span><a name="line-10"></a><span class="hs-comment">--</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- Implementation based from [RFC7693](https://tools.ietf.org/html/rfc7693)</span><span>
</span><a name="line-12"></a><span class="hs-comment">--</span><span>
</span><a name="line-13"></a><span class="hs-comment">-- Please consider the following when chosing a hash:</span><span>
</span><a name="line-14"></a><span class="hs-comment">--</span><span>
</span><a name="line-15"></a><span class="hs-comment">--      Algorithm     | Target | Collision | Digest Size |</span><span>
</span><a name="line-16"></a><span class="hs-comment">--         Identifier |  Arch  |  Security |   in bytes  |</span><span>
</span><a name="line-17"></a><span class="hs-comment">--     ---------------+--------+-----------+-------------+</span><span>
</span><a name="line-18"></a><span class="hs-comment">--      id-blake2b160 | 64-bit |   2**80   |         20  |</span><span>
</span><a name="line-19"></a><span class="hs-comment">--      id-blake2b256 | 64-bit |   2**128  |         32  |</span><span>
</span><a name="line-20"></a><span class="hs-comment">--      id-blake2b384 | 64-bit |   2**192  |         48  |</span><span>
</span><a name="line-21"></a><span class="hs-comment">--      id-blake2b512 | 64-bit |   2**256  |         64  |</span><span>
</span><a name="line-22"></a><span class="hs-comment">--     ---------------+--------+-----------+-------------+</span><span>
</span><a name="line-23"></a><span class="hs-comment">--      id-blake2s128 | 32-bit |   2**64   |         16  |</span><span>
</span><a name="line-24"></a><span class="hs-comment">--      id-blake2s160 | 32-bit |   2**80   |         20  |</span><span>
</span><a name="line-25"></a><span class="hs-comment">--      id-blake2s224 | 32-bit |   2**112  |         28  |</span><span>
</span><a name="line-26"></a><span class="hs-comment">--      id-blake2s256 | 32-bit |   2**128  |         32  |</span><span>
</span><a name="line-27"></a><span class="hs-comment">--     ---------------+--------+-----------+-------------+</span><span>
</span><a name="line-28"></a><span class="hs-comment">--</span><span>
</span><a name="line-29"></a><span class="hs-pragma">{-# LANGUAGE ForeignFunctionInterface #-}</span><span>
</span><a name="line-30"></a><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable #-}</span><span>
</span><a name="line-31"></a><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><a name="line-32"></a><span class="hs-pragma">{-# LANGUAGE KindSignatures #-}</span><span>
</span><a name="line-33"></a><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><a name="line-34"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><a name="line-35"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Crypto</span><span class="hs-operator">.</span><span class="hs-identifier">Hash</span><span class="hs-operator">.</span><span class="hs-identifier">Blake2</span><span>
</span><a name="line-36"></a><span>    </span><span class="hs-special">(</span><span> </span><a href="Crypto.Hash.Blake2.html#Blake2s"><span class="hs-identifier hs-type">Blake2s</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-37"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Crypto.Hash.Blake2.html#Blake2sp"><span class="hs-identifier hs-type">Blake2sp</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Crypto.Hash.Blake2.html#Blake2b"><span class="hs-identifier hs-type">Blake2b</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Crypto.Hash.Blake2.html#Blake2bp"><span class="hs-identifier hs-type">Blake2bp</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span>           </span><a href="Crypto.Hash.Types.html"><span class="hs-identifier">Crypto</span><span class="hs-operator">.</span><span class="hs-identifier">Hash</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Foreign</span><span class="hs-operator">.</span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ptr</span><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Data</span><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Typeable</span><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Word</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Word8</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Word32</span><span class="hs-special">)</span><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">TypeLits</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Nat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">KnownNat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">natVal</span><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span>           </span><a href="Crypto.Internal.Nat.html"><span class="hs-identifier">Crypto</span><span class="hs-operator">.</span><span class="hs-identifier">Internal</span><span class="hs-operator">.</span><span class="hs-identifier">Nat</span></a><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span class="hs-comment">-- | Fast and secure alternative to SHA1 and HMAC-SHA1</span><span>
</span><a name="line-51"></a><span class="hs-comment">--</span><span>
</span><a name="line-52"></a><span class="hs-comment">-- It is espacially known to target 32bits architectures.</span><span>
</span><a name="line-53"></a><span class="hs-comment">--</span><span>
</span><a name="line-54"></a><span class="hs-comment">-- Known supported digest sizes:</span><span>
</span><a name="line-55"></a><span class="hs-comment">--</span><span>
</span><a name="line-56"></a><span class="hs-comment">-- * Blake2s 160</span><span>
</span><a name="line-57"></a><span class="hs-comment">-- * Blake2s 224</span><span>
</span><a name="line-58"></a><span class="hs-comment">-- * Blake2s 256</span><span>
</span><a name="line-59"></a><span class="hs-comment">--</span><span>
</span><a name="line-60"></a><span class="hs-keyword">data</span><span> </span><a name="Blake2s"><a href="Crypto.Hash.Blake2.html#Blake2s"><span class="hs-identifier">Blake2s</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679092743"><a href="#local-6989586621679092743"><span class="hs-identifier">bitlen</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Nat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="Blake2s"><a href="Crypto.Hash.Blake2.html#Blake2s"><span class="hs-identifier">Blake2s</span></a></a><span>
</span><a name="line-61"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span class="hs-special">)</span><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Crypto.Internal.Nat.html#IsDivisibleBy8"><span class="hs-identifier hs-type">IsDivisibleBy8</span></a><span> </span><a href="#local-6989586621679092753"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">KnownNat</span><span> </span><a href="#local-6989586621679092753"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">,</span><span> </span><a href="Crypto.Internal.Nat.html#IsAtLeast"><span class="hs-identifier hs-type">IsAtLeast</span></a><span> </span><a href="#local-6989586621679092753"><span class="hs-identifier hs-type">bitlen</span></a><span> </span><span class="hs-number">8</span><span class="hs-special">,</span><span> </span><a href="Crypto.Internal.Nat.html#IsAtMost"><span class="hs-identifier hs-type">IsAtMost</span></a><span> </span><a href="#local-6989586621679092753"><span class="hs-identifier hs-type">bitlen</span></a><span> </span><span class="hs-number">256</span><span class="hs-special">)</span><span>
</span><a name="line-64"></a><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a><span> </span><span class="hs-special">(</span><a href="Crypto.Hash.Blake2.html#Blake2s"><span class="hs-identifier hs-type">Blake2s</span></a><span> </span><a href="#local-6989586621679092753"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span>
</span><a name="line-65"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-66"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">HashBlockSize</span><span>           </span><span class="hs-special">(</span><a href="Crypto.Hash.Blake2.html#Blake2s"><span class="hs-identifier hs-type">Blake2s</span></a><span> </span><a href="#local-6989586621679092753"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">64</span><span>
</span><a name="line-67"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">HashDigestSize</span><span>          </span><span class="hs-special">(</span><a href="Crypto.Hash.Blake2.html#Blake2s"><span class="hs-identifier hs-type">Blake2s</span></a><span> </span><a href="#local-6989586621679092753"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Internal.Nat.html#Div8"><span class="hs-identifier hs-type">Div8</span></a><span> </span><a href="#local-6989586621679092753"><span class="hs-identifier hs-type">bitlen</span></a><span>
</span><a name="line-68"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">HashInternalContextSize</span><span> </span><span class="hs-special">(</span><a href="Crypto.Hash.Blake2.html#Blake2s"><span class="hs-identifier hs-type">Blake2s</span></a><span> </span><a href="#local-6989586621679092753"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">136</span><span>
</span><a name="line-69"></a><span>    </span><a name="local-8214565720323816510"><a href="Crypto.Hash.Types.html#hashBlockSize"><span class="hs-identifier">hashBlockSize</span></a></a><span>  </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">64</span><span>
</span><a name="line-70"></a><span>    </span><a name="local-8214565720323816511"><a href="Crypto.Hash.Types.html#hashDigestSize"><span class="hs-identifier">hashDigestSize</span></a></a><span> </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Internal.Nat.html#byteLen"><span class="hs-identifier hs-var">byteLen</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679092753"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span>
</span><a name="line-71"></a><span>    </span><a name="local-8214565720323816512"><a href="Crypto.Hash.Types.html#hashInternalContextSize"><span class="hs-identifier">hashInternalContextSize</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">136</span><span>
</span><a name="line-72"></a><span>    </span><a name="local-8214565720323816513"><a href="Crypto.Hash.Types.html#hashInternalInit"><span class="hs-identifier">hashInternalInit</span></a></a><span> </span><a name="local-6989586621679092754"><a href="#local-6989586621679092754"><span class="hs-identifier">p</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Hash.Blake2.html#c_blake2s_init"><span class="hs-identifier hs-var">c_blake2s_init</span></a><span> </span><a href="#local-6989586621679092754"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="Crypto.Internal.Nat.html#integralNatVal"><span class="hs-identifier hs-var">integralNatVal</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679092753"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-73"></a><span>    </span><a name="local-8214565720323816514"><a href="Crypto.Hash.Types.html#hashInternalUpdate"><span class="hs-identifier">hashInternalUpdate</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Hash.Blake2.html#c_blake2s_update"><span class="hs-identifier hs-var">c_blake2s_update</span></a><span>
</span><a name="line-74"></a><span>    </span><a name="local-8214565720323816515"><a href="Crypto.Hash.Types.html#hashInternalFinalize"><span class="hs-identifier">hashInternalFinalize</span></a></a><span> </span><a name="local-6989586621679092755"><a href="#local-6989586621679092755"><span class="hs-identifier">p</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Hash.Blake2.html#c_blake2s_finalize"><span class="hs-identifier hs-var">c_blake2s_finalize</span></a><span> </span><a href="#local-6989586621679092755"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="Crypto.Internal.Nat.html#integralNatVal"><span class="hs-identifier hs-var">integralNatVal</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679092753"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">ccall</span><span> </span><span class="hs-identifier">unsafe</span><span> </span><span class="hs-string">&quot;cryptonite_blake2s_init&quot;</span><span>
</span><a name="line-77"></a><span>    </span><span class="hs-identifier">c_blake2s_init</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-special">(</span><a href="Crypto.Hash.Types.html#Context"><span class="hs-identifier hs-type">Context</span></a><span> </span><a href="#local-6989586621679092767"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Word32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-78"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">ccall</span><span> </span><span class="hs-string">&quot;cryptonite_blake2s_update&quot;</span><span>
</span><a name="line-79"></a><span>    </span><span class="hs-identifier">c_blake2s_update</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-special">(</span><a href="Crypto.Hash.Types.html#Context"><span class="hs-identifier hs-type">Context</span></a><span> </span><a href="#local-6989586621679092766"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-identifier hs-type">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Word32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-80"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">ccall</span><span> </span><span class="hs-identifier">unsafe</span><span> </span><span class="hs-string">&quot;cryptonite_blake2s_finalize&quot;</span><span>
</span><a name="line-81"></a><span>    </span><span class="hs-identifier">c_blake2s_finalize</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-special">(</span><a href="Crypto.Hash.Types.html#Context"><span class="hs-identifier hs-type">Context</span></a><span> </span><a href="#local-6989586621679092765"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Word32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-special">(</span><a href="Crypto.Hash.Types.html#Digest"><span class="hs-identifier hs-type">Digest</span></a><span> </span><a href="#local-6989586621679092765"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span class="hs-comment">-- | Fast cryptographic hash.</span><span>
</span><a name="line-84"></a><span class="hs-comment">--</span><span>
</span><a name="line-85"></a><span class="hs-comment">-- It is especially known to target 64bits architectures.</span><span>
</span><a name="line-86"></a><span class="hs-comment">--</span><span>
</span><a name="line-87"></a><span class="hs-comment">-- Known supported digest sizes:</span><span>
</span><a name="line-88"></a><span class="hs-comment">--</span><span>
</span><a name="line-89"></a><span class="hs-comment">-- * Blake2b 160</span><span>
</span><a name="line-90"></a><span class="hs-comment">-- * Blake2b 224</span><span>
</span><a name="line-91"></a><span class="hs-comment">-- * Blake2b 256</span><span>
</span><a name="line-92"></a><span class="hs-comment">-- * Blake2b 384</span><span>
</span><a name="line-93"></a><span class="hs-comment">-- * Blake2b 512</span><span>
</span><a name="line-94"></a><span class="hs-comment">--</span><span>
</span><a name="line-95"></a><span class="hs-keyword">data</span><span> </span><a name="Blake2b"><a href="Crypto.Hash.Blake2.html#Blake2b"><span class="hs-identifier">Blake2b</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679092742"><a href="#local-6989586621679092742"><span class="hs-identifier">bitlen</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Nat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="Blake2b"><a href="Crypto.Hash.Blake2.html#Blake2b"><span class="hs-identifier">Blake2b</span></a></a><span>
</span><a name="line-96"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Crypto.Internal.Nat.html#IsDivisibleBy8"><span class="hs-identifier hs-type">IsDivisibleBy8</span></a><span> </span><a href="#local-6989586621679092750"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">KnownNat</span><span> </span><a href="#local-6989586621679092750"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">,</span><span> </span><a href="Crypto.Internal.Nat.html#IsAtLeast"><span class="hs-identifier hs-type">IsAtLeast</span></a><span> </span><a href="#local-6989586621679092750"><span class="hs-identifier hs-type">bitlen</span></a><span> </span><span class="hs-number">8</span><span class="hs-special">,</span><span> </span><a href="Crypto.Internal.Nat.html#IsAtMost"><span class="hs-identifier hs-type">IsAtMost</span></a><span> </span><a href="#local-6989586621679092750"><span class="hs-identifier hs-type">bitlen</span></a><span> </span><span class="hs-number">512</span><span class="hs-special">)</span><span>
</span><a name="line-99"></a><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a><span> </span><span class="hs-special">(</span><a href="Crypto.Hash.Blake2.html#Blake2b"><span class="hs-identifier hs-type">Blake2b</span></a><span> </span><a href="#local-6989586621679092750"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span>
</span><a name="line-100"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-101"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">HashBlockSize</span><span>           </span><span class="hs-special">(</span><a href="Crypto.Hash.Blake2.html#Blake2b"><span class="hs-identifier hs-type">Blake2b</span></a><span> </span><a href="#local-6989586621679092750"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">128</span><span>
</span><a name="line-102"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">HashDigestSize</span><span>          </span><span class="hs-special">(</span><a href="Crypto.Hash.Blake2.html#Blake2b"><span class="hs-identifier hs-type">Blake2b</span></a><span> </span><a href="#local-6989586621679092750"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Internal.Nat.html#Div8"><span class="hs-identifier hs-type">Div8</span></a><span> </span><a href="#local-6989586621679092750"><span class="hs-identifier hs-type">bitlen</span></a><span>
</span><a name="line-103"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">HashInternalContextSize</span><span> </span><span class="hs-special">(</span><a href="Crypto.Hash.Blake2.html#Blake2b"><span class="hs-identifier hs-type">Blake2b</span></a><span> </span><a href="#local-6989586621679092750"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">248</span><span>
</span><a name="line-104"></a><span>    </span><a name="local-8214565720323816510"><a href="Crypto.Hash.Types.html#hashBlockSize"><span class="hs-identifier">hashBlockSize</span></a></a><span>  </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">128</span><span>
</span><a name="line-105"></a><span>    </span><a name="local-8214565720323816511"><a href="Crypto.Hash.Types.html#hashDigestSize"><span class="hs-identifier">hashDigestSize</span></a></a><span> </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Internal.Nat.html#byteLen"><span class="hs-identifier hs-var">byteLen</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679092750"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span>
</span><a name="line-106"></a><span>    </span><a name="local-8214565720323816512"><a href="Crypto.Hash.Types.html#hashInternalContextSize"><span class="hs-identifier">hashInternalContextSize</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">248</span><span>
</span><a name="line-107"></a><span>    </span><a name="local-8214565720323816513"><a href="Crypto.Hash.Types.html#hashInternalInit"><span class="hs-identifier">hashInternalInit</span></a></a><span> </span><a name="local-6989586621679092751"><a href="#local-6989586621679092751"><span class="hs-identifier">p</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Hash.Blake2.html#c_blake2b_init"><span class="hs-identifier hs-var">c_blake2b_init</span></a><span> </span><a href="#local-6989586621679092751"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="Crypto.Internal.Nat.html#integralNatVal"><span class="hs-identifier hs-var">integralNatVal</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679092750"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-108"></a><span>    </span><a name="local-8214565720323816514"><a href="Crypto.Hash.Types.html#hashInternalUpdate"><span class="hs-identifier">hashInternalUpdate</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Hash.Blake2.html#c_blake2b_update"><span class="hs-identifier hs-var">c_blake2b_update</span></a><span>
</span><a name="line-109"></a><span>    </span><a name="local-8214565720323816515"><a href="Crypto.Hash.Types.html#hashInternalFinalize"><span class="hs-identifier">hashInternalFinalize</span></a></a><span> </span><a name="local-6989586621679092752"><a href="#local-6989586621679092752"><span class="hs-identifier">p</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Hash.Blake2.html#c_blake2b_finalize"><span class="hs-identifier hs-var">c_blake2b_finalize</span></a><span> </span><a href="#local-6989586621679092752"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="Crypto.Internal.Nat.html#integralNatVal"><span class="hs-identifier hs-var">integralNatVal</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679092750"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">ccall</span><span> </span><span class="hs-identifier">unsafe</span><span> </span><span class="hs-string">&quot;cryptonite_blake2b_init&quot;</span><span>
</span><a name="line-112"></a><span>    </span><span class="hs-identifier">c_blake2b_init</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-special">(</span><a href="Crypto.Hash.Types.html#Context"><span class="hs-identifier hs-type">Context</span></a><span> </span><a href="#local-6989586621679092764"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Word32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">ccall</span><span> </span><span class="hs-string">&quot;cryptonite_blake2b_update&quot;</span><span>
</span><a name="line-114"></a><span>    </span><span class="hs-identifier">c_blake2b_update</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-special">(</span><a href="Crypto.Hash.Types.html#Context"><span class="hs-identifier hs-type">Context</span></a><span> </span><a href="#local-6989586621679092763"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-identifier hs-type">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Word32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-115"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">ccall</span><span> </span><span class="hs-identifier">unsafe</span><span> </span><span class="hs-string">&quot;cryptonite_blake2b_finalize&quot;</span><span>
</span><a name="line-116"></a><span>    </span><span class="hs-identifier">c_blake2b_finalize</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-special">(</span><a href="Crypto.Hash.Types.html#Context"><span class="hs-identifier hs-type">Context</span></a><span> </span><a href="#local-6989586621679092762"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Word32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-special">(</span><a href="Crypto.Hash.Types.html#Digest"><span class="hs-identifier hs-type">Digest</span></a><span> </span><a href="#local-6989586621679092762"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-keyword">data</span><span> </span><a name="Blake2sp"><a href="Crypto.Hash.Blake2.html#Blake2sp"><span class="hs-identifier">Blake2sp</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679092741"><a href="#local-6989586621679092741"><span class="hs-identifier">bitlen</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Nat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="Blake2sp"><a href="Crypto.Hash.Blake2.html#Blake2sp"><span class="hs-identifier">Blake2sp</span></a></a><span>
</span><a name="line-119"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span class="hs-special">)</span><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Crypto.Internal.Nat.html#IsDivisibleBy8"><span class="hs-identifier hs-type">IsDivisibleBy8</span></a><span> </span><a href="#local-6989586621679092747"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">KnownNat</span><span> </span><a href="#local-6989586621679092747"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">,</span><span> </span><a href="Crypto.Internal.Nat.html#IsAtLeast"><span class="hs-identifier hs-type">IsAtLeast</span></a><span> </span><a href="#local-6989586621679092747"><span class="hs-identifier hs-type">bitlen</span></a><span> </span><span class="hs-number">8</span><span class="hs-special">,</span><span> </span><a href="Crypto.Internal.Nat.html#IsAtMost"><span class="hs-identifier hs-type">IsAtMost</span></a><span> </span><a href="#local-6989586621679092747"><span class="hs-identifier hs-type">bitlen</span></a><span> </span><span class="hs-number">256</span><span class="hs-special">)</span><span>
</span><a name="line-122"></a><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a><span> </span><span class="hs-special">(</span><a href="Crypto.Hash.Blake2.html#Blake2sp"><span class="hs-identifier hs-type">Blake2sp</span></a><span> </span><a href="#local-6989586621679092747"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-124"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">HashBlockSize</span><span>           </span><span class="hs-special">(</span><a href="Crypto.Hash.Blake2.html#Blake2sp"><span class="hs-identifier hs-type">Blake2sp</span></a><span> </span><a href="#local-6989586621679092747"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">64</span><span>
</span><a name="line-125"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">HashDigestSize</span><span>          </span><span class="hs-special">(</span><a href="Crypto.Hash.Blake2.html#Blake2sp"><span class="hs-identifier hs-type">Blake2sp</span></a><span> </span><a href="#local-6989586621679092747"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Internal.Nat.html#Div8"><span class="hs-identifier hs-type">Div8</span></a><span> </span><a href="#local-6989586621679092747"><span class="hs-identifier hs-type">bitlen</span></a><span>
</span><a name="line-126"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">HashInternalContextSize</span><span> </span><span class="hs-special">(</span><a href="Crypto.Hash.Blake2.html#Blake2sp"><span class="hs-identifier hs-type">Blake2sp</span></a><span> </span><a href="#local-6989586621679092747"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2185</span><span>
</span><a name="line-127"></a><span>    </span><a name="local-8214565720323816510"><a href="Crypto.Hash.Types.html#hashBlockSize"><span class="hs-identifier">hashBlockSize</span></a></a><span>  </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">64</span><span>
</span><a name="line-128"></a><span>    </span><a name="local-8214565720323816511"><a href="Crypto.Hash.Types.html#hashDigestSize"><span class="hs-identifier">hashDigestSize</span></a></a><span> </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Internal.Nat.html#byteLen"><span class="hs-identifier hs-var">byteLen</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679092747"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span>    </span><a name="local-8214565720323816512"><a href="Crypto.Hash.Types.html#hashInternalContextSize"><span class="hs-identifier">hashInternalContextSize</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2185</span><span>
</span><a name="line-130"></a><span>    </span><a name="local-8214565720323816513"><a href="Crypto.Hash.Types.html#hashInternalInit"><span class="hs-identifier">hashInternalInit</span></a></a><span> </span><a name="local-6989586621679092748"><a href="#local-6989586621679092748"><span class="hs-identifier">p</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Hash.Blake2.html#c_blake2sp_init"><span class="hs-identifier hs-var">c_blake2sp_init</span></a><span> </span><a href="#local-6989586621679092748"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="Crypto.Internal.Nat.html#integralNatVal"><span class="hs-identifier hs-var">integralNatVal</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679092747"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-131"></a><span>    </span><a name="local-8214565720323816514"><a href="Crypto.Hash.Types.html#hashInternalUpdate"><span class="hs-identifier">hashInternalUpdate</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Hash.Blake2.html#c_blake2sp_update"><span class="hs-identifier hs-var">c_blake2sp_update</span></a><span>
</span><a name="line-132"></a><span>    </span><a name="local-8214565720323816515"><a href="Crypto.Hash.Types.html#hashInternalFinalize"><span class="hs-identifier">hashInternalFinalize</span></a></a><span> </span><a name="local-6989586621679092749"><a href="#local-6989586621679092749"><span class="hs-identifier">p</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Hash.Blake2.html#c_blake2sp_finalize"><span class="hs-identifier hs-var">c_blake2sp_finalize</span></a><span> </span><a href="#local-6989586621679092749"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="Crypto.Internal.Nat.html#integralNatVal"><span class="hs-identifier hs-var">integralNatVal</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679092747"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">ccall</span><span> </span><span class="hs-identifier">unsafe</span><span> </span><span class="hs-string">&quot;cryptonite_blake2sp_init&quot;</span><span>
</span><a name="line-135"></a><span>    </span><span class="hs-identifier">c_blake2sp_init</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-special">(</span><a href="Crypto.Hash.Types.html#Context"><span class="hs-identifier hs-type">Context</span></a><span> </span><a href="#local-6989586621679092761"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Word32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-136"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">ccall</span><span> </span><span class="hs-string">&quot;cryptonite_blake2sp_update&quot;</span><span>
</span><a name="line-137"></a><span>    </span><span class="hs-identifier">c_blake2sp_update</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-special">(</span><a href="Crypto.Hash.Types.html#Context"><span class="hs-identifier hs-type">Context</span></a><span> </span><a href="#local-6989586621679092760"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-identifier hs-type">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Word32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-138"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">ccall</span><span> </span><span class="hs-identifier">unsafe</span><span> </span><span class="hs-string">&quot;cryptonite_blake2sp_finalize&quot;</span><span>
</span><a name="line-139"></a><span>    </span><span class="hs-identifier">c_blake2sp_finalize</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-special">(</span><a href="Crypto.Hash.Types.html#Context"><span class="hs-identifier hs-type">Context</span></a><span> </span><a href="#local-6989586621679092759"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Word32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-special">(</span><a href="Crypto.Hash.Types.html#Digest"><span class="hs-identifier hs-type">Digest</span></a><span> </span><a href="#local-6989586621679092759"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><span class="hs-keyword">data</span><span> </span><a name="Blake2bp"><a href="Crypto.Hash.Blake2.html#Blake2bp"><span class="hs-identifier">Blake2bp</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679092740"><a href="#local-6989586621679092740"><span class="hs-identifier">bitlen</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Nat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="Blake2bp"><a href="Crypto.Hash.Blake2.html#Blake2bp"><span class="hs-identifier">Blake2bp</span></a></a><span>
</span><a name="line-142"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span class="hs-special">)</span><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Crypto.Internal.Nat.html#IsDivisibleBy8"><span class="hs-identifier hs-type">IsDivisibleBy8</span></a><span> </span><a href="#local-6989586621679092744"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">KnownNat</span><span> </span><a href="#local-6989586621679092744"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">,</span><span> </span><a href="Crypto.Internal.Nat.html#IsAtLeast"><span class="hs-identifier hs-type">IsAtLeast</span></a><span> </span><a href="#local-6989586621679092744"><span class="hs-identifier hs-type">bitlen</span></a><span> </span><span class="hs-number">8</span><span class="hs-special">,</span><span> </span><a href="Crypto.Internal.Nat.html#IsAtMost"><span class="hs-identifier hs-type">IsAtMost</span></a><span> </span><a href="#local-6989586621679092744"><span class="hs-identifier hs-type">bitlen</span></a><span> </span><span class="hs-number">512</span><span class="hs-special">)</span><span>
</span><a name="line-145"></a><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a><span> </span><span class="hs-special">(</span><a href="Crypto.Hash.Blake2.html#Blake2bp"><span class="hs-identifier hs-type">Blake2bp</span></a><span> </span><a href="#local-6989586621679092744"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span>
</span><a name="line-146"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-147"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">HashBlockSize</span><span>           </span><span class="hs-special">(</span><a href="Crypto.Hash.Blake2.html#Blake2bp"><span class="hs-identifier hs-type">Blake2bp</span></a><span> </span><a href="#local-6989586621679092744"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">128</span><span>
</span><a name="line-148"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">HashDigestSize</span><span>          </span><span class="hs-special">(</span><a href="Crypto.Hash.Blake2.html#Blake2bp"><span class="hs-identifier hs-type">Blake2bp</span></a><span> </span><a href="#local-6989586621679092744"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Internal.Nat.html#Div8"><span class="hs-identifier hs-type">Div8</span></a><span> </span><a href="#local-6989586621679092744"><span class="hs-identifier hs-type">bitlen</span></a><span>
</span><a name="line-149"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">HashInternalContextSize</span><span> </span><span class="hs-special">(</span><a href="Crypto.Hash.Blake2.html#Blake2bp"><span class="hs-identifier hs-type">Blake2bp</span></a><span> </span><a href="#local-6989586621679092744"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2325</span><span>
</span><a name="line-150"></a><span>    </span><a name="local-8214565720323816510"><a href="Crypto.Hash.Types.html#hashBlockSize"><span class="hs-identifier">hashBlockSize</span></a></a><span>  </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">128</span><span>
</span><a name="line-151"></a><span>    </span><a name="local-8214565720323816511"><a href="Crypto.Hash.Types.html#hashDigestSize"><span class="hs-identifier">hashDigestSize</span></a></a><span> </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Internal.Nat.html#byteLen"><span class="hs-identifier hs-var">byteLen</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679092744"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span>
</span><a name="line-152"></a><span>    </span><a name="local-8214565720323816512"><a href="Crypto.Hash.Types.html#hashInternalContextSize"><span class="hs-identifier">hashInternalContextSize</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2325</span><span>
</span><a name="line-153"></a><span>    </span><a name="local-8214565720323816513"><a href="Crypto.Hash.Types.html#hashInternalInit"><span class="hs-identifier">hashInternalInit</span></a></a><span> </span><a name="local-6989586621679092745"><a href="#local-6989586621679092745"><span class="hs-identifier">p</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Hash.Blake2.html#c_blake2bp_init"><span class="hs-identifier hs-var">c_blake2bp_init</span></a><span> </span><a href="#local-6989586621679092745"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="Crypto.Internal.Nat.html#integralNatVal"><span class="hs-identifier hs-var">integralNatVal</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679092744"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-154"></a><span>    </span><a name="local-8214565720323816514"><a href="Crypto.Hash.Types.html#hashInternalUpdate"><span class="hs-identifier">hashInternalUpdate</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Hash.Blake2.html#c_blake2bp_update"><span class="hs-identifier hs-var">c_blake2bp_update</span></a><span>
</span><a name="line-155"></a><span>    </span><a name="local-8214565720323816515"><a href="Crypto.Hash.Types.html#hashInternalFinalize"><span class="hs-identifier">hashInternalFinalize</span></a></a><span> </span><a name="local-6989586621679092746"><a href="#local-6989586621679092746"><span class="hs-identifier">p</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Crypto.Hash.Blake2.html#c_blake2bp_finalize"><span class="hs-identifier hs-var">c_blake2bp_finalize</span></a><span> </span><a href="#local-6989586621679092746"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="Crypto.Internal.Nat.html#integralNatVal"><span class="hs-identifier hs-var">integralNatVal</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679092744"><span class="hs-identifier hs-type">bitlen</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span>
</span><a name="line-158"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">ccall</span><span> </span><span class="hs-identifier">unsafe</span><span> </span><span class="hs-string">&quot;cryptonite_blake2bp_init&quot;</span><span>
</span><a name="line-159"></a><span>    </span><span class="hs-identifier">c_blake2bp_init</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-special">(</span><a href="Crypto.Hash.Types.html#Context"><span class="hs-identifier hs-type">Context</span></a><span> </span><a href="#local-6989586621679092758"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Word32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-160"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">ccall</span><span> </span><span class="hs-string">&quot;cryptonite_blake2bp_update&quot;</span><span>
</span><a name="line-161"></a><span>    </span><span class="hs-identifier">c_blake2bp_update</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-special">(</span><a href="Crypto.Hash.Types.html#Context"><span class="hs-identifier hs-type">Context</span></a><span> </span><a href="#local-6989586621679092757"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-identifier hs-type">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Word32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-162"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">ccall</span><span> </span><span class="hs-identifier">unsafe</span><span> </span><span class="hs-string">&quot;cryptonite_blake2bp_finalize&quot;</span><span>
</span><a name="line-163"></a><span>    </span><span class="hs-identifier">c_blake2bp_finalize</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-special">(</span><a href="Crypto.Hash.Types.html#Context"><span class="hs-identifier hs-type">Context</span></a><span> </span><a href="#local-6989586621679092756"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Word32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-special">(</span><a href="Crypto.Hash.Types.html#Digest"><span class="hs-identifier hs-type">Digest</span></a><span> </span><a href="#local-6989586621679092756"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-164"></a></pre></body></html>