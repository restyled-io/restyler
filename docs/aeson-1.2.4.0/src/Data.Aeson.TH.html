<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# LANGUAGE NoImplicitPrelude #-}</span><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><a name="line-7"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 800</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- a) THQ works on cross-compilers and unregisterised GHCs</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- b) may make compilation faster as no dynamic loading is ever needed (not sure about this)</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- c) removes one hindrance to have code inferred as SafeHaskell safe</span><span>
</span><a name="line-11"></a><span class="hs-pragma">{-# LANGUAGE TemplateHaskellQuotes #-}</span><span>
</span><a name="line-12"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-13"></a><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><a name="line-14"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span class="hs-cpp">#include &quot;incoherent-compat.h&quot;</span><span>
</span><a name="line-17"></a><span class="hs-cpp">#include &quot;overlapping-compat.h&quot;</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-comment">{-|
Module:      Data.Aeson.TH
Copyright:   (c) 2011-2016 Bryan O'Sullivan
             (c) 2011 MailRank, Inc.
License:     BSD3
Stability:   experimental
Portability: portable

Functions to mechanically derive 'ToJSON' and 'FromJSON' instances. Note that
you need to enable the @TemplateHaskell@ language extension in order to use this
module.

An example shows how instances are generated for arbitrary data types. First we
define a data type:

@
data D a = Nullary
         | Unary Int
         | Product String Char a
         | Record { testOne   :: Double
                  , testTwo   :: Bool
                  , testThree :: D a
                  } deriving Eq
@

Next we derive the necessary instances. Note that we make use of the
feature to change record field names. In this case we drop the first 4
characters of every field name. We also modify constructor names by
lower-casing them:

@
$('deriveJSON' 'defaultOptions'{'fieldLabelModifier' = 'drop' 4, 'constructorTagModifier' = map toLower} ''D)
@

Now we can use the newly created instances.

@
d :: D 'Int'
d = Record { testOne = 3.14159
           , testTwo = 'True'
           , testThree = Product \&quot;test\&quot; \'A\' 123
           }
@

&gt;&gt;&gt; fromJSON (toJSON d) == Success d
&gt; True

This also works for data family instances, but instead of passing in the data
family name (with double quotes), we pass in a data family instance
constructor (with a single quote):

@
data family DF a
data instance DF Int = DF1 Int
                     | DF2 Int Int
                     deriving Eq

$('deriveJSON' 'defaultOptions' 'DF1)
-- Alternatively, one could pass 'DF2 instead
@

Please note that you can derive instances for tuples using the following syntax:

@
-- FromJSON and ToJSON instances for 4-tuples.
$('deriveJSON' 'defaultOptions' ''(,,,))
@

-}</span><span>
</span><a name="line-88"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Aeson</span><span class="hs-operator">.</span><span class="hs-identifier">TH</span><span>
</span><a name="line-89"></a><span>    </span><span class="hs-special">(</span><span>
</span><a name="line-90"></a><span>      </span><span class="hs-comment">-- * Encoding configuration</span><span>
</span><a name="line-91"></a><span>      </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-92"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.Types.Internal.html#SumEncoding"><span class="hs-identifier hs-type">SumEncoding</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-93"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.Types.Internal.html#defaultOptions"><span class="hs-identifier hs-var">defaultOptions</span></a><span>
</span><a name="line-94"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.Types.Internal.html#defaultTaggedObject"><span class="hs-identifier hs-var">defaultTaggedObject</span></a><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span>     </span><span class="hs-comment">-- * FromJSON and ToJSON derivation</span><span>
</span><a name="line-97"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.TH.html#deriveJSON"><span class="hs-identifier hs-var">deriveJSON</span></a><span>
</span><a name="line-98"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.TH.html#deriveJSON1"><span class="hs-identifier hs-var">deriveJSON1</span></a><span>
</span><a name="line-99"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.TH.html#deriveJSON2"><span class="hs-identifier hs-var">deriveJSON2</span></a><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.TH.html#deriveToJSON"><span class="hs-identifier hs-var">deriveToJSON</span></a><span>
</span><a name="line-102"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.TH.html#deriveToJSON1"><span class="hs-identifier hs-var">deriveToJSON1</span></a><span>
</span><a name="line-103"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.TH.html#deriveToJSON2"><span class="hs-identifier hs-var">deriveToJSON2</span></a><span>
</span><a name="line-104"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.TH.html#deriveFromJSON"><span class="hs-identifier hs-var">deriveFromJSON</span></a><span>
</span><a name="line-105"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.TH.html#deriveFromJSON1"><span class="hs-identifier hs-var">deriveFromJSON1</span></a><span>
</span><a name="line-106"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.TH.html#deriveFromJSON2"><span class="hs-identifier hs-var">deriveFromJSON2</span></a><span>
</span><a name="line-107"></a><span>
</span><a name="line-108"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.TH.html#mkToJSON"><span class="hs-identifier hs-var">mkToJSON</span></a><span>
</span><a name="line-109"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.TH.html#mkLiftToJSON"><span class="hs-identifier hs-var">mkLiftToJSON</span></a><span>
</span><a name="line-110"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.TH.html#mkLiftToJSON2"><span class="hs-identifier hs-var">mkLiftToJSON2</span></a><span>
</span><a name="line-111"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.TH.html#mkToEncoding"><span class="hs-identifier hs-var">mkToEncoding</span></a><span>
</span><a name="line-112"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.TH.html#mkLiftToEncoding"><span class="hs-identifier hs-var">mkLiftToEncoding</span></a><span>
</span><a name="line-113"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.TH.html#mkLiftToEncoding2"><span class="hs-identifier hs-var">mkLiftToEncoding2</span></a><span>
</span><a name="line-114"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.TH.html#mkParseJSON"><span class="hs-identifier hs-var">mkParseJSON</span></a><span>
</span><a name="line-115"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.TH.html#mkLiftParseJSON"><span class="hs-identifier hs-var">mkLiftParseJSON</span></a><span>
</span><a name="line-116"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.TH.html#mkLiftParseJSON2"><span class="hs-identifier hs-var">mkLiftParseJSON2</span></a><span>
</span><a name="line-117"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-120"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span class="hs-operator">.</span><span class="hs-identifier">Compat</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">exp</span><span class="hs-special">)</span><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;|&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Aeson.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Aeson</span></a><span> </span><span class="hs-special">(</span><a href="Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-type">Object</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">.=</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.Types.FromJSON.html#.%3A"><span class="hs-operator hs-var">.:</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.Types.FromJSON.html#FromJSON"><span class="hs-identifier hs-type">FromJSON</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.Types.FromJSON.html#FromJSON1"><span class="hs-identifier hs-type">FromJSON1</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.Types.FromJSON.html#FromJSON2"><span class="hs-identifier hs-type">FromJSON2</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.Types.ToJSON.html#ToJSON"><span class="hs-identifier hs-type">ToJSON</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.Types.ToJSON.html#ToJSON1"><span class="hs-identifier hs-type">ToJSON1</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.Types.ToJSON.html#ToJSON2"><span class="hs-identifier hs-type">ToJSON2</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-124"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Aeson.Types.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Aeson</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span> </span><span class="hs-special">(</span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.Types.Internal.html#Parser"><span class="hs-identifier hs-type">Parser</span></a><span class="hs-special">,</span><span> </span><a href="Data.Aeson.Types.Internal.html#SumEncoding"><span class="hs-identifier hs-type">SumEncoding</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.Types.Internal.html#defaultOptions"><span class="hs-identifier hs-var">defaultOptions</span></a><span class="hs-special">,</span><span> </span><a href="Data.Aeson.Types.Internal.html#defaultTaggedObject"><span class="hs-identifier hs-var">defaultTaggedObject</span></a><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Aeson.Types.Internal.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Aeson</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span><span class="hs-operator">.</span><span class="hs-identifier">Internal</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Data.Aeson.Types.Internal.html#%3C%3F%3E"><span class="hs-operator hs-var">&lt;?&gt;</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.Types.Internal.html#JSONPathElement"><span class="hs-identifier hs-type">JSONPathElement</span></a><span class="hs-special">(</span><a href="Data.Aeson.Types.Internal.html#Key"><span class="hs-identifier hs-var">Key</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-126"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Aeson.Types.FromJSON.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Aeson</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span><span class="hs-operator">.</span><span class="hs-identifier">FromJSON</span></a><span> </span><span class="hs-special">(</span><a href="Data.Aeson.Types.FromJSON.html#parseOptionalFieldWith"><span class="hs-identifier hs-var">parseOptionalFieldWith</span></a><span class="hs-special">)</span><span>
</span><a name="line-127"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">liftM2</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">unless</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">when</span><span class="hs-special">)</span><span>
</span><a name="line-128"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Foldable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldr'</span><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span class="hs-cpp">#if MIN_VERSION_template_haskell(2,8,0) &amp;&amp; !MIN_VERSION_template_haskell(2,10,0)</span><span>
</span><a name="line-130"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">nub</span><span class="hs-special">)</span><span>
</span><a name="line-131"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-132"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldl'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">genericLength</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">intercalate</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">partition</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">union</span><span class="hs-special">)</span><span>
</span><a name="line-133"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span class="hs-operator">.</span><span class="hs-identifier">NonEmpty</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;|</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">NonEmpty</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">:|</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-134"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span class="hs-special">)</span><span>
</span><a name="line-135"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">catMaybes</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mapMaybe</span><span class="hs-special">)</span><span>
</span><a name="line-136"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Set</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span class="hs-special">)</span><span>
</span><a name="line-137"></a><span class="hs-cpp">#if MIN_VERSION_template_haskell(2,8,0)</span><span>
</span><a name="line-138"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">TH</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Arity</span><span class="hs-special">)</span><span>
</span><a name="line-139"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-140"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">TH</span><span>
</span><a name="line-141"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-142"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">TH</span><span class="hs-operator">.</span><span class="hs-identifier">Datatype</span><span>
</span><a name="line-143"></a><span class="hs-cpp">#if MIN_VERSION_template_haskell(2,7,0) &amp;&amp; !(MIN_VERSION_template_haskell(2,8,0))</span><span>
</span><a name="line-144"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">TH</span><span class="hs-operator">.</span><span class="hs-identifier">Lib</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">starK</span><span class="hs-special">)</span><span>
</span><a name="line-145"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-146"></a><span class="hs-cpp">#if MIN_VERSION_template_haskell(2,8,0) &amp;&amp; !(MIN_VERSION_template_haskell(2,10,0))</span><span>
</span><a name="line-147"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Language</span><span class="hs-operator">.</span><span class="hs-identifier">Haskell</span><span class="hs-operator">.</span><span class="hs-identifier">TH</span><span class="hs-operator">.</span><span class="hs-identifier">Syntax</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkNameG_tc</span><span class="hs-special">)</span><span>
</span><a name="line-148"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-149"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Printf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">printf</span><span class="hs-special">)</span><span>
</span><a name="line-150"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Data.Aeson.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Aeson</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">A</span><span>
</span><a name="line-151"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Data.Aeson.Encoding.Internal.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Aeson</span><span class="hs-operator">.</span><span class="hs-identifier">Encoding</span><span class="hs-operator">.</span><span class="hs-identifier">Internal</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">E</span><span>
</span><a name="line-152"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Foldable</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">F</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">all</span><span class="hs-special">)</span><span>
</span><a name="line-153"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">HashMap</span><span class="hs-operator">.</span><span class="hs-identifier">Strict</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">H</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">lookup</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">toList</span><span class="hs-special">)</span><span>
</span><a name="line-154"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span class="hs-operator">.</span><span class="hs-identifier">NonEmpty</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">NE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">reverse</span><span class="hs-special">)</span><span>
</span><a name="line-155"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">M</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromList</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">keys</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">lookup</span><span> </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">singleton</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">size</span><span class="hs-special">)</span><span>
</span><a name="line-156"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Semigroup</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Semigroup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Option</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-157"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Set</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Set</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">empty</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">insert</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">member</span><span class="hs-special">)</span><span>
</span><a name="line-158"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Text</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">pack</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">unpack</span><span class="hs-special">)</span><span>
</span><a name="line-159"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Vector</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">V</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unsafeIndex</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">null</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">length</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">create</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">empty</span><span class="hs-special">)</span><span>
</span><a name="line-160"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Vector</span><span class="hs-operator">.</span><span class="hs-identifier">Mutable</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">VM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unsafeNew</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">unsafeWrite</span><span class="hs-special">)</span><span>
</span><a name="line-161"></a><span>
</span><a name="line-162"></a><span class="hs-pragma">{-# ANN module &quot;Hlint: ignore Reduce duplication&quot; #-}</span><span>
</span><a name="line-163"></a><span>
</span><a name="line-164"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-165"></a><span class="hs-comment">-- Convenience</span><span>
</span><a name="line-166"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-167"></a><span>
</span><a name="line-168"></a><span class="hs-comment">-- | Generates both 'ToJSON' and 'FromJSON' instance declarations for the given</span><span>
</span><a name="line-169"></a><span class="hs-comment">-- data type or data family instance constructor.</span><span>
</span><a name="line-170"></a><span class="hs-comment">--</span><span>
</span><a name="line-171"></a><span class="hs-comment">-- This is a convienience function which is equivalent to calling both</span><span>
</span><a name="line-172"></a><span class="hs-comment">-- 'deriveToJSON' and 'deriveFromJSON'.</span><span>
</span><a name="line-173"></a><span class="hs-identifier">deriveJSON</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span>
</span><a name="line-174"></a><span>           </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-175"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-176"></a><span>           </span><span class="hs-comment">-- ^ Name of the type for which to generate 'ToJSON' and 'FromJSON'</span><span>
</span><a name="line-177"></a><span>           </span><span class="hs-comment">-- instances.</span><span>
</span><a name="line-178"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-179"></a><a name="deriveJSON"><a href="Data.Aeson.TH.html#deriveJSON"><span class="hs-identifier">deriveJSON</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#deriveJSONBoth"><span class="hs-identifier hs-var">deriveJSONBoth</span></a><span> </span><a href="Data.Aeson.TH.html#deriveToJSON"><span class="hs-identifier hs-var">deriveToJSON</span></a><span> </span><a href="Data.Aeson.TH.html#deriveFromJSON"><span class="hs-identifier hs-var">deriveFromJSON</span></a><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span class="hs-comment">-- | Generates both 'ToJSON1' and 'FromJSON1' instance declarations for the given</span><span>
</span><a name="line-182"></a><span class="hs-comment">-- data type or data family instance constructor.</span><span>
</span><a name="line-183"></a><span class="hs-comment">--</span><span>
</span><a name="line-184"></a><span class="hs-comment">-- This is a convienience function which is equivalent to calling both</span><span>
</span><a name="line-185"></a><span class="hs-comment">-- 'deriveToJSON1' and 'deriveFromJSON1'.</span><span>
</span><a name="line-186"></a><span class="hs-identifier">deriveJSON1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span>
</span><a name="line-187"></a><span>            </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-188"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-189"></a><span>            </span><span class="hs-comment">-- ^ Name of the type for which to generate 'ToJSON1' and 'FromJSON1'</span><span>
</span><a name="line-190"></a><span>            </span><span class="hs-comment">-- instances.</span><span>
</span><a name="line-191"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-192"></a><a name="deriveJSON1"><a href="Data.Aeson.TH.html#deriveJSON1"><span class="hs-identifier">deriveJSON1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#deriveJSONBoth"><span class="hs-identifier hs-var">deriveJSONBoth</span></a><span> </span><a href="Data.Aeson.TH.html#deriveToJSON1"><span class="hs-identifier hs-var">deriveToJSON1</span></a><span> </span><a href="Data.Aeson.TH.html#deriveFromJSON1"><span class="hs-identifier hs-var">deriveFromJSON1</span></a><span>
</span><a name="line-193"></a><span>
</span><a name="line-194"></a><span class="hs-comment">-- | Generates both 'ToJSON2' and 'FromJSON2' instance declarations for the given</span><span>
</span><a name="line-195"></a><span class="hs-comment">-- data type or data family instance constructor.</span><span>
</span><a name="line-196"></a><span class="hs-comment">--</span><span>
</span><a name="line-197"></a><span class="hs-comment">-- This is a convienience function which is equivalent to calling both</span><span>
</span><a name="line-198"></a><span class="hs-comment">-- 'deriveToJSON2' and 'deriveFromJSON2'.</span><span>
</span><a name="line-199"></a><span class="hs-identifier">deriveJSON2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span>
</span><a name="line-200"></a><span>            </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-201"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-202"></a><span>            </span><span class="hs-comment">-- ^ Name of the type for which to generate 'ToJSON2' and 'FromJSON2'</span><span>
</span><a name="line-203"></a><span>            </span><span class="hs-comment">-- instances.</span><span>
</span><a name="line-204"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-205"></a><a name="deriveJSON2"><a href="Data.Aeson.TH.html#deriveJSON2"><span class="hs-identifier">deriveJSON2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#deriveJSONBoth"><span class="hs-identifier hs-var">deriveJSONBoth</span></a><span> </span><a href="Data.Aeson.TH.html#deriveToJSON2"><span class="hs-identifier hs-var">deriveToJSON2</span></a><span> </span><a href="Data.Aeson.TH.html#deriveFromJSON2"><span class="hs-identifier hs-var">deriveFromJSON2</span></a><span>
</span><a name="line-206"></a><span>
</span><a name="line-207"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-208"></a><span class="hs-comment">-- ToJSON</span><span>
</span><a name="line-209"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-210"></a><span>
</span><a name="line-211"></a><span class="hs-comment">{-
TODO: Don't constrain phantom type variables.

data Foo a = Foo Int
instance (ToJSON a) &#8658; ToJSON Foo where ...

The above (ToJSON a) constraint is not necessary and perhaps undesirable.
-}</span><span>
</span><a name="line-219"></a><span>
</span><a name="line-220"></a><span class="hs-comment">-- | Generates a 'ToJSON' instance declaration for the given data type or</span><span>
</span><a name="line-221"></a><span class="hs-comment">-- data family instance constructor.</span><span>
</span><a name="line-222"></a><span class="hs-identifier">deriveToJSON</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span>
</span><a name="line-223"></a><span>             </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-224"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-225"></a><span>             </span><span class="hs-comment">-- ^ Name of the type for which to generate a 'ToJSON' instance</span><span>
</span><a name="line-226"></a><span>             </span><span class="hs-comment">-- declaration.</span><span>
</span><a name="line-227"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-228"></a><a name="deriveToJSON"><a href="Data.Aeson.TH.html#deriveToJSON"><span class="hs-identifier">deriveToJSON</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#deriveToJSONCommon"><span class="hs-identifier hs-var">deriveToJSONCommon</span></a><span> </span><a href="Data.Aeson.TH.html#toJSONClass"><span class="hs-identifier hs-var">toJSONClass</span></a><span>
</span><a name="line-229"></a><span>
</span><a name="line-230"></a><span class="hs-comment">-- | Generates a 'ToJSON1' instance declaration for the given data type or</span><span>
</span><a name="line-231"></a><span class="hs-comment">-- data family instance constructor.</span><span>
</span><a name="line-232"></a><span class="hs-identifier">deriveToJSON1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span>
</span><a name="line-233"></a><span>              </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-234"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-235"></a><span>              </span><span class="hs-comment">-- ^ Name of the type for which to generate a 'ToJSON1' instance</span><span>
</span><a name="line-236"></a><span>              </span><span class="hs-comment">-- declaration.</span><span>
</span><a name="line-237"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-238"></a><a name="deriveToJSON1"><a href="Data.Aeson.TH.html#deriveToJSON1"><span class="hs-identifier">deriveToJSON1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#deriveToJSONCommon"><span class="hs-identifier hs-var">deriveToJSONCommon</span></a><span> </span><a href="Data.Aeson.TH.html#toJSON1Class"><span class="hs-identifier hs-var">toJSON1Class</span></a><span>
</span><a name="line-239"></a><span>
</span><a name="line-240"></a><span class="hs-comment">-- | Generates a 'ToJSON2' instance declaration for the given data type or</span><span>
</span><a name="line-241"></a><span class="hs-comment">-- data family instance constructor.</span><span>
</span><a name="line-242"></a><span class="hs-identifier">deriveToJSON2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span>
</span><a name="line-243"></a><span>              </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-244"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-245"></a><span>              </span><span class="hs-comment">-- ^ Name of the type for which to generate a 'ToJSON2' instance</span><span>
</span><a name="line-246"></a><span>              </span><span class="hs-comment">-- declaration.</span><span>
</span><a name="line-247"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-248"></a><a name="deriveToJSON2"><a href="Data.Aeson.TH.html#deriveToJSON2"><span class="hs-identifier">deriveToJSON2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#deriveToJSONCommon"><span class="hs-identifier hs-var">deriveToJSONCommon</span></a><span> </span><a href="Data.Aeson.TH.html#toJSON2Class"><span class="hs-identifier hs-var">toJSON2Class</span></a><span>
</span><a name="line-249"></a><span>
</span><a name="line-250"></a><span class="hs-identifier">deriveToJSONCommon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span>
</span><a name="line-251"></a><span>                   </span><span class="hs-comment">-- ^ The ToJSON variant being derived.</span><span>
</span><a name="line-252"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span>
</span><a name="line-253"></a><span>                   </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-254"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-255"></a><span>                   </span><span class="hs-comment">-- ^ Name of the type for which to generate an instance.</span><span>
</span><a name="line-256"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-257"></a><a name="deriveToJSONCommon"><a href="Data.Aeson.TH.html#deriveToJSONCommon"><span class="hs-identifier">deriveToJSONCommon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#deriveJSONClass"><span class="hs-identifier hs-var">deriveJSONClass</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#ToJSON"><span class="hs-identifier hs-var">ToJSON</span></a><span class="hs-special">,</span><span>     </span><span class="hs-glyph">\</span><a name="local-6989586621679151311"><a href="#local-6989586621679151311"><span class="hs-identifier">jc</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#consToValue"><span class="hs-identifier hs-var">consToValue</span></a><span> </span><a href="Data.Aeson.TH.html#Value"><span class="hs-identifier hs-var">Value</span></a><span> </span><a href="#local-6989586621679151311"><span class="hs-identifier hs-var">jc</span></a><span class="hs-special">)</span><span>
</span><a name="line-258"></a><span>                                     </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#ToEncoding"><span class="hs-identifier hs-var">ToEncoding</span></a><span class="hs-special">,</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679151312"><a href="#local-6989586621679151312"><span class="hs-identifier">jc</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#consToValue"><span class="hs-identifier hs-var">consToValue</span></a><span> </span><a href="Data.Aeson.TH.html#Encoding"><span class="hs-identifier hs-var">Encoding</span></a><span> </span><a href="#local-6989586621679151312"><span class="hs-identifier hs-var">jc</span></a><span class="hs-special">)</span><span>
</span><a name="line-259"></a><span>                                     </span><span class="hs-special">]</span><span>
</span><a name="line-260"></a><span>
</span><a name="line-261"></a><span class="hs-comment">-- | Generates a lambda expression which encodes the given data type or</span><span>
</span><a name="line-262"></a><span class="hs-comment">-- data family instance constructor as a 'Value'.</span><span>
</span><a name="line-263"></a><span class="hs-identifier">mkToJSON</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-264"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-comment">-- ^ Name of the type to encode.</span><span>
</span><a name="line-265"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-266"></a><a name="mkToJSON"><a href="Data.Aeson.TH.html#mkToJSON"><span class="hs-identifier">mkToJSON</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#mkToJSONCommon"><span class="hs-identifier hs-var">mkToJSONCommon</span></a><span> </span><a href="Data.Aeson.TH.html#toJSONClass"><span class="hs-identifier hs-var">toJSONClass</span></a><span>
</span><a name="line-267"></a><span>
</span><a name="line-268"></a><span class="hs-comment">-- | Generates a lambda expression which encodes the given data type or</span><span>
</span><a name="line-269"></a><span class="hs-comment">-- data family instance constructor as a 'Value' by using the given encoding</span><span>
</span><a name="line-270"></a><span class="hs-comment">-- function on occurrences of the last type parameter.</span><span>
</span><a name="line-271"></a><span class="hs-identifier">mkLiftToJSON</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-272"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-comment">-- ^ Name of the type to encode.</span><span>
</span><a name="line-273"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-274"></a><a name="mkLiftToJSON"><a href="Data.Aeson.TH.html#mkLiftToJSON"><span class="hs-identifier">mkLiftToJSON</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#mkToJSONCommon"><span class="hs-identifier hs-var">mkToJSONCommon</span></a><span> </span><a href="Data.Aeson.TH.html#toJSON1Class"><span class="hs-identifier hs-var">toJSON1Class</span></a><span>
</span><a name="line-275"></a><span>
</span><a name="line-276"></a><span class="hs-comment">-- | Generates a lambda expression which encodes the given data type or</span><span>
</span><a name="line-277"></a><span class="hs-comment">-- data family instance constructor as a 'Value' by using the given encoding</span><span>
</span><a name="line-278"></a><span class="hs-comment">-- functions on occurrences of the last two type parameters.</span><span>
</span><a name="line-279"></a><span class="hs-identifier">mkLiftToJSON2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-280"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-comment">-- ^ Name of the type to encode.</span><span>
</span><a name="line-281"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-282"></a><a name="mkLiftToJSON2"><a href="Data.Aeson.TH.html#mkLiftToJSON2"><span class="hs-identifier">mkLiftToJSON2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#mkToJSONCommon"><span class="hs-identifier hs-var">mkToJSONCommon</span></a><span> </span><a href="Data.Aeson.TH.html#toJSON2Class"><span class="hs-identifier hs-var">toJSON2Class</span></a><span>
</span><a name="line-283"></a><span>
</span><a name="line-284"></a><span class="hs-identifier">mkToJSONCommon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span> </span><span class="hs-comment">-- ^ Which class's method is being derived.</span><span>
</span><a name="line-285"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-286"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-comment">-- ^ Name of the encoded type.</span><span>
</span><a name="line-287"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-288"></a><a name="mkToJSONCommon"><a href="Data.Aeson.TH.html#mkToJSONCommon"><span class="hs-identifier">mkToJSONCommon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#mkFunCommon"><span class="hs-identifier hs-var">mkFunCommon</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679151313"><a href="#local-6989586621679151313"><span class="hs-identifier">jc</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#consToValue"><span class="hs-identifier hs-var">consToValue</span></a><span> </span><a href="Data.Aeson.TH.html#Value"><span class="hs-identifier hs-var">Value</span></a><span> </span><a href="#local-6989586621679151313"><span class="hs-identifier hs-var">jc</span></a><span class="hs-special">)</span><span>
</span><a name="line-289"></a><span>
</span><a name="line-290"></a><span class="hs-comment">-- | Generates a lambda expression which encodes the given data type or</span><span>
</span><a name="line-291"></a><span class="hs-comment">-- data family instance constructor as a JSON string.</span><span>
</span><a name="line-292"></a><span class="hs-identifier">mkToEncoding</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-293"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-comment">-- ^ Name of the type to encode.</span><span>
</span><a name="line-294"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-295"></a><a name="mkToEncoding"><a href="Data.Aeson.TH.html#mkToEncoding"><span class="hs-identifier">mkToEncoding</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#mkToEncodingCommon"><span class="hs-identifier hs-var">mkToEncodingCommon</span></a><span> </span><a href="Data.Aeson.TH.html#toJSONClass"><span class="hs-identifier hs-var">toJSONClass</span></a><span>
</span><a name="line-296"></a><span>
</span><a name="line-297"></a><span class="hs-comment">-- | Generates a lambda expression which encodes the given data type or</span><span>
</span><a name="line-298"></a><span class="hs-comment">-- data family instance constructor as a JSON string by using the given encoding</span><span>
</span><a name="line-299"></a><span class="hs-comment">-- function on occurrences of the last type parameter.</span><span>
</span><a name="line-300"></a><span class="hs-identifier">mkLiftToEncoding</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-301"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-comment">-- ^ Name of the type to encode.</span><span>
</span><a name="line-302"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-303"></a><a name="mkLiftToEncoding"><a href="Data.Aeson.TH.html#mkLiftToEncoding"><span class="hs-identifier">mkLiftToEncoding</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#mkToEncodingCommon"><span class="hs-identifier hs-var">mkToEncodingCommon</span></a><span> </span><a href="Data.Aeson.TH.html#toJSON1Class"><span class="hs-identifier hs-var">toJSON1Class</span></a><span>
</span><a name="line-304"></a><span>
</span><a name="line-305"></a><span class="hs-comment">-- | Generates a lambda expression which encodes the given data type or</span><span>
</span><a name="line-306"></a><span class="hs-comment">-- data family instance constructor as a JSON string by using the given encoding</span><span>
</span><a name="line-307"></a><span class="hs-comment">-- functions on occurrences of the last two type parameters.</span><span>
</span><a name="line-308"></a><span class="hs-identifier">mkLiftToEncoding2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-309"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-comment">-- ^ Name of the type to encode.</span><span>
</span><a name="line-310"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-311"></a><a name="mkLiftToEncoding2"><a href="Data.Aeson.TH.html#mkLiftToEncoding2"><span class="hs-identifier">mkLiftToEncoding2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#mkToEncodingCommon"><span class="hs-identifier hs-var">mkToEncodingCommon</span></a><span> </span><a href="Data.Aeson.TH.html#toJSON2Class"><span class="hs-identifier hs-var">toJSON2Class</span></a><span>
</span><a name="line-312"></a><span>
</span><a name="line-313"></a><span class="hs-identifier">mkToEncodingCommon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span> </span><span class="hs-comment">-- ^ Which class's method is being derived.</span><span>
</span><a name="line-314"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-315"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-comment">-- ^ Name of the encoded type.</span><span>
</span><a name="line-316"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-317"></a><a name="mkToEncodingCommon"><a href="Data.Aeson.TH.html#mkToEncodingCommon"><span class="hs-identifier">mkToEncodingCommon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#mkFunCommon"><span class="hs-identifier hs-var">mkFunCommon</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679151314"><a href="#local-6989586621679151314"><span class="hs-identifier">jc</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#consToValue"><span class="hs-identifier hs-var">consToValue</span></a><span> </span><a href="Data.Aeson.TH.html#Encoding"><span class="hs-identifier hs-var">Encoding</span></a><span> </span><a href="#local-6989586621679151314"><span class="hs-identifier hs-var">jc</span></a><span class="hs-special">)</span><span>
</span><a name="line-318"></a><span>
</span><a name="line-319"></a><span class="hs-comment">-- | Helper function used by both 'deriveToJSON' and 'mkToJSON'. Generates</span><span>
</span><a name="line-320"></a><span class="hs-comment">-- code to generate a 'Value' or 'Encoding' of a number of constructors. All</span><span>
</span><a name="line-321"></a><span class="hs-comment">-- constructors must be from the same type.</span><span>
</span><a name="line-322"></a><span class="hs-identifier">consToValue</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#ToJSONFun"><span class="hs-identifier hs-type">ToJSONFun</span></a><span>
</span><a name="line-323"></a><span>            </span><span class="hs-comment">-- ^ The method ('toJSON' or 'toEncoding') being derived.</span><span>
</span><a name="line-324"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span>
</span><a name="line-325"></a><span>            </span><span class="hs-comment">-- ^ The ToJSON variant being derived.</span><span>
</span><a name="line-326"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span>
</span><a name="line-327"></a><span>            </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-328"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-329"></a><span>            </span><span class="hs-comment">-- ^ The types from the data type/data family instance declaration</span><span>
</span><a name="line-330"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">ConstructorInfo</span><span class="hs-special">]</span><span>
</span><a name="line-331"></a><span>            </span><span class="hs-comment">-- ^ Constructors for which to generate JSON generating code.</span><span>
</span><a name="line-332"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-333"></a><span>
</span><a name="line-334"></a><a name="consToValue"><a href="Data.Aeson.TH.html#consToValue"><span class="hs-identifier">consToValue</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;Data.Aeson.TH.consToValue: &quot;</span><span>
</span><a name="line-335"></a><span>                             </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;Not a single constructor given!&quot;</span><span>
</span><a name="line-336"></a><span>
</span><a name="line-337"></a><span class="hs-identifier">consToValue</span><span> </span><a name="local-6989586621679151315"><a href="#local-6989586621679151315"><span class="hs-identifier">target</span></a></a><span> </span><a name="local-6989586621679151316"><a href="#local-6989586621679151316"><span class="hs-identifier">jc</span></a></a><span> </span><a name="local-6989586621679151317"><a href="#local-6989586621679151317"><span class="hs-identifier">opts</span></a></a><span> </span><a name="local-6989586621679151318"><a href="#local-6989586621679151318"><span class="hs-identifier">vars</span></a></a><span> </span><a name="local-6989586621679151319"><a href="#local-6989586621679151319"><span class="hs-identifier">cons</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-338"></a><span>    </span><a name="local-6989586621679151326"><a href="#local-6989586621679151326"><span class="hs-identifier">value</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;value&quot;</span><span>
</span><a name="line-339"></a><span>    </span><a name="local-6989586621679151327"><a href="#local-6989586621679151327"><span class="hs-identifier">tjs</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Aeson.TH.html#newNameList"><span class="hs-identifier hs-var">newNameList</span></a><span> </span><span class="hs-string">&quot;_tj&quot;</span><span>  </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Aeson.TH.html#arityInt"><span class="hs-identifier hs-var">arityInt</span></a><span> </span><a href="#local-6989586621679151316"><span class="hs-identifier hs-var">jc</span></a><span>
</span><a name="line-340"></a><span>    </span><a name="local-6989586621679151328"><a href="#local-6989586621679151328"><span class="hs-identifier">tjls</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Aeson.TH.html#newNameList"><span class="hs-identifier hs-var">newNameList</span></a><span> </span><span class="hs-string">&quot;_tjl&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Aeson.TH.html#arityInt"><span class="hs-identifier hs-var">arityInt</span></a><span> </span><a href="#local-6989586621679151316"><span class="hs-identifier hs-var">jc</span></a><span>
</span><a name="line-341"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679151329"><a href="#local-6989586621679151329"><span class="hs-identifier">zippedTJs</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621679151327"><span class="hs-identifier hs-var">tjs</span></a><span> </span><a href="#local-6989586621679151328"><span class="hs-identifier hs-var">tjls</span></a><span>
</span><a name="line-342"></a><span>        </span><a name="local-6989586621679151330"><a href="#local-6989586621679151330"><span class="hs-identifier">interleavedTJs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#interleave"><span class="hs-identifier hs-var">interleave</span></a><span> </span><a href="#local-6989586621679151327"><span class="hs-identifier hs-var">tjs</span></a><span> </span><a href="#local-6989586621679151328"><span class="hs-identifier hs-var">tjls</span></a><span>
</span><a name="line-343"></a><span>        </span><a name="local-6989586621679151331"><a href="#local-6989586621679151331"><span class="hs-identifier">lastTyVars</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Data.Aeson.TH.html#varTToName"><span class="hs-identifier hs-var">varTToName</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679151318"><span class="hs-identifier hs-var">vars</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="Data.Aeson.TH.html#arityInt"><span class="hs-identifier hs-var">arityInt</span></a><span> </span><a href="#local-6989586621679151316"><span class="hs-identifier hs-var">jc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151318"><span class="hs-identifier hs-var">vars</span></a><span>
</span><a name="line-344"></a><span>        </span><a name="local-6989586621679151332"><a href="#local-6989586621679151332"><span class="hs-identifier">tvMap</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromList</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621679151331"><span class="hs-identifier hs-var">lastTyVars</span></a><span> </span><a href="#local-6989586621679151329"><span class="hs-identifier hs-var">zippedTJs</span></a><span>
</span><a name="line-345"></a><span>    </span><span class="hs-identifier hs-var">lamE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">varP</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679151330"><span class="hs-identifier hs-var">interleavedTJs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151326"><span class="hs-identifier hs-var">value</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-346"></a><span>        </span><span class="hs-identifier hs-var">caseE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151326"><span class="hs-identifier hs-var">value</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151320"><span class="hs-identifier hs-var">matches</span></a><span> </span><a href="#local-6989586621679151332"><span class="hs-identifier hs-var">tvMap</span></a><span class="hs-special">)</span><span>
</span><a name="line-347"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-348"></a><span>    </span><a name="local-6989586621679151320"><a href="#local-6989586621679151320"><span class="hs-identifier">matches</span></a></a><span> </span><a name="local-6989586621679151321"><a href="#local-6989586621679151321"><span class="hs-identifier">tvMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679151319"><span class="hs-identifier hs-var">cons</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-349"></a><span>      </span><span class="hs-comment">-- A single constructor is directly encoded. The constructor itself may be</span><span>
</span><a name="line-350"></a><span>      </span><span class="hs-comment">-- forgotten.</span><span>
</span><a name="line-351"></a><span>      </span><span class="hs-special">[</span><a name="local-6989586621679151322"><a href="#local-6989586621679151322"><span class="hs-identifier">con</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">tagSingleConstructors</span><span> </span><a href="#local-6989586621679151317"><span class="hs-identifier hs-var">opts</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Data.Aeson.TH.html#argsToValue"><span class="hs-identifier hs-var">argsToValue</span></a><span> </span><a href="#local-6989586621679151315"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679151316"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151321"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151317"><span class="hs-identifier hs-var">opts</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679151322"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">]</span><span>
</span><a name="line-352"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">allNullaryToStringTag</span><span> </span><a href="#local-6989586621679151317"><span class="hs-identifier hs-var">opts</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><a href="Data.Aeson.TH.html#isNullary"><span class="hs-identifier hs-var">isNullary</span></a><span> </span><a href="#local-6989586621679151319"><span class="hs-identifier hs-var">cons</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-353"></a><span>              </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">match</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conP</span><span> </span><a href="#local-6989586621679151324"><span class="hs-identifier hs-var">conName</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Aeson.TH.html#conStr"><span class="hs-identifier hs-var">conStr</span></a><span> </span><a href="#local-6989586621679151315"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679151317"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679151324"><span class="hs-identifier hs-var">conName</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-354"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679151323"><a href="#local-6989586621679151323"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679151319"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-355"></a><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679151324"><a href="#local-6989586621679151324"><span class="hs-identifier">conName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">constructorName</span><span> </span><a href="#local-6989586621679151323"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-356"></a><span>              </span><span class="hs-special">]</span><span>
</span><a name="line-357"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Data.Aeson.TH.html#argsToValue"><span class="hs-identifier hs-var">argsToValue</span></a><span> </span><a href="#local-6989586621679151315"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679151316"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151321"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151317"><span class="hs-identifier hs-var">opts</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="#local-6989586621679151325"><span class="hs-identifier hs-var">con</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679151325"><a href="#local-6989586621679151325"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679151319"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">]</span><span>
</span><a name="line-358"></a><span>
</span><a name="line-359"></a><span class="hs-comment">-- | Name of the constructor as a quoted 'Value' or 'Encoding'.</span><span>
</span><a name="line-360"></a><span class="hs-identifier">conStr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#ToJSONFun"><span class="hs-identifier hs-type">ToJSONFun</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-361"></a><a name="conStr"><a href="Data.Aeson.TH.html#conStr"><span class="hs-identifier">conStr</span></a></a><span> </span><a href="Data.Aeson.TH.html#Value"><span class="hs-identifier hs-var">Value</span></a><span> </span><a name="local-6989586621679151333"><a href="#local-6989586621679151333"><span class="hs-identifier">opts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">appE</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><a href="Data.Aeson.Types.Internal.html#String"><span class="hs-identifier hs-var">String</span></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.Aeson.TH.html#conTxt"><span class="hs-identifier hs-var">conTxt</span></a><span> </span><a href="#local-6989586621679151333"><span class="hs-identifier hs-var">opts</span></a><span>
</span><a name="line-362"></a><span class="hs-identifier">conStr</span><span> </span><a href="Data.Aeson.TH.html#Encoding"><span class="hs-identifier hs-var">Encoding</span></a><span> </span><a name="local-6989586621679151334"><a href="#local-6989586621679151334"><span class="hs-identifier">opts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">appE</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><a href="Data.Aeson.Encoding.Internal.html#text"><span class="hs-identifier hs-var">E</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">text</span></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.Aeson.TH.html#conTxt"><span class="hs-identifier hs-var">conTxt</span></a><span> </span><a href="#local-6989586621679151334"><span class="hs-identifier hs-var">opts</span></a><span>
</span><a name="line-363"></a><span>
</span><a name="line-364"></a><span class="hs-comment">-- | Name of the constructor as a quoted 'Text'.</span><span>
</span><a name="line-365"></a><span class="hs-identifier">conTxt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-366"></a><a name="conTxt"><a href="Data.Aeson.TH.html#conTxt"><span class="hs-identifier">conTxt</span></a></a><span> </span><a name="local-6989586621679151335"><a href="#local-6989586621679151335"><span class="hs-identifier">opts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">appE</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pack</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">stringE</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.Aeson.TH.html#conString"><span class="hs-identifier hs-var">conString</span></a><span> </span><a href="#local-6989586621679151335"><span class="hs-identifier hs-var">opts</span></a><span>
</span><a name="line-367"></a><span>
</span><a name="line-368"></a><span class="hs-comment">-- | Name of the constructor.</span><span>
</span><a name="line-369"></a><span class="hs-identifier">conString</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-370"></a><a name="conString"><a href="Data.Aeson.TH.html#conString"><span class="hs-identifier">conString</span></a></a><span> </span><a name="local-6989586621679151336"><a href="#local-6989586621679151336"><span class="hs-identifier">opts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">constructorTagModifier</span><span> </span><a href="#local-6989586621679151336"><span class="hs-identifier hs-var">opts</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">nameBase</span><span>
</span><a name="line-371"></a><span>
</span><a name="line-372"></a><span class="hs-comment">-- | If constructor is nullary.</span><span>
</span><a name="line-373"></a><span class="hs-identifier">isNullary</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ConstructorInfo</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-374"></a><a name="isNullary"><a href="Data.Aeson.TH.html#isNullary"><span class="hs-identifier">isNullary</span></a></a><span> </span><span class="hs-identifier hs-var">ConstructorInfo</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">constructorVariant</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">NormalConstructor</span><span>
</span><a name="line-375"></a><span>                          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">constructorFields</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151337"><a href="#local-6989586621679151337"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679151337"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-376"></a><span class="hs-identifier">isNullary</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-377"></a><span>
</span><a name="line-378"></a><span class="hs-comment">-- | Wrap fields of a non-record constructor. See 'sumToValue'.</span><span>
</span><a name="line-379"></a><span class="hs-identifier">opaqueSumToValue</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#ToJSONFun"><span class="hs-identifier hs-type">ToJSONFun</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span>
</span><a name="line-380"></a><a name="opaqueSumToValue"><a href="Data.Aeson.TH.html#opaqueSumToValue"><span class="hs-identifier">opaqueSumToValue</span></a></a><span> </span><a name="local-6989586621679151338"><a href="#local-6989586621679151338"><span class="hs-identifier">target</span></a></a><span> </span><a name="local-6989586621679151339"><a href="#local-6989586621679151339"><span class="hs-identifier">opts</span></a></a><span> </span><a name="local-6989586621679151340"><a href="#local-6989586621679151340"><span class="hs-identifier">multiCons</span></a></a><span> </span><a name="local-6989586621679151341"><a href="#local-6989586621679151341"><span class="hs-identifier">nullary</span></a></a><span> </span><a name="local-6989586621679151342"><a href="#local-6989586621679151342"><span class="hs-identifier">conName</span></a></a><span> </span><a name="local-6989586621679151343"><a href="#local-6989586621679151343"><span class="hs-identifier">value</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-381"></a><span>  </span><a href="Data.Aeson.TH.html#sumToValue"><span class="hs-identifier hs-var">sumToValue</span></a><span> </span><a href="#local-6989586621679151338"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679151339"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679151340"><span class="hs-identifier hs-var">multiCons</span></a><span> </span><a href="#local-6989586621679151341"><span class="hs-identifier hs-var">nullary</span></a><span> </span><a href="#local-6989586621679151342"><span class="hs-identifier hs-var">conName</span></a><span>
</span><a name="line-382"></a><span>    </span><a href="#local-6989586621679151343"><span class="hs-identifier hs-var">value</span></a><span>
</span><a name="line-383"></a><span>    </span><a href="#local-6989586621679151344"><span class="hs-identifier hs-var">pairs</span></a><span>
</span><a name="line-384"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-385"></a><span>    </span><a name="local-6989586621679151344"><a href="#local-6989586621679151344"><span class="hs-identifier">pairs</span></a></a><span> </span><a name="local-6989586621679151345"><a href="#local-6989586621679151345"><span class="hs-identifier">contentsFieldName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">listE</span><span> </span><span class="hs-special">[</span><a href="Data.Aeson.TH.html#toPair"><span class="hs-identifier hs-var">toPair</span></a><span> </span><a href="#local-6989586621679151338"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679151345"><span class="hs-identifier hs-var">contentsFieldName</span></a><span> </span><a href="#local-6989586621679151343"><span class="hs-identifier hs-var">value</span></a><span class="hs-special">]</span><span>
</span><a name="line-386"></a><span>
</span><a name="line-387"></a><span class="hs-comment">-- | Wrap fields of a record constructor. See 'sumToValue'.</span><span>
</span><a name="line-388"></a><span class="hs-identifier">recordSumToValue</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#ToJSONFun"><span class="hs-identifier hs-type">ToJSONFun</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span>
</span><a name="line-389"></a><a name="recordSumToValue"><a href="Data.Aeson.TH.html#recordSumToValue"><span class="hs-identifier">recordSumToValue</span></a></a><span> </span><a name="local-6989586621679151346"><a href="#local-6989586621679151346"><span class="hs-identifier">target</span></a></a><span> </span><a name="local-6989586621679151347"><a href="#local-6989586621679151347"><span class="hs-identifier">opts</span></a></a><span> </span><a name="local-6989586621679151348"><a href="#local-6989586621679151348"><span class="hs-identifier">multiCons</span></a></a><span> </span><a name="local-6989586621679151349"><a href="#local-6989586621679151349"><span class="hs-identifier">nullary</span></a></a><span> </span><a name="local-6989586621679151350"><a href="#local-6989586621679151350"><span class="hs-identifier">conName</span></a></a><span> </span><a name="local-6989586621679151351"><a href="#local-6989586621679151351"><span class="hs-identifier">pairs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-390"></a><span>  </span><a href="Data.Aeson.TH.html#sumToValue"><span class="hs-identifier hs-var">sumToValue</span></a><span> </span><a href="#local-6989586621679151346"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679151347"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679151348"><span class="hs-identifier hs-var">multiCons</span></a><span> </span><a href="#local-6989586621679151349"><span class="hs-identifier hs-var">nullary</span></a><span> </span><a href="#local-6989586621679151350"><span class="hs-identifier hs-var">conName</span></a><span>
</span><a name="line-391"></a><span>    </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#objectExp"><span class="hs-identifier hs-var">objectExp</span></a><span> </span><a href="#local-6989586621679151346"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679151351"><span class="hs-identifier hs-var">pairs</span></a><span class="hs-special">)</span><span>
</span><a name="line-392"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">const</span><span> </span><a href="#local-6989586621679151351"><span class="hs-identifier hs-var">pairs</span></a><span class="hs-special">)</span><span>
</span><a name="line-393"></a><span>
</span><a name="line-394"></a><span class="hs-comment">-- | Wrap fields of a constructor.</span><span>
</span><a name="line-395"></a><span class="hs-identifier">sumToValue</span><span>
</span><a name="line-396"></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#ToJSONFun"><span class="hs-identifier hs-type">ToJSONFun</span></a><span>
</span><a name="line-397"></a><span>  </span><span class="hs-comment">-- ^ The method being derived.</span><span>
</span><a name="line-398"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span>
</span><a name="line-399"></a><span>  </span><span class="hs-comment">-- ^ Deriving options.</span><span>
</span><a name="line-400"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-401"></a><span>  </span><span class="hs-comment">-- ^ Does this type have multiple constructors.</span><span>
</span><a name="line-402"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-403"></a><span>  </span><span class="hs-comment">-- ^ Is this constructor nullary.</span><span>
</span><a name="line-404"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-405"></a><span>  </span><span class="hs-comment">-- ^ Constructor name.</span><span>
</span><a name="line-406"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span>
</span><a name="line-407"></a><span>  </span><span class="hs-comment">-- ^ Fields of the constructor as a 'Value' or 'Encoding'.</span><span>
</span><a name="line-408"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span class="hs-special">)</span><span>
</span><a name="line-409"></a><span>  </span><span class="hs-comment">-- ^ Representation of an 'Object' fragment used for the 'TaggedObject'</span><span>
</span><a name="line-410"></a><span>  </span><span class="hs-comment">-- variant; of type @[(Text,Value)]@ or @[Encoding]@, depending on the method</span><span>
</span><a name="line-411"></a><span>  </span><span class="hs-comment">-- being derived.</span><span>
</span><a name="line-412"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-413"></a><span>  </span><span class="hs-comment">-- - For non-records, produces a pair @&quot;contentsFieldName&quot;:value@,</span><span>
</span><a name="line-414"></a><span>  </span><span class="hs-comment">--   given a @contentsFieldName@ as an argument. See 'opaqueSumToValue'.</span><span>
</span><a name="line-415"></a><span>  </span><span class="hs-comment">-- - For records, produces the list of pairs corresponding to fields of the</span><span>
</span><a name="line-416"></a><span>  </span><span class="hs-comment">--   encoded value (ignores the argument). See 'recordSumToValue'.</span><span>
</span><a name="line-417"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span>
</span><a name="line-418"></a><a name="sumToValue"><a href="Data.Aeson.TH.html#sumToValue"><span class="hs-identifier">sumToValue</span></a></a><span> </span><a name="local-6989586621679151352"><a href="#local-6989586621679151352"><span class="hs-identifier">target</span></a></a><span> </span><a name="local-6989586621679151353"><a href="#local-6989586621679151353"><span class="hs-identifier">opts</span></a></a><span> </span><a name="local-6989586621679151354"><a href="#local-6989586621679151354"><span class="hs-identifier">multiCons</span></a></a><span> </span><a name="local-6989586621679151355"><a href="#local-6989586621679151355"><span class="hs-identifier">nullary</span></a></a><span> </span><a name="local-6989586621679151356"><a href="#local-6989586621679151356"><span class="hs-identifier">conName</span></a></a><span> </span><a name="local-6989586621679151357"><a href="#local-6989586621679151357"><span class="hs-identifier">value</span></a></a><span> </span><a name="local-6989586621679151358"><a href="#local-6989586621679151358"><span class="hs-identifier">pairs</span></a></a><span>
</span><a name="line-419"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679151354"><span class="hs-identifier hs-var">multiCons</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-420"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">sumEncoding</span><span> </span><a href="#local-6989586621679151353"><span class="hs-identifier hs-var">opts</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-421"></a><span>          </span><a href="Data.Aeson.Types.Internal.html#TwoElemArray"><span class="hs-identifier hs-var">TwoElemArray</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-422"></a><span>            </span><a href="Data.Aeson.TH.html#array"><span class="hs-identifier hs-var">array</span></a><span> </span><a href="#local-6989586621679151352"><span class="hs-identifier hs-var">target</span></a><span> </span><span class="hs-special">[</span><a href="Data.Aeson.TH.html#conStr"><span class="hs-identifier hs-var">conStr</span></a><span> </span><a href="#local-6989586621679151352"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679151353"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679151356"><span class="hs-identifier hs-var">conName</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151357"><span class="hs-identifier hs-var">value</span></a><span class="hs-special">]</span><span>
</span><a name="line-423"></a><span>          </span><a href="Data.Aeson.Types.Internal.html#TaggedObject"><span class="hs-identifier hs-var">TaggedObject</span></a><span class="hs-special">{</span><a name="local-6989586621679151359"><a href="#local-6989586621679151359"><span class="hs-identifier">tagFieldName</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679151360"><a href="#local-6989586621679151360"><span class="hs-identifier">contentsFieldName</span></a></a><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-424"></a><span>            </span><span class="hs-comment">-- TODO: Maybe throw an error in case</span><span>
</span><a name="line-425"></a><span>            </span><span class="hs-comment">-- tagFieldName overwrites a field in pairs.</span><span>
</span><a name="line-426"></a><span>            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679151361"><a href="#local-6989586621679151361"><span class="hs-identifier">tag</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#toPair"><span class="hs-identifier hs-var">toPair</span></a><span> </span><a href="#local-6989586621679151352"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679151359"><span class="hs-identifier hs-var">tagFieldName</span></a><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#conStr"><span class="hs-identifier hs-var">conStr</span></a><span> </span><a href="#local-6989586621679151352"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679151353"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679151356"><span class="hs-identifier hs-var">conName</span></a><span class="hs-special">)</span><span>
</span><a name="line-427"></a><span>                </span><a name="local-6989586621679151362"><a href="#local-6989586621679151362"><span class="hs-identifier">content</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151358"><span class="hs-identifier hs-var">pairs</span></a><span> </span><a href="#local-6989586621679151360"><span class="hs-identifier hs-var">contentsFieldName</span></a><span>
</span><a name="line-428"></a><span>            </span><span class="hs-keyword">in</span><span> </span><a href="Data.Aeson.TH.html#objectExp"><span class="hs-identifier hs-var">objectExp</span></a><span> </span><a href="#local-6989586621679151352"><span class="hs-identifier hs-var">target</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-429"></a><span>              </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679151355"><span class="hs-identifier hs-var">nullary</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">listE</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151361"><span class="hs-identifier hs-var">tag</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">infixApp</span><span> </span><a href="#local-6989586621679151361"><span class="hs-identifier hs-var">tag</span></a><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679151362"><span class="hs-identifier hs-var">content</span></a><span>
</span><a name="line-430"></a><span>          </span><a href="Data.Aeson.Types.Internal.html#ObjectWithSingleField"><span class="hs-identifier hs-var">ObjectWithSingleField</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-431"></a><span>            </span><a href="Data.Aeson.TH.html#object"><span class="hs-identifier hs-var">object</span></a><span> </span><a href="#local-6989586621679151352"><span class="hs-identifier hs-var">target</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#conString"><span class="hs-identifier hs-var">conString</span></a><span> </span><a href="#local-6989586621679151353"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679151356"><span class="hs-identifier hs-var">conName</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151357"><span class="hs-identifier hs-var">value</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-432"></a><span>          </span><a href="Data.Aeson.Types.Internal.html#UntaggedValue"><span class="hs-identifier hs-var">UntaggedValue</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679151355"><span class="hs-identifier hs-var">nullary</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#conStr"><span class="hs-identifier hs-var">conStr</span></a><span> </span><a href="#local-6989586621679151352"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679151353"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679151356"><span class="hs-identifier hs-var">conName</span></a><span>
</span><a name="line-433"></a><span>          </span><a href="Data.Aeson.Types.Internal.html#UntaggedValue"><span class="hs-identifier hs-var">UntaggedValue</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151357"><span class="hs-identifier hs-var">value</span></a><span>
</span><a name="line-434"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151357"><span class="hs-identifier hs-var">value</span></a><span>
</span><a name="line-435"></a><span>
</span><a name="line-436"></a><span class="hs-comment">-- | Generates code to generate the JSON encoding of a single constructor.</span><span>
</span><a name="line-437"></a><span class="hs-identifier">argsToValue</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#ToJSONFun"><span class="hs-identifier hs-type">ToJSONFun</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#TyVarMap"><span class="hs-identifier hs-type">TyVarMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ConstructorInfo</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Match</span><span>
</span><a name="line-438"></a><span>
</span><a name="line-439"></a><span class="hs-comment">-- Polyadic constructors with special case for unary constructors.</span><span>
</span><a name="line-440"></a><a name="argsToValue"><a href="Data.Aeson.TH.html#argsToValue"><span class="hs-identifier">argsToValue</span></a></a><span> </span><a name="local-6989586621679151363"><a href="#local-6989586621679151363"><span class="hs-identifier">target</span></a></a><span> </span><a name="local-6989586621679151364"><a href="#local-6989586621679151364"><span class="hs-identifier">jc</span></a></a><span> </span><a name="local-6989586621679151365"><a href="#local-6989586621679151365"><span class="hs-identifier">tvMap</span></a></a><span> </span><a name="local-6989586621679151366"><a href="#local-6989586621679151366"><span class="hs-identifier">opts</span></a></a><span> </span><a name="local-6989586621679151367"><a href="#local-6989586621679151367"><span class="hs-identifier">multiCons</span></a></a><span>
</span><a name="line-441"></a><span>  </span><span class="hs-identifier hs-var">ConstructorInfo</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">constructorName</span><span>    </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151368"><a href="#local-6989586621679151368"><span class="hs-identifier">conName</span></a></a><span>
</span><a name="line-442"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">constructorVariant</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">NormalConstructor</span><span>
</span><a name="line-443"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">constructorFields</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151369"><a href="#local-6989586621679151369"><span class="hs-identifier">argTys</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-444"></a><span>    </span><a name="local-6989586621679151370"><a href="#local-6989586621679151370"><span class="hs-identifier">argTys'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-identifier hs-var">resolveTypeSynonyms</span><span> </span><a href="#local-6989586621679151369"><span class="hs-identifier hs-var">argTys</span></a><span>
</span><a name="line-445"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679151371"><a href="#local-6989586621679151371"><span class="hs-identifier">len</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679151370"><span class="hs-identifier hs-var">argTys'</span></a><span>
</span><a name="line-446"></a><span>    </span><a name="local-6989586621679151372"><a href="#local-6989586621679151372"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Aeson.TH.html#newNameList"><span class="hs-identifier hs-var">newNameList</span></a><span> </span><span class="hs-string">&quot;arg&quot;</span><span> </span><a href="#local-6989586621679151371"><span class="hs-identifier hs-var">len</span></a><span>
</span><a name="line-447"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679151373"><a href="#local-6989586621679151373"><span class="hs-identifier">js</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">[</span><span> </span><a href="Data.Aeson.TH.html#dispatchToJSON"><span class="hs-identifier hs-var">dispatchToJSON</span></a><span> </span><a href="#local-6989586621679151363"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679151364"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151368"><span class="hs-identifier hs-var">conName</span></a><span> </span><a href="#local-6989586621679151365"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151375"><span class="hs-identifier hs-var">argTy</span></a><span>
</span><a name="line-448"></a><span>                      </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151374"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-449"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151374"><a href="#local-6989586621679151374"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679151375"><a href="#local-6989586621679151375"><span class="hs-identifier">argTy</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621679151372"><span class="hs-identifier hs-var">args</span></a><span> </span><a href="#local-6989586621679151370"><span class="hs-identifier hs-var">argTys'</span></a><span>
</span><a name="line-450"></a><span>                  </span><span class="hs-special">]</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-451"></a><span>               </span><span class="hs-comment">-- Single argument is directly converted.</span><span>
</span><a name="line-452"></a><span>               </span><span class="hs-special">[</span><a name="local-6989586621679151376"><a href="#local-6989586621679151376"><span class="hs-identifier">e</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151376"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-453"></a><span>               </span><span class="hs-comment">-- Zero and multiple arguments are converted to a JSON array.</span><span>
</span><a name="line-454"></a><span>               </span><a name="local-6989586621679151377"><a href="#local-6989586621679151377"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#array"><span class="hs-identifier hs-var">array</span></a><span> </span><a href="#local-6989586621679151363"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679151377"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-455"></a><span>
</span><a name="line-456"></a><span>    </span><span class="hs-identifier hs-var">match</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conP</span><span> </span><a href="#local-6989586621679151368"><span class="hs-identifier hs-var">conName</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679151372"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-457"></a><span>          </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Aeson.TH.html#opaqueSumToValue"><span class="hs-identifier hs-var">opaqueSumToValue</span></a><span> </span><a href="#local-6989586621679151363"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679151366"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679151367"><span class="hs-identifier hs-var">multiCons</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679151370"><span class="hs-identifier hs-var">argTys'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151368"><span class="hs-identifier hs-var">conName</span></a><span> </span><a href="#local-6989586621679151373"><span class="hs-identifier hs-var">js</span></a><span class="hs-special">)</span><span>
</span><a name="line-458"></a><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-459"></a><span>
</span><a name="line-460"></a><span class="hs-comment">-- Records.</span><span>
</span><a name="line-461"></a><span class="hs-identifier">argsToValue</span><span> </span><a name="local-6989586621679151378"><a href="#local-6989586621679151378"><span class="hs-identifier">target</span></a></a><span> </span><a name="local-6989586621679151379"><a href="#local-6989586621679151379"><span class="hs-identifier">jc</span></a></a><span> </span><a name="local-6989586621679151380"><a href="#local-6989586621679151380"><span class="hs-identifier">tvMap</span></a></a><span> </span><a name="local-6989586621679151381"><a href="#local-6989586621679151381"><span class="hs-identifier">opts</span></a></a><span> </span><a name="local-6989586621679151382"><a href="#local-6989586621679151382"><span class="hs-identifier">multiCons</span></a></a><span>
</span><a name="line-462"></a><span>  </span><a name="local-6989586621679151383"><a href="#local-6989586621679151383"><span class="hs-identifier">info</span></a></a><span class="hs-glyph">@</span><span class="hs-identifier hs-var">ConstructorInfo</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">constructorName</span><span>    </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151384"><a href="#local-6989586621679151384"><span class="hs-identifier">conName</span></a></a><span>
</span><a name="line-463"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">constructorVariant</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">RecordConstructor</span><span> </span><a name="local-6989586621679151385"><a href="#local-6989586621679151385"><span class="hs-identifier">fields</span></a></a><span>
</span><a name="line-464"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">constructorFields</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151386"><a href="#local-6989586621679151386"><span class="hs-identifier">argTys</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-465"></a><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unwrapUnaryRecords</span><span> </span><a href="#local-6989586621679151381"><span class="hs-identifier hs-var">opts</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621679151382"><span class="hs-identifier hs-var">multiCons</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151386"><span class="hs-identifier hs-var">argTys</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-466"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#argsToValue"><span class="hs-identifier hs-var">argsToValue</span></a><span> </span><a href="#local-6989586621679151378"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679151379"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151380"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151381"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679151382"><span class="hs-identifier hs-var">multiCons</span></a><span>
</span><a name="line-467"></a><span>                                     </span><span class="hs-special">(</span><a href="#local-6989586621679151383"><span class="hs-identifier hs-var">info</span></a><span class="hs-special">{</span><span class="hs-identifier">constructorVariant</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">NormalConstructor</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-468"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-469"></a><span>        </span><a name="local-6989586621679151387"><a href="#local-6989586621679151387"><span class="hs-identifier">argTys'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-identifier hs-var">resolveTypeSynonyms</span><span> </span><a href="#local-6989586621679151386"><span class="hs-identifier hs-var">argTys</span></a><span>
</span><a name="line-470"></a><span>        </span><a name="local-6989586621679151388"><a href="#local-6989586621679151388"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Aeson.TH.html#newNameList"><span class="hs-identifier hs-var">newNameList</span></a><span> </span><span class="hs-string">&quot;arg&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679151387"><span class="hs-identifier hs-var">argTys'</span></a><span>
</span><a name="line-471"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679151389"><a href="#local-6989586621679151389"><span class="hs-identifier">pairs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">omitNothingFields</span><span> </span><a href="#local-6989586621679151381"><span class="hs-identifier hs-var">opts</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">infixApp</span><span> </span><a href="#local-6989586621679151391"><span class="hs-identifier hs-var">maybeFields</span></a><span>
</span><a name="line-472"></a><span>                                                      </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-special">(</span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a name="line-473"></a><span>                                                      </span><a href="#local-6989586621679151392"><span class="hs-identifier hs-var">restFields</span></a><span>
</span><a name="line-474"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">listE</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679151399"><span class="hs-identifier hs-var">pureToPair</span></a><span> </span><a href="#local-6989586621679151390"><span class="hs-identifier hs-var">argCons</span></a><span>
</span><a name="line-475"></a><span>
</span><a name="line-476"></a><span>            </span><a name="local-6989586621679151390"><a href="#local-6989586621679151390"><span class="hs-identifier">argCons</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zip3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151388"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151387"><span class="hs-identifier hs-var">argTys'</span></a><span> </span><a href="#local-6989586621679151385"><span class="hs-identifier hs-var">fields</span></a><span>
</span><a name="line-477"></a><span>
</span><a name="line-478"></a><span>            </span><a name="local-6989586621679151391"><a href="#local-6989586621679151391"><span class="hs-identifier">maybeFields</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">catMaybes</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">listE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679151398"><span class="hs-identifier hs-var">maybeToPair</span></a><span> </span><a href="#local-6989586621679151397"><span class="hs-identifier hs-var">maybes</span></a><span class="hs-special">)</span><span>
</span><a name="line-479"></a><span>
</span><a name="line-480"></a><span>            </span><a name="local-6989586621679151392"><a href="#local-6989586621679151392"><span class="hs-identifier">restFields</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">listE</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679151399"><span class="hs-identifier hs-var">pureToPair</span></a><span> </span><a href="#local-6989586621679151396"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-481"></a><span>
</span><a name="line-482"></a><span>            </span><span class="hs-special">(</span><a name="local-6989586621679151393"><a href="#local-6989586621679151393"><span class="hs-identifier">maybes0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679151394"><a href="#local-6989586621679151394"><span class="hs-identifier">rest0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">partition</span><span> </span><a href="Data.Aeson.TH.html#isMaybe"><span class="hs-identifier hs-var">isMaybe</span></a><span> </span><a href="#local-6989586621679151390"><span class="hs-identifier hs-var">argCons</span></a><span>
</span><a name="line-483"></a><span>            </span><span class="hs-special">(</span><a name="local-6989586621679151395"><a href="#local-6989586621679151395"><span class="hs-identifier">options</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679151396"><a href="#local-6989586621679151396"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">partition</span><span> </span><a href="Data.Aeson.TH.html#isOption"><span class="hs-identifier hs-var">isOption</span></a><span> </span><a href="#local-6989586621679151394"><span class="hs-identifier hs-var">rest0</span></a><span>
</span><a name="line-484"></a><span>            </span><a name="local-6989586621679151397"><a href="#local-6989586621679151397"><span class="hs-identifier">maybes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151393"><span class="hs-identifier hs-var">maybes0</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Data.Aeson.TH.html#optionToMaybe"><span class="hs-identifier hs-var">optionToMaybe</span></a><span> </span><a href="#local-6989586621679151395"><span class="hs-identifier hs-var">options</span></a><span>
</span><a name="line-485"></a><span>
</span><a name="line-486"></a><span>            </span><a name="local-6989586621679151398"><a href="#local-6989586621679151398"><span class="hs-identifier">maybeToPair</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151400"><span class="hs-identifier hs-var">toPairLifted</span></a><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-487"></a><span>            </span><a name="local-6989586621679151399"><a href="#local-6989586621679151399"><span class="hs-identifier">pureToPair</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151400"><span class="hs-identifier hs-var">toPairLifted</span></a><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-488"></a><span>
</span><a name="line-489"></a><span>            </span><a name="local-6989586621679151400"><a href="#local-6989586621679151400"><span class="hs-identifier">toPairLifted</span></a></a><span> </span><a name="local-6989586621679151401"><a href="#local-6989586621679151401"><span class="hs-identifier">lifted</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679151402"><a href="#local-6989586621679151402"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679151403"><a href="#local-6989586621679151403"><span class="hs-identifier">argTy</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679151404"><a href="#local-6989586621679151404"><span class="hs-identifier">field</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-490"></a><span>              </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679151405"><a href="#local-6989586621679151405"><span class="hs-identifier">toValue</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#dispatchToJSON"><span class="hs-identifier hs-var">dispatchToJSON</span></a><span> </span><a href="#local-6989586621679151378"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679151379"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151384"><span class="hs-identifier hs-var">conName</span></a><span> </span><a href="#local-6989586621679151380"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151403"><span class="hs-identifier hs-var">argTy</span></a><span>
</span><a name="line-491"></a><span>                  </span><a name="local-6989586621679151406"><a href="#local-6989586621679151406"><span class="hs-identifier">fieldName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#fieldLabel"><span class="hs-identifier hs-var">fieldLabel</span></a><span> </span><a href="#local-6989586621679151381"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679151404"><span class="hs-identifier hs-var">field</span></a><span>
</span><a name="line-492"></a><span>                  </span><a name="local-6989586621679151407"><a href="#local-6989586621679151407"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679151408"><a href="#local-6989586621679151408"><span class="hs-identifier">arg'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#toPair"><span class="hs-identifier hs-var">toPair</span></a><span> </span><a href="#local-6989586621679151378"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679151406"><span class="hs-identifier hs-var">fieldName</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151405"><span class="hs-identifier hs-var">toValue</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679151408"><span class="hs-identifier hs-var">arg'</span></a><span class="hs-special">)</span><span>
</span><a name="line-493"></a><span>              </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679151401"><span class="hs-identifier hs-var">lifted</span></a><span>
</span><a name="line-494"></a><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-495"></a><span>                  </span><a name="local-6989586621679151409"><a href="#local-6989586621679151409"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;x&quot;</span><span>
</span><a name="line-496"></a><span>                  </span><span class="hs-identifier hs-var">infixApp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">lam1E</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679151409"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151407"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151409"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;$&gt;</span><span class="hs-special">)</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679151402"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-497"></a><span>                </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679151407"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679151402"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-498"></a><span>
</span><a name="line-499"></a><span>        </span><span class="hs-identifier hs-var">match</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conP</span><span> </span><a href="#local-6989586621679151384"><span class="hs-identifier hs-var">conName</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679151388"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-500"></a><span>              </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Aeson.TH.html#recordSumToValue"><span class="hs-identifier hs-var">recordSumToValue</span></a><span> </span><a href="#local-6989586621679151378"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679151381"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679151382"><span class="hs-identifier hs-var">multiCons</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679151386"><span class="hs-identifier hs-var">argTys</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151384"><span class="hs-identifier hs-var">conName</span></a><span> </span><a href="#local-6989586621679151389"><span class="hs-identifier hs-var">pairs</span></a><span class="hs-special">)</span><span>
</span><a name="line-501"></a><span>              </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-502"></a><span>
</span><a name="line-503"></a><span class="hs-comment">-- Infix constructors.</span><span>
</span><a name="line-504"></a><span class="hs-identifier">argsToValue</span><span> </span><a name="local-6989586621679151410"><a href="#local-6989586621679151410"><span class="hs-identifier">target</span></a></a><span> </span><a name="local-6989586621679151411"><a href="#local-6989586621679151411"><span class="hs-identifier">jc</span></a></a><span> </span><a name="local-6989586621679151412"><a href="#local-6989586621679151412"><span class="hs-identifier">tvMap</span></a></a><span> </span><a name="local-6989586621679151413"><a href="#local-6989586621679151413"><span class="hs-identifier">opts</span></a></a><span> </span><a name="local-6989586621679151414"><a href="#local-6989586621679151414"><span class="hs-identifier">multiCons</span></a></a><span>
</span><a name="line-505"></a><span>  </span><span class="hs-identifier hs-var">ConstructorInfo</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">constructorName</span><span>    </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151415"><a href="#local-6989586621679151415"><span class="hs-identifier">conName</span></a></a><span>
</span><a name="line-506"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">constructorVariant</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">InfixConstructor</span><span>
</span><a name="line-507"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">constructorFields</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151416"><a href="#local-6989586621679151416"><span class="hs-identifier">argTys</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-508"></a><span>    </span><span class="hs-special">[</span><a name="local-6989586621679151417"><a href="#local-6989586621679151417"><span class="hs-identifier">alTy</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679151418"><a href="#local-6989586621679151418"><span class="hs-identifier">arTy</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-identifier hs-var">resolveTypeSynonyms</span><span> </span><a href="#local-6989586621679151416"><span class="hs-identifier hs-var">argTys</span></a><span>
</span><a name="line-509"></a><span>    </span><a name="local-6989586621679151419"><a href="#local-6989586621679151419"><span class="hs-identifier">al</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;argL&quot;</span><span>
</span><a name="line-510"></a><span>    </span><a name="local-6989586621679151420"><a href="#local-6989586621679151420"><span class="hs-identifier">ar</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;argR&quot;</span><span>
</span><a name="line-511"></a><span>    </span><span class="hs-identifier hs-var">match</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">infixP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679151419"><span class="hs-identifier hs-var">al</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151415"><span class="hs-identifier hs-var">conName</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679151420"><span class="hs-identifier hs-var">ar</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-512"></a><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">normalB</span><span>
</span><a name="line-513"></a><span>          </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Aeson.TH.html#opaqueSumToValue"><span class="hs-identifier hs-var">opaqueSumToValue</span></a><span> </span><a href="#local-6989586621679151410"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679151413"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679151414"><span class="hs-identifier hs-var">multiCons</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679151415"><span class="hs-identifier hs-var">conName</span></a><span>
</span><a name="line-514"></a><span>          </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Aeson.TH.html#array"><span class="hs-identifier hs-var">array</span></a><span> </span><a href="#local-6989586621679151410"><span class="hs-identifier hs-var">target</span></a><span>
</span><a name="line-515"></a><span>              </span><span class="hs-special">[</span><span> </span><a href="Data.Aeson.TH.html#dispatchToJSON"><span class="hs-identifier hs-var">dispatchToJSON</span></a><span> </span><a href="#local-6989586621679151410"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679151411"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151415"><span class="hs-identifier hs-var">conName</span></a><span> </span><a href="#local-6989586621679151412"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151422"><span class="hs-identifier hs-var">aTy</span></a><span>
</span><a name="line-516"></a><span>                  </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151421"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-517"></a><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151421"><a href="#local-6989586621679151421"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679151422"><a href="#local-6989586621679151422"><span class="hs-identifier">aTy</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679151419"><span class="hs-identifier hs-var">al</span></a><span class="hs-special">,</span><a href="#local-6989586621679151417"><span class="hs-identifier hs-var">alTy</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151420"><span class="hs-identifier hs-var">ar</span></a><span class="hs-special">,</span><a href="#local-6989586621679151418"><span class="hs-identifier hs-var">arTy</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-518"></a><span>              </span><span class="hs-special">]</span><span>
</span><a name="line-519"></a><span>          </span><span class="hs-special">)</span><span>
</span><a name="line-520"></a><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-521"></a><span>
</span><a name="line-522"></a><span class="hs-identifier">isMaybe</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151309"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151310"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-523"></a><a name="isMaybe"><a href="Data.Aeson.TH.html#isMaybe"><span class="hs-identifier">isMaybe</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">AppT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ConT</span><span> </span><a name="local-6989586621679151423"><a href="#local-6989586621679151423"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151423"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Maybe</span><span>
</span><a name="line-524"></a><span class="hs-identifier">isMaybe</span><span> </span><span class="hs-identifier">_</span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-525"></a><span>
</span><a name="line-526"></a><span class="hs-identifier">isOption</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151307"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151308"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-527"></a><a name="isOption"><a href="Data.Aeson.TH.html#isOption"><span class="hs-identifier">isOption</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">AppT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ConT</span><span> </span><a name="local-6989586621679151424"><a href="#local-6989586621679151424"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151424"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Semigroup</span><span class="hs-operator">.</span><span class="hs-identifier">Option</span><span>
</span><a name="line-528"></a><span class="hs-identifier">isOption</span><span> </span><span class="hs-identifier">_</span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-529"></a><span>
</span><a name="line-530"></a><span class="hs-identifier">optionToMaybe</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ExpQ</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151305"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151306"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ExpQ</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151305"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151306"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-531"></a><a name="optionToMaybe"><a href="Data.Aeson.TH.html#optionToMaybe"><span class="hs-identifier">optionToMaybe</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679151425"><a href="#local-6989586621679151425"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679151426"><a href="#local-6989586621679151426"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679151427"><a href="#local-6989586621679151427"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier">Semigroup</span><span class="hs-operator">.</span><span class="hs-identifier">getOption</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679151425"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151426"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151427"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-532"></a><span>
</span><a name="line-533"></a><span class="hs-special">(</span><span class="hs-operator">&lt;^&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span>
</span><a name="line-534"></a><span class="hs-special">(</span><a name="%3C%5E%3E"><a href="Data.Aeson.TH.html#%3C%5E%3E"><span class="hs-operator">&lt;^&gt;</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679151428"><a href="#local-6989586621679151428"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679151429"><a href="#local-6989586621679151429"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">infixApp</span><span> </span><a href="#local-6989586621679151428"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-special">(</span><a href="Data.Aeson.Encoding.Internal.html#%3E%3C"><span class="hs-identifier hs-var">E</span><span class="hs-operator hs-var">.&gt;&lt;</span></a><span class="hs-special">)</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679151429"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-535"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">6</span><span> </span><span class="hs-operator">&lt;^&gt;</span><span>
</span><a name="line-536"></a><span>
</span><a name="line-537"></a><span class="hs-special">(</span><span class="hs-operator">&lt;:&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span>
</span><a name="line-538"></a><span class="hs-special">(</span><a name="%3C%3A%3E"><a href="Data.Aeson.TH.html#%3C%3A%3E"><span class="hs-operator">&lt;:&gt;</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679151430"><a href="#local-6989586621679151430"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679151431"><a href="#local-6989586621679151431"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151430"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Data.Aeson.TH.html#%3C%5E%3E"><span class="hs-operator hs-var">&lt;^&gt;</span></a><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><a href="Data.Aeson.Encoding.Internal.html#colon"><span class="hs-identifier hs-var">E</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">colon</span></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><a href="Data.Aeson.TH.html#%3C%5E%3E"><span class="hs-operator hs-var">&lt;^&gt;</span></a><span> </span><a href="#local-6989586621679151431"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-539"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">5</span><span> </span><span class="hs-operator">&lt;:&gt;</span><span>
</span><a name="line-540"></a><span>
</span><a name="line-541"></a><span class="hs-special">(</span><span class="hs-operator">&lt;%&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span>
</span><a name="line-542"></a><span class="hs-special">(</span><a name="%3C%25%3E"><a href="Data.Aeson.TH.html#%3C%25%3E"><span class="hs-operator">&lt;%&gt;</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679151432"><a href="#local-6989586621679151432"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679151433"><a href="#local-6989586621679151433"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151432"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Data.Aeson.TH.html#%3C%5E%3E"><span class="hs-operator hs-var">&lt;^&gt;</span></a><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><a href="Data.Aeson.Encoding.Internal.html#comma"><span class="hs-identifier hs-var">E</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">comma</span></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><a href="Data.Aeson.TH.html#%3C%5E%3E"><span class="hs-operator hs-var">&lt;^&gt;</span></a><span> </span><a href="#local-6989586621679151433"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-543"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-operator">&lt;%&gt;</span><span>
</span><a name="line-544"></a><span>
</span><a name="line-545"></a><span class="hs-comment">-- | Wrap a list of quoted 'Value's in a quoted 'Array' (of type 'Value').</span><span>
</span><a name="line-546"></a><span class="hs-identifier">array</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#ToJSONFun"><span class="hs-identifier hs-type">ToJSONFun</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">ExpQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span>
</span><a name="line-547"></a><a name="array"><a href="Data.Aeson.TH.html#array"><span class="hs-identifier">array</span></a></a><span> </span><a href="Data.Aeson.TH.html#Encoding"><span class="hs-identifier hs-var">Encoding</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><a href="Data.Aeson.Encoding.Internal.html#emptyArray_"><span class="hs-identifier hs-var">E</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">emptyArray_</span></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a name="line-548"></a><span class="hs-identifier">array</span><span> </span><a href="Data.Aeson.TH.html#Value"><span class="hs-identifier hs-var">Value</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><a href="Data.Aeson.Types.Internal.html#Array"><span class="hs-identifier hs-var">Array</span></a><span> </span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a name="line-549"></a><span class="hs-identifier">array</span><span> </span><a href="Data.Aeson.TH.html#Encoding"><span class="hs-identifier hs-var">Encoding</span></a><span> </span><a name="local-6989586621679151434"><a href="#local-6989586621679151434"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><a href="Data.Aeson.Encoding.Internal.html#wrapArray"><span class="hs-identifier hs-var">E</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">wrapArray</span></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">foldr1</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#%3C%25%3E"><span class="hs-operator hs-var">&lt;%&gt;</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151434"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-550"></a><span class="hs-identifier">array</span><span> </span><a href="Data.Aeson.TH.html#Value"><span class="hs-identifier hs-var">Value</span></a><span> </span><a name="local-6989586621679151435"><a href="#local-6989586621679151435"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-551"></a><span>  </span><a name="local-6989586621679151436"><a href="#local-6989586621679151436"><span class="hs-identifier">mv</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;mv&quot;</span><span>
</span><a name="line-552"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679151437"><a href="#local-6989586621679151437"><span class="hs-identifier">newMV</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">bindS</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679151436"><span class="hs-identifier hs-var">mv</span></a><span class="hs-special">)</span><span>
</span><a name="line-553"></a><span>                    </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">VM</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unsafeNew</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span>
</span><a name="line-554"></a><span>                      </span><span class="hs-identifier hs-var">litE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">integerL</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679151435"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-555"></a><span>      </span><a name="local-6989586621679151438"><a href="#local-6989586621679151438"><span class="hs-identifier">stmts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">noBindS</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-556"></a><span>                  </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">VM</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unsafeWrite</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span>
</span><a name="line-557"></a><span>                    </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151436"><span class="hs-identifier hs-var">mv</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span>
</span><a name="line-558"></a><span>                      </span><span class="hs-identifier hs-var">litE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">integerL</span><span> </span><a href="#local-6989586621679151440"><span class="hs-identifier hs-var">ix</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span>
</span><a name="line-559"></a><span>                        </span><a href="#local-6989586621679151441"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-560"></a><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151440"><a href="#local-6989586621679151440"><span class="hs-identifier">ix</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679151441"><a href="#local-6989586621679151441"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">)</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679151435"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-561"></a><span>              </span><span class="hs-special">]</span><span>
</span><a name="line-562"></a><span>      </span><a name="local-6989586621679151439"><a href="#local-6989586621679151439"><span class="hs-identifier">ret</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">noBindS</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">return</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151436"><span class="hs-identifier hs-var">mv</span></a><span>
</span><a name="line-563"></a><span>  </span><span class="hs-special">[</span><span class="hs-glyph">|</span><a href="Data.Aeson.Types.Internal.html#Array"><span class="hs-identifier hs-var">Array</span></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span>
</span><a name="line-564"></a><span>             </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varE</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">V</span><span class="hs-operator">.</span><span class="hs-identifier">create</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span>
</span><a name="line-565"></a><span>               </span><span class="hs-identifier hs-var">doE</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151437"><span class="hs-identifier hs-var">newMV</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679151438"><span class="hs-identifier hs-var">stmts</span></a><span class="hs-operator hs-var">++</span><span class="hs-special">[</span><a href="#local-6989586621679151439"><span class="hs-identifier hs-var">ret</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-566"></a><span>
</span><a name="line-567"></a><span class="hs-comment">-- | Wrap an associative list of keys and quoted values in a quoted 'Object'.</span><span>
</span><a name="line-568"></a><span class="hs-identifier">object</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#ToJSONFun"><span class="hs-identifier hs-type">ToJSONFun</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span>
</span><a name="line-569"></a><a name="object"><a href="Data.Aeson.TH.html#object"><span class="hs-identifier">object</span></a></a><span> </span><a name="local-6989586621679151442"><a href="#local-6989586621679151442"><span class="hs-identifier">target</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#wrapObject"><span class="hs-identifier hs-var">wrapObject</span></a><span> </span><a href="#local-6989586621679151442"><span class="hs-identifier hs-var">target</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.Aeson.TH.html#catPairs"><span class="hs-identifier hs-var">catPairs</span></a><span> </span><a href="#local-6989586621679151442"><span class="hs-identifier hs-var">target</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">uncurry</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#toPair"><span class="hs-identifier hs-var">toPair</span></a><span> </span><a href="#local-6989586621679151442"><span class="hs-identifier hs-var">target</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-570"></a><span>
</span><a name="line-571"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-572"></a><span class="hs-comment">-- - When deriving 'ToJSON', map a list of quoted key-value pairs to an</span><span>
</span><a name="line-573"></a><span class="hs-comment">--   expression of the list of pairs.</span><span>
</span><a name="line-574"></a><span class="hs-comment">-- - When deriving 'ToEncoding', map a list of quoted 'Encoding's representing</span><span>
</span><a name="line-575"></a><span class="hs-comment">--   key-value pairs to a comma-separated 'Encoding' of them.</span><span>
</span><a name="line-576"></a><span class="hs-comment">--</span><span>
</span><a name="line-577"></a><span class="hs-comment">-- &gt; catPairs Value [ [|(k0,v0)|], [|(k1,v1)|] ] = [| [(k0,v0), (k1,v1)] |]</span><span>
</span><a name="line-578"></a><span class="hs-comment">-- &gt; catPairs Encoding [ [|&quot;\&quot;k0\&quot;:v0&quot;|], [|&quot;\&quot;k1\&quot;:v1&quot;|] ] = [| &quot;\&quot;k0\&quot;:v0,\&quot;k1\&quot;:v1&quot; |]</span><span>
</span><a name="line-579"></a><span class="hs-identifier">catPairs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#ToJSONFun"><span class="hs-identifier hs-type">ToJSONFun</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">ExpQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span>
</span><a name="line-580"></a><a name="catPairs"><a href="Data.Aeson.TH.html#catPairs"><span class="hs-identifier">catPairs</span></a></a><span> </span><a href="Data.Aeson.TH.html#Value"><span class="hs-identifier hs-var">Value</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">listE</span><span>
</span><a name="line-581"></a><span class="hs-identifier">catPairs</span><span> </span><a href="Data.Aeson.TH.html#Encoding"><span class="hs-identifier hs-var">Encoding</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr1</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#%3C%25%3E"><span class="hs-operator hs-var">&lt;%&gt;</span></a><span class="hs-special">)</span><span>
</span><a name="line-582"></a><span>
</span><a name="line-583"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-584"></a><span class="hs-comment">-- - When deriving 'ToJSON', wrap a quoted list of key-value pairs in an 'Object'.</span><span>
</span><a name="line-585"></a><span class="hs-comment">-- - When deriving 'ToEncoding', wrap a quoted list of encoded key-value pairs</span><span>
</span><a name="line-586"></a><span class="hs-comment">--   in an encoded 'Object'.</span><span>
</span><a name="line-587"></a><span class="hs-comment">--</span><span>
</span><a name="line-588"></a><span class="hs-comment">-- &gt; objectExp Value [| [(k0,v0), (k1,v1)] |] = [| Object (fromList [(k0,v0), (k1,v1)]) |]</span><span>
</span><a name="line-589"></a><span class="hs-comment">-- &gt; objectExp Encoding [| [&quot;\&quot;k0\&quot;:v0&quot;, &quot;\&quot;k1\&quot;:v1&quot;] |] = [| &quot;{\&quot;k0\&quot;:v0,\&quot;k1\&quot;:v1}&quot; |]</span><span>
</span><a name="line-590"></a><span class="hs-identifier">objectExp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#ToJSONFun"><span class="hs-identifier hs-type">ToJSONFun</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span>
</span><a name="line-591"></a><a name="objectExp"><a href="Data.Aeson.TH.html#objectExp"><span class="hs-identifier">objectExp</span></a></a><span> </span><a name="local-6989586621679151443"><a href="#local-6989586621679151443"><span class="hs-identifier">target</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#wrapObject"><span class="hs-identifier hs-var">wrapObject</span></a><span> </span><a href="#local-6989586621679151443"><span class="hs-identifier hs-var">target</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.Aeson.TH.html#catPairsExp"><span class="hs-identifier hs-var">catPairsExp</span></a><span> </span><a href="#local-6989586621679151443"><span class="hs-identifier hs-var">target</span></a><span>
</span><a name="line-592"></a><span>
</span><a name="line-593"></a><span class="hs-comment">-- | Counterpart of 'catPairsExp' when the list of pairs is already quoted.</span><span>
</span><a name="line-594"></a><span class="hs-comment">--</span><span>
</span><a name="line-595"></a><span class="hs-comment">-- &gt; objectExp Value [| [(k0,v0), (k1,v1)] |] = [| [(k0,v0), (k1,v1)] |]</span><span>
</span><a name="line-596"></a><span class="hs-comment">-- &gt; objectExp Encoding [| [&quot;\&quot;k0\&quot;:v0&quot;, &quot;\&quot;k1\&quot;:v1&quot;] |] = [| &quot;\&quot;k0\&quot;:v0,\&quot;k1\&quot;:v1&quot; |]</span><span>
</span><a name="line-597"></a><span class="hs-identifier">catPairsExp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#ToJSONFun"><span class="hs-identifier hs-type">ToJSONFun</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span>
</span><a name="line-598"></a><a name="catPairsExp"><a href="Data.Aeson.TH.html#catPairsExp"><span class="hs-identifier">catPairsExp</span></a></a><span> </span><a href="Data.Aeson.TH.html#Value"><span class="hs-identifier hs-var">Value</span></a><span> </span><a name="local-6989586621679151444"><a href="#local-6989586621679151444"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151444"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-599"></a><span class="hs-identifier">catPairsExp</span><span> </span><a href="Data.Aeson.TH.html#Encoding"><span class="hs-identifier hs-var">Encoding</span></a><span> </span><a name="local-6989586621679151445"><a href="#local-6989586621679151445"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><a href="Data.Aeson.TH.html#commaSep"><span class="hs-identifier hs-var">commaSep</span></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679151445"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-600"></a><span>
</span><a name="line-601"></a><span class="hs-comment">-- | Create (an encoding of) a key-value pair.</span><span>
</span><a name="line-602"></a><span class="hs-comment">--</span><span>
</span><a name="line-603"></a><span class="hs-comment">-- &gt; toPair Value &quot;k&quot; [|v|] = [|(&quot;k&quot;,v)|]  -- The quoted string is actually Text.</span><span>
</span><a name="line-604"></a><span class="hs-comment">-- &gt; toPair Encoding &quot;k&quot; [|&quot;v&quot;|] = [|&quot;\&quot;k\&quot;:v&quot;|]</span><span>
</span><a name="line-605"></a><span class="hs-identifier">toPair</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#ToJSONFun"><span class="hs-identifier hs-type">ToJSONFun</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span>
</span><a name="line-606"></a><a name="toPair"><a href="Data.Aeson.TH.html#toPair"><span class="hs-identifier">toPair</span></a></a><span> </span><a href="Data.Aeson.TH.html#Value"><span class="hs-identifier hs-var">Value</span></a><span> </span><a name="local-6989586621679151446"><a href="#local-6989586621679151446"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679151447"><a href="#local-6989586621679151447"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">infixApp</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pack</span><span> </span><a href="#local-6989586621679151446"><span class="hs-identifier hs-var">k</span></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-special">(</span><a href="Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">.=</span></a><span class="hs-special">)</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679151447"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-607"></a><span class="hs-identifier">toPair</span><span> </span><a href="Data.Aeson.TH.html#Encoding"><span class="hs-identifier hs-var">Encoding</span></a><span> </span><a name="local-6989586621679151448"><a href="#local-6989586621679151448"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679151449"><a href="#local-6989586621679151449"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><a href="Data.Aeson.Encoding.Internal.html#string"><span class="hs-identifier hs-var">E</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">string</span></a><span> </span><a href="#local-6989586621679151448"><span class="hs-identifier hs-var">k</span></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><a href="Data.Aeson.TH.html#%3C%3A%3E"><span class="hs-operator hs-var">&lt;:&gt;</span></a><span> </span><a href="#local-6989586621679151449"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-608"></a><span>
</span><a name="line-609"></a><span class="hs-comment">-- | Map an associative list in an 'Object'.</span><span>
</span><a name="line-610"></a><span class="hs-comment">--</span><span>
</span><a name="line-611"></a><span class="hs-comment">-- &gt; wrapObject Value [| [(k0,v0), (k1,v1)] |] = [| Object (fromList [(k0,v0), (k1,v1)]) |]</span><span>
</span><a name="line-612"></a><span class="hs-comment">-- &gt; wrapObject Encoding [| &quot;\&quot;k0\&quot;:v0,\&quot;k1\&quot;:v1&quot; |] = [| &quot;{\&quot;k0\&quot;:v0,\&quot;k1\&quot;:v1}&quot; |]</span><span>
</span><a name="line-613"></a><span class="hs-identifier">wrapObject</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#ToJSONFun"><span class="hs-identifier hs-type">ToJSONFun</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span>
</span><a name="line-614"></a><a name="wrapObject"><a href="Data.Aeson.TH.html#wrapObject"><span class="hs-identifier">wrapObject</span></a></a><span> </span><a href="Data.Aeson.TH.html#Value"><span class="hs-identifier hs-var">Value</span></a><span> </span><a name="local-6989586621679151450"><a href="#local-6989586621679151450"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><a href="Data.Aeson.Types.Internal.html#object"><span class="hs-identifier hs-var">A</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">object</span></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679151450"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-615"></a><span class="hs-identifier">wrapObject</span><span> </span><a href="Data.Aeson.TH.html#Encoding"><span class="hs-identifier hs-var">Encoding</span></a><span> </span><a name="local-6989586621679151451"><a href="#local-6989586621679151451"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><a href="Data.Aeson.Encoding.Internal.html#wrapObject"><span class="hs-identifier hs-var">E</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">wrapObject</span></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679151451"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-616"></a><span>
</span><a name="line-617"></a><span class="hs-comment">-- | Separate 'Encoding's by commas.</span><span>
</span><a name="line-618"></a><span class="hs-comment">--</span><span>
</span><a name="line-619"></a><span class="hs-comment">-- &gt; commaSep [&quot;a&quot;,&quot;b&quot;,&quot;c&quot;] = &quot;a,b,c&quot;</span><span>
</span><a name="line-620"></a><span class="hs-identifier">commaSep</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Data.Aeson.Encoding.Internal.html#Encoding"><span class="hs-identifier hs-type">E</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Encoding</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Encoding.Internal.html#Encoding"><span class="hs-identifier hs-type">E</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Encoding</span></a><span>
</span><a name="line-621"></a><a name="commaSep"><a href="Data.Aeson.TH.html#commaSep"><span class="hs-identifier">commaSep</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.Encoding.Internal.html#empty"><span class="hs-identifier hs-var">E</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-622"></a><span class="hs-identifier">commaSep</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679151452"><a href="#local-6989586621679151452"><span class="hs-identifier">x</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151452"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-623"></a><span class="hs-identifier">commaSep</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151453"><a href="#local-6989586621679151453"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679151454"><a href="#local-6989586621679151454"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151453"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="Data.Aeson.Encoding.Internal.html#%3E%3C"><span class="hs-identifier hs-var">E</span><span class="hs-operator hs-var">.&gt;&lt;</span></a><span> </span><a href="Data.Aeson.Encoding.Internal.html#comma"><span class="hs-identifier hs-var">E</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">comma</span></a><span> </span><a href="Data.Aeson.Encoding.Internal.html#%3E%3C"><span class="hs-identifier hs-var">E</span><span class="hs-operator hs-var">.&gt;&lt;</span></a><span> </span><a href="Data.Aeson.TH.html#commaSep"><span class="hs-identifier hs-var">commaSep</span></a><span> </span><a href="#local-6989586621679151454"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-624"></a><span>
</span><a name="line-625"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-626"></a><span class="hs-comment">-- FromJSON</span><span>
</span><a name="line-627"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-628"></a><span>
</span><a name="line-629"></a><span class="hs-comment">-- | Generates a 'FromJSON' instance declaration for the given data type or</span><span>
</span><a name="line-630"></a><span class="hs-comment">-- data family instance constructor.</span><span>
</span><a name="line-631"></a><span class="hs-identifier">deriveFromJSON</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span>
</span><a name="line-632"></a><span>               </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-633"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-634"></a><span>               </span><span class="hs-comment">-- ^ Name of the type for which to generate a 'FromJSON' instance</span><span>
</span><a name="line-635"></a><span>               </span><span class="hs-comment">-- declaration.</span><span>
</span><a name="line-636"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-637"></a><a name="deriveFromJSON"><a href="Data.Aeson.TH.html#deriveFromJSON"><span class="hs-identifier">deriveFromJSON</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#deriveFromJSONCommon"><span class="hs-identifier hs-var">deriveFromJSONCommon</span></a><span> </span><a href="Data.Aeson.TH.html#fromJSONClass"><span class="hs-identifier hs-var">fromJSONClass</span></a><span>
</span><a name="line-638"></a><span>
</span><a name="line-639"></a><span class="hs-comment">-- | Generates a 'FromJSON1' instance declaration for the given data type or</span><span>
</span><a name="line-640"></a><span class="hs-comment">-- data family instance constructor.</span><span>
</span><a name="line-641"></a><span class="hs-identifier">deriveFromJSON1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span>
</span><a name="line-642"></a><span>                </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-643"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-644"></a><span>                </span><span class="hs-comment">-- ^ Name of the type for which to generate a 'FromJSON1' instance</span><span>
</span><a name="line-645"></a><span>                </span><span class="hs-comment">-- declaration.</span><span>
</span><a name="line-646"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-647"></a><a name="deriveFromJSON1"><a href="Data.Aeson.TH.html#deriveFromJSON1"><span class="hs-identifier">deriveFromJSON1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#deriveFromJSONCommon"><span class="hs-identifier hs-var">deriveFromJSONCommon</span></a><span> </span><a href="Data.Aeson.TH.html#fromJSON1Class"><span class="hs-identifier hs-var">fromJSON1Class</span></a><span>
</span><a name="line-648"></a><span>
</span><a name="line-649"></a><span class="hs-comment">-- | Generates a 'FromJSON2' instance declaration for the given data type or</span><span>
</span><a name="line-650"></a><span class="hs-comment">-- data family instance constructor.</span><span>
</span><a name="line-651"></a><span class="hs-identifier">deriveFromJSON2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span>
</span><a name="line-652"></a><span>                </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-653"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-654"></a><span>                </span><span class="hs-comment">-- ^ Name of the type for which to generate a 'FromJSON3' instance</span><span>
</span><a name="line-655"></a><span>                </span><span class="hs-comment">-- declaration.</span><span>
</span><a name="line-656"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-657"></a><a name="deriveFromJSON2"><a href="Data.Aeson.TH.html#deriveFromJSON2"><span class="hs-identifier">deriveFromJSON2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#deriveFromJSONCommon"><span class="hs-identifier hs-var">deriveFromJSONCommon</span></a><span> </span><a href="Data.Aeson.TH.html#fromJSON2Class"><span class="hs-identifier hs-var">fromJSON2Class</span></a><span>
</span><a name="line-658"></a><span>
</span><a name="line-659"></a><span class="hs-identifier">deriveFromJSONCommon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span>
</span><a name="line-660"></a><span>                     </span><span class="hs-comment">-- ^ The FromJSON variant being derived.</span><span>
</span><a name="line-661"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span>
</span><a name="line-662"></a><span>                     </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-663"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-664"></a><span>                     </span><span class="hs-comment">-- ^ Name of the type for which to generate an instance.</span><span>
</span><a name="line-665"></a><span>                     </span><span class="hs-comment">-- declaration.</span><span>
</span><a name="line-666"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-667"></a><a name="deriveFromJSONCommon"><a href="Data.Aeson.TH.html#deriveFromJSONCommon"><span class="hs-identifier">deriveFromJSONCommon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#deriveJSONClass"><span class="hs-identifier hs-var">deriveJSONClass</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#ParseJSON"><span class="hs-identifier hs-var">ParseJSON</span></a><span class="hs-special">,</span><span> </span><a href="Data.Aeson.TH.html#consFromJSON"><span class="hs-identifier hs-var">consFromJSON</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-668"></a><span>
</span><a name="line-669"></a><span class="hs-comment">-- | Generates a lambda expression which parses the JSON encoding of the given</span><span>
</span><a name="line-670"></a><span class="hs-comment">-- data type or data family instance constructor.</span><span>
</span><a name="line-671"></a><span class="hs-identifier">mkParseJSON</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-672"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-comment">-- ^ Name of the encoded type.</span><span>
</span><a name="line-673"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-674"></a><a name="mkParseJSON"><a href="Data.Aeson.TH.html#mkParseJSON"><span class="hs-identifier">mkParseJSON</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#mkParseJSONCommon"><span class="hs-identifier hs-var">mkParseJSONCommon</span></a><span> </span><a href="Data.Aeson.TH.html#fromJSONClass"><span class="hs-identifier hs-var">fromJSONClass</span></a><span>
</span><a name="line-675"></a><span>
</span><a name="line-676"></a><span class="hs-comment">-- | Generates a lambda expression which parses the JSON encoding of the given</span><span>
</span><a name="line-677"></a><span class="hs-comment">-- data type or data family instance constructor by using the given parsing</span><span>
</span><a name="line-678"></a><span class="hs-comment">-- function on occurrences of the last type parameter.</span><span>
</span><a name="line-679"></a><span class="hs-identifier">mkLiftParseJSON</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-680"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-comment">-- ^ Name of the encoded type.</span><span>
</span><a name="line-681"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-682"></a><a name="mkLiftParseJSON"><a href="Data.Aeson.TH.html#mkLiftParseJSON"><span class="hs-identifier">mkLiftParseJSON</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#mkParseJSONCommon"><span class="hs-identifier hs-var">mkParseJSONCommon</span></a><span> </span><a href="Data.Aeson.TH.html#fromJSON1Class"><span class="hs-identifier hs-var">fromJSON1Class</span></a><span>
</span><a name="line-683"></a><span>
</span><a name="line-684"></a><span class="hs-comment">-- | Generates a lambda expression which parses the JSON encoding of the given</span><span>
</span><a name="line-685"></a><span class="hs-comment">-- data type or data family instance constructor by using the given parsing</span><span>
</span><a name="line-686"></a><span class="hs-comment">-- functions on occurrences of the last two type parameters.</span><span>
</span><a name="line-687"></a><span class="hs-identifier">mkLiftParseJSON2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-688"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-comment">-- ^ Name of the encoded type.</span><span>
</span><a name="line-689"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-690"></a><a name="mkLiftParseJSON2"><a href="Data.Aeson.TH.html#mkLiftParseJSON2"><span class="hs-identifier">mkLiftParseJSON2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#mkParseJSONCommon"><span class="hs-identifier hs-var">mkParseJSONCommon</span></a><span> </span><a href="Data.Aeson.TH.html#fromJSON2Class"><span class="hs-identifier hs-var">fromJSON2Class</span></a><span>
</span><a name="line-691"></a><span>
</span><a name="line-692"></a><span class="hs-identifier">mkParseJSONCommon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span> </span><span class="hs-comment">-- ^ Which class's method is being derived.</span><span>
</span><a name="line-693"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-694"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-comment">-- ^ Name of the encoded type.</span><span>
</span><a name="line-695"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-696"></a><a name="mkParseJSONCommon"><a href="Data.Aeson.TH.html#mkParseJSONCommon"><span class="hs-identifier">mkParseJSONCommon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#mkFunCommon"><span class="hs-identifier hs-var">mkFunCommon</span></a><span> </span><a href="Data.Aeson.TH.html#consFromJSON"><span class="hs-identifier hs-var">consFromJSON</span></a><span>
</span><a name="line-697"></a><span>
</span><a name="line-698"></a><span class="hs-comment">-- | Helper function used by both 'deriveFromJSON' and 'mkParseJSON'. Generates</span><span>
</span><a name="line-699"></a><span class="hs-comment">-- code to parse the JSON encoding of a number of constructors. All constructors</span><span>
</span><a name="line-700"></a><span class="hs-comment">-- must be from the same type.</span><span>
</span><a name="line-701"></a><span class="hs-identifier">consFromJSON</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span>
</span><a name="line-702"></a><span>             </span><span class="hs-comment">-- ^ The FromJSON variant being derived.</span><span>
</span><a name="line-703"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-704"></a><span>             </span><span class="hs-comment">-- ^ Name of the type to which the constructors belong.</span><span>
</span><a name="line-705"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span>
</span><a name="line-706"></a><span>             </span><span class="hs-comment">-- ^ Encoding options</span><span>
</span><a name="line-707"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-708"></a><span>             </span><span class="hs-comment">-- ^ The types from the data type/data family instance declaration</span><span>
</span><a name="line-709"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">ConstructorInfo</span><span class="hs-special">]</span><span>
</span><a name="line-710"></a><span>             </span><span class="hs-comment">-- ^ Constructors for which to generate JSON parsing code.</span><span>
</span><a name="line-711"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-712"></a><span>
</span><a name="line-713"></a><a name="consFromJSON"><a href="Data.Aeson.TH.html#consFromJSON"><span class="hs-identifier">consFromJSON</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;Data.Aeson.TH.consFromJSON: &quot;</span><span>
</span><a name="line-714"></a><span>                                </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;Not a single constructor given!&quot;</span><span>
</span><a name="line-715"></a><span>
</span><a name="line-716"></a><span class="hs-identifier">consFromJSON</span><span> </span><a name="local-6989586621679151455"><a href="#local-6989586621679151455"><span class="hs-identifier">jc</span></a></a><span> </span><a name="local-6989586621679151456"><a href="#local-6989586621679151456"><span class="hs-identifier">tName</span></a></a><span> </span><a name="local-6989586621679151457"><a href="#local-6989586621679151457"><span class="hs-identifier">opts</span></a></a><span> </span><a name="local-6989586621679151458"><a href="#local-6989586621679151458"><span class="hs-identifier">vars</span></a></a><span> </span><a name="local-6989586621679151459"><a href="#local-6989586621679151459"><span class="hs-identifier">cons</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-717"></a><span>  </span><a name="local-6989586621679151527"><a href="#local-6989586621679151527"><span class="hs-identifier">value</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;value&quot;</span><span>
</span><a name="line-718"></a><span>  </span><a name="local-6989586621679151528"><a href="#local-6989586621679151528"><span class="hs-identifier">pjs</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Aeson.TH.html#newNameList"><span class="hs-identifier hs-var">newNameList</span></a><span> </span><span class="hs-string">&quot;_pj&quot;</span><span>  </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Aeson.TH.html#arityInt"><span class="hs-identifier hs-var">arityInt</span></a><span> </span><a href="#local-6989586621679151455"><span class="hs-identifier hs-var">jc</span></a><span>
</span><a name="line-719"></a><span>  </span><a name="local-6989586621679151529"><a href="#local-6989586621679151529"><span class="hs-identifier">pjls</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Aeson.TH.html#newNameList"><span class="hs-identifier hs-var">newNameList</span></a><span> </span><span class="hs-string">&quot;_pjl&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Aeson.TH.html#arityInt"><span class="hs-identifier hs-var">arityInt</span></a><span> </span><a href="#local-6989586621679151455"><span class="hs-identifier hs-var">jc</span></a><span>
</span><a name="line-720"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679151530"><a href="#local-6989586621679151530"><span class="hs-identifier">zippedPJs</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621679151528"><span class="hs-identifier hs-var">pjs</span></a><span> </span><a href="#local-6989586621679151529"><span class="hs-identifier hs-var">pjls</span></a><span>
</span><a name="line-721"></a><span>      </span><a name="local-6989586621679151531"><a href="#local-6989586621679151531"><span class="hs-identifier">interleavedPJs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#interleave"><span class="hs-identifier hs-var">interleave</span></a><span> </span><a href="#local-6989586621679151528"><span class="hs-identifier hs-var">pjs</span></a><span> </span><a href="#local-6989586621679151529"><span class="hs-identifier hs-var">pjls</span></a><span>
</span><a name="line-722"></a><span>      </span><a name="local-6989586621679151532"><a href="#local-6989586621679151532"><span class="hs-identifier">lastTyVars</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Data.Aeson.TH.html#varTToName"><span class="hs-identifier hs-var">varTToName</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679151458"><span class="hs-identifier hs-var">vars</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="Data.Aeson.TH.html#arityInt"><span class="hs-identifier hs-var">arityInt</span></a><span> </span><a href="#local-6989586621679151455"><span class="hs-identifier hs-var">jc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151458"><span class="hs-identifier hs-var">vars</span></a><span>
</span><a name="line-723"></a><span>      </span><a name="local-6989586621679151533"><a href="#local-6989586621679151533"><span class="hs-identifier">tvMap</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromList</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621679151532"><span class="hs-identifier hs-var">lastTyVars</span></a><span> </span><a href="#local-6989586621679151530"><span class="hs-identifier hs-var">zippedPJs</span></a><span>
</span><a name="line-724"></a><span>  </span><span class="hs-identifier hs-var">lamE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">varP</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679151531"><span class="hs-identifier hs-var">interleavedPJs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151527"><span class="hs-identifier hs-var">value</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679151461"><span class="hs-identifier hs-var">lamExpr</span></a><span> </span><a href="#local-6989586621679151527"><span class="hs-identifier hs-var">value</span></a><span> </span><a href="#local-6989586621679151533"><span class="hs-identifier hs-var">tvMap</span></a><span>
</span><a name="line-725"></a><span>
</span><a name="line-726"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-727"></a><span>    </span><a name="local-6989586621679151460"><a href="#local-6989586621679151460"><span class="hs-identifier">checkExi</span></a></a><span> </span><a name="local-6989586621679151471"><a href="#local-6989586621679151471"><span class="hs-identifier">tvMap</span></a></a><span> </span><a name="local-6989586621679151472"><a href="#local-6989586621679151472"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#checkExistentialContext"><span class="hs-identifier hs-var">checkExistentialContext</span></a><span> </span><a href="#local-6989586621679151455"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151471"><span class="hs-identifier hs-var">tvMap</span></a><span>
</span><a name="line-728"></a><span>                                                 </span><span class="hs-special">(</span><span class="hs-identifier">constructorContext</span><span> </span><a href="#local-6989586621679151472"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span>
</span><a name="line-729"></a><span>                                                 </span><span class="hs-special">(</span><span class="hs-identifier">constructorName</span><span> </span><a href="#local-6989586621679151472"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span>
</span><a name="line-730"></a><span>
</span><a name="line-731"></a><span>    </span><a name="local-6989586621679151461"><a href="#local-6989586621679151461"><span class="hs-identifier">lamExpr</span></a></a><span> </span><a name="local-6989586621679151473"><a href="#local-6989586621679151473"><span class="hs-identifier">value</span></a></a><span> </span><a name="local-6989586621679151474"><a href="#local-6989586621679151474"><span class="hs-identifier">tvMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679151459"><span class="hs-identifier hs-var">cons</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-732"></a><span>      </span><span class="hs-special">[</span><a name="local-6989586621679151475"><a href="#local-6989586621679151475"><span class="hs-identifier">con</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-733"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">tagSingleConstructors</span><span> </span><a href="#local-6989586621679151457"><span class="hs-identifier hs-var">opts</span></a><span class="hs-special">)</span><span>
</span><a name="line-734"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151460"><span class="hs-identifier hs-var">checkExi</span></a><span> </span><a href="#local-6989586621679151474"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151475"><span class="hs-identifier hs-var">con</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Aeson.TH.html#parseArgs"><span class="hs-identifier hs-var">parseArgs</span></a><span> </span><a href="#local-6989586621679151455"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151474"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151456"><span class="hs-identifier hs-var">tName</span></a><span> </span><a href="#local-6989586621679151457"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679151475"><span class="hs-identifier hs-var">con</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679151473"><span class="hs-identifier hs-var">value</span></a><span class="hs-special">)</span><span>
</span><a name="line-735"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">sumEncoding</span><span> </span><a href="#local-6989586621679151457"><span class="hs-identifier hs-var">opts</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Data.Aeson.Types.Internal.html#UntaggedValue"><span class="hs-identifier hs-var">UntaggedValue</span></a><span>
</span><a name="line-736"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151466"><span class="hs-identifier hs-var">parseUntaggedValue</span></a><span> </span><a href="#local-6989586621679151474"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151459"><span class="hs-identifier hs-var">cons</span></a><span> </span><a href="#local-6989586621679151473"><span class="hs-identifier hs-var">value</span></a><span>
</span><a name="line-737"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-738"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">caseE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151473"><span class="hs-identifier hs-var">value</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-739"></a><span>                   </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">allNullaryToStringTag</span><span> </span><a href="#local-6989586621679151457"><span class="hs-identifier hs-var">opts</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><a href="Data.Aeson.TH.html#isNullary"><span class="hs-identifier hs-var">isNullary</span></a><span> </span><a href="#local-6989586621679151459"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-740"></a><span>                   </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679151462"><span class="hs-identifier hs-var">allNullaryMatches</span></a><span>
</span><a name="line-741"></a><span>                   </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679151463"><span class="hs-identifier hs-var">mixedMatches</span></a><span> </span><a href="#local-6989586621679151474"><span class="hs-identifier hs-var">tvMap</span></a><span>
</span><a name="line-742"></a><span>
</span><a name="line-743"></a><span>    </span><a name="local-6989586621679151462"><a href="#local-6989586621679151462"><span class="hs-identifier">allNullaryMatches</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-744"></a><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679151476"><a href="#local-6989586621679151476"><span class="hs-identifier">txt</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;txt&quot;</span><span>
</span><a name="line-745"></a><span>           </span><span class="hs-identifier hs-var">match</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conP</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">String</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679151476"><span class="hs-identifier hs-var">txt</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-746"></a><span>                 </span><span class="hs-special">(</span><span class="hs-identifier hs-var">guardedB</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-747"></a><span>                  </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">liftM2</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalG</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-748"></a><span>                                  </span><span class="hs-identifier hs-var">infixApp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151476"><span class="hs-identifier hs-var">txt</span></a><span class="hs-special">)</span><span>
</span><a name="line-749"></a><span>                                           </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a name="line-750"></a><span>                                           </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#conTxt"><span class="hs-identifier hs-var">conTxt</span></a><span> </span><a href="#local-6989586621679151457"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679151478"><span class="hs-identifier hs-var">conName</span></a><span class="hs-special">)</span><span>
</span><a name="line-751"></a><span>                               </span><span class="hs-special">)</span><span>
</span><a name="line-752"></a><span>                               </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">pure</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">conE</span><span> </span><a href="#local-6989586621679151478"><span class="hs-identifier hs-var">conName</span></a><span class="hs-special">)</span><span>
</span><a name="line-753"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679151477"><a href="#local-6989586621679151477"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679151459"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-754"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679151478"><a href="#local-6989586621679151478"><span class="hs-identifier">conName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">constructorName</span><span> </span><a href="#local-6989586621679151477"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-755"></a><span>                  </span><span class="hs-special">]</span><span>
</span><a name="line-756"></a><span>                  </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-757"></a><span>                  </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">liftM2</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><a name="line-758"></a><span>                      </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalG</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">otherwise</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-759"></a><span>                      </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><a href="Data.Aeson.TH.html#noMatchFail"><span class="hs-identifier hs-var">noMatchFail</span></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a name="line-760"></a><span>                        </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">litE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">stringL</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679151456"><span class="hs-identifier hs-var">tName</span></a><span class="hs-special">)</span><span>
</span><a name="line-761"></a><span>                        </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unpack</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151476"><span class="hs-identifier hs-var">txt</span></a><span class="hs-special">)</span><span>
</span><a name="line-762"></a><span>                      </span><span class="hs-special">)</span><span>
</span><a name="line-763"></a><span>                  </span><span class="hs-special">]</span><span>
</span><a name="line-764"></a><span>                 </span><span class="hs-special">)</span><span>
</span><a name="line-765"></a><span>                 </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-766"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679151479"><a href="#local-6989586621679151479"><span class="hs-identifier">other</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;other&quot;</span><span>
</span><a name="line-767"></a><span>           </span><span class="hs-identifier hs-var">match</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679151479"><span class="hs-identifier hs-var">other</span></a><span class="hs-special">)</span><span>
</span><a name="line-768"></a><span>                 </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><a href="Data.Aeson.TH.html#noStringFail"><span class="hs-identifier hs-var">noStringFail</span></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a name="line-769"></a><span>                    </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">litE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">stringL</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679151456"><span class="hs-identifier hs-var">tName</span></a><span class="hs-special">)</span><span>
</span><a name="line-770"></a><span>                    </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-glyph">|</span><a href="Data.Aeson.TH.html#valueConName"><span class="hs-identifier hs-var">valueConName</span></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151479"><span class="hs-identifier hs-var">other</span></a><span class="hs-special">)</span><span>
</span><a name="line-771"></a><span>                 </span><span class="hs-special">)</span><span>
</span><a name="line-772"></a><span>                 </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-773"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-774"></a><span>
</span><a name="line-775"></a><span>    </span><a name="local-6989586621679151463"><a href="#local-6989586621679151463"><span class="hs-identifier">mixedMatches</span></a></a><span> </span><a name="local-6989586621679151480"><a href="#local-6989586621679151480"><span class="hs-identifier">tvMap</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-776"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">sumEncoding</span><span> </span><a href="#local-6989586621679151457"><span class="hs-identifier hs-var">opts</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-777"></a><span>          </span><a href="Data.Aeson.Types.Internal.html#TaggedObject"><span class="hs-identifier hs-var">TaggedObject</span></a><span> </span><span class="hs-special">{</span><a name="local-6989586621679151481"><a href="#local-6989586621679151481"><span class="hs-identifier">tagFieldName</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679151482"><a href="#local-6989586621679151482"><span class="hs-identifier">contentsFieldName</span></a></a><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-778"></a><span>            </span><a href="#local-6989586621679151464"><span class="hs-identifier hs-var">parseObject</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679151465"><span class="hs-identifier hs-var">parseTaggedObject</span></a><span> </span><a href="#local-6989586621679151480"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151481"><span class="hs-identifier hs-var">tagFieldName</span></a><span> </span><a href="#local-6989586621679151482"><span class="hs-identifier hs-var">contentsFieldName</span></a><span>
</span><a name="line-779"></a><span>          </span><a href="Data.Aeson.Types.Internal.html#UntaggedValue"><span class="hs-identifier hs-var">UntaggedValue</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;UntaggedValue: Should be handled already&quot;</span><span>
</span><a name="line-780"></a><span>          </span><a href="Data.Aeson.Types.Internal.html#ObjectWithSingleField"><span class="hs-identifier hs-var">ObjectWithSingleField</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-781"></a><span>            </span><a href="#local-6989586621679151464"><span class="hs-identifier hs-var">parseObject</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679151469"><span class="hs-identifier hs-var">parseObjectWithSingleField</span></a><span> </span><a href="#local-6989586621679151480"><span class="hs-identifier hs-var">tvMap</span></a><span>
</span><a name="line-782"></a><span>          </span><a href="Data.Aeson.Types.Internal.html#TwoElemArray"><span class="hs-identifier hs-var">TwoElemArray</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-783"></a><span>            </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679151483"><a href="#local-6989586621679151483"><span class="hs-identifier">arr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;array&quot;</span><span>
</span><a name="line-784"></a><span>                 </span><span class="hs-identifier hs-var">match</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conP</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Array</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679151483"><span class="hs-identifier hs-var">arr</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-785"></a><span>                       </span><span class="hs-special">(</span><span class="hs-identifier hs-var">guardedB</span><span>
</span><a name="line-786"></a><span>                        </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">liftM2</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalG</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">infixApp</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">length</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151483"><span class="hs-identifier hs-var">arr</span></a><span class="hs-special">)</span><span>
</span><a name="line-787"></a><span>                                                         </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a name="line-788"></a><span>                                                         </span><span class="hs-special">(</span><span class="hs-identifier hs-var">litE</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">integerL</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-789"></a><span>                                     </span><span class="hs-special">(</span><a href="#local-6989586621679151468"><span class="hs-identifier hs-var">parse2ElemArray</span></a><span> </span><a href="#local-6989586621679151480"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151483"><span class="hs-identifier hs-var">arr</span></a><span class="hs-special">)</span><span>
</span><a name="line-790"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">liftM2</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalG</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">otherwise</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-791"></a><span>                                     </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-glyph">|</span><a href="Data.Aeson.TH.html#not2ElemArray"><span class="hs-identifier hs-var">not2ElemArray</span></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a name="line-792"></a><span>                                       </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">litE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">stringL</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679151456"><span class="hs-identifier hs-var">tName</span></a><span class="hs-special">)</span><span>
</span><a name="line-793"></a><span>                                       </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">length</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151483"><span class="hs-identifier hs-var">arr</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-794"></a><span>                        </span><span class="hs-special">]</span><span>
</span><a name="line-795"></a><span>                       </span><span class="hs-special">)</span><span>
</span><a name="line-796"></a><span>                       </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-797"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679151484"><a href="#local-6989586621679151484"><span class="hs-identifier">other</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;other&quot;</span><span>
</span><a name="line-798"></a><span>                 </span><span class="hs-identifier hs-var">match</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679151484"><span class="hs-identifier hs-var">other</span></a><span class="hs-special">)</span><span>
</span><a name="line-799"></a><span>                       </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">normalB</span><span>
</span><a name="line-800"></a><span>                         </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><a href="Data.Aeson.TH.html#noArrayFail"><span class="hs-identifier hs-var">noArrayFail</span></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a name="line-801"></a><span>                             </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">litE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">stringL</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679151456"><span class="hs-identifier hs-var">tName</span></a><span class="hs-special">)</span><span>
</span><a name="line-802"></a><span>                             </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-glyph">|</span><a href="Data.Aeson.TH.html#valueConName"><span class="hs-identifier hs-var">valueConName</span></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151484"><span class="hs-identifier hs-var">other</span></a><span class="hs-special">)</span><span>
</span><a name="line-803"></a><span>                       </span><span class="hs-special">)</span><span>
</span><a name="line-804"></a><span>                       </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-805"></a><span>            </span><span class="hs-special">]</span><span>
</span><a name="line-806"></a><span>
</span><a name="line-807"></a><span>    </span><a name="local-6989586621679151464"><a href="#local-6989586621679151464"><span class="hs-identifier">parseObject</span></a></a><span> </span><a name="local-6989586621679151485"><a href="#local-6989586621679151485"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-808"></a><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679151486"><a href="#local-6989586621679151486"><span class="hs-identifier">obj</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;obj&quot;</span><span>
</span><a name="line-809"></a><span>             </span><span class="hs-identifier hs-var">match</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conP</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Object</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679151486"><span class="hs-identifier hs-var">obj</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679151485"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679151486"><span class="hs-identifier hs-var">obj</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-810"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679151487"><a href="#local-6989586621679151487"><span class="hs-identifier">other</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;other&quot;</span><span>
</span><a name="line-811"></a><span>             </span><span class="hs-identifier hs-var">match</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679151487"><span class="hs-identifier hs-var">other</span></a><span class="hs-special">)</span><span>
</span><a name="line-812"></a><span>                   </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">normalB</span><span>
</span><a name="line-813"></a><span>                     </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><a href="Data.Aeson.TH.html#noObjectFail"><span class="hs-identifier hs-var">noObjectFail</span></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a name="line-814"></a><span>                         </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">litE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">stringL</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679151456"><span class="hs-identifier hs-var">tName</span></a><span class="hs-special">)</span><span>
</span><a name="line-815"></a><span>                         </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-glyph">|</span><a href="Data.Aeson.TH.html#valueConName"><span class="hs-identifier hs-var">valueConName</span></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151487"><span class="hs-identifier hs-var">other</span></a><span class="hs-special">)</span><span>
</span><a name="line-816"></a><span>                   </span><span class="hs-special">)</span><span>
</span><a name="line-817"></a><span>                   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-818"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-819"></a><span>
</span><a name="line-820"></a><span>    </span><a name="local-6989586621679151465"><a href="#local-6989586621679151465"><span class="hs-identifier">parseTaggedObject</span></a></a><span> </span><a name="local-6989586621679151488"><a href="#local-6989586621679151488"><span class="hs-identifier">tvMap</span></a></a><span> </span><a name="local-6989586621679151489"><a href="#local-6989586621679151489"><span class="hs-identifier">typFieldName</span></a></a><span> </span><a name="local-6989586621679151490"><a href="#local-6989586621679151490"><span class="hs-identifier">valFieldName</span></a></a><span> </span><a name="local-6989586621679151491"><a href="#local-6989586621679151491"><span class="hs-identifier">obj</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-821"></a><span>      </span><a name="local-6989586621679151492"><a href="#local-6989586621679151492"><span class="hs-identifier">conKey</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;conKey&quot;</span><span>
</span><a name="line-822"></a><span>      </span><span class="hs-identifier hs-var">doE</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">bindS</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679151492"><span class="hs-identifier hs-var">conKey</span></a><span class="hs-special">)</span><span>
</span><a name="line-823"></a><span>                  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">infixApp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151491"><span class="hs-identifier hs-var">obj</span></a><span class="hs-special">)</span><span>
</span><a name="line-824"></a><span>                            </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-special">(</span><a href="Data.Aeson.Types.FromJSON.html#.%3A"><span class="hs-operator hs-var">.:</span></a><span class="hs-special">)</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a name="line-825"></a><span>                            </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pack</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">stringE</span><span> </span><a href="#local-6989586621679151489"><span class="hs-identifier hs-var">typFieldName</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-826"></a><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">noBindS</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679151470"><span class="hs-identifier hs-var">parseContents</span></a><span> </span><a href="#local-6989586621679151488"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151492"><span class="hs-identifier hs-var">conKey</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151490"><span class="hs-identifier hs-var">valFieldName</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151491"><span class="hs-identifier hs-var">obj</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">conNotFoundFailTaggedObject</span><span>
</span><a name="line-827"></a><span>          </span><span class="hs-special">]</span><span>
</span><a name="line-828"></a><span>
</span><a name="line-829"></a><span>    </span><a name="local-6989586621679151466"><a href="#local-6989586621679151466"><span class="hs-identifier">parseUntaggedValue</span></a></a><span> </span><a name="local-6989586621679151493"><a href="#local-6989586621679151493"><span class="hs-identifier">tvMap</span></a></a><span> </span><a name="local-6989586621679151494"><a href="#local-6989586621679151494"><span class="hs-identifier">cons'</span></a></a><span> </span><a name="local-6989586621679151495"><a href="#local-6989586621679151495"><span class="hs-identifier">conVal</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-830"></a><span>        </span><span class="hs-identifier hs-var">foldr1</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679151496"><a href="#local-6989586621679151496"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679151497"><a href="#local-6989586621679151497"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">infixApp</span><span> </span><a href="#local-6989586621679151496"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;|&gt;</span><span class="hs-special">)</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679151497"><span class="hs-identifier hs-var">e'</span></a><span class="hs-special">)</span><span>
</span><a name="line-831"></a><span>               </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679151498"><a href="#local-6989586621679151498"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151467"><span class="hs-identifier hs-var">parseValue</span></a><span> </span><a href="#local-6989586621679151493"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151498"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679151495"><span class="hs-identifier hs-var">conVal</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151494"><span class="hs-identifier hs-var">cons'</span></a><span class="hs-special">)</span><span>
</span><a name="line-832"></a><span>
</span><a name="line-833"></a><span>    </span><a name="local-6989586621679151467"><a href="#local-6989586621679151467"><span class="hs-identifier">parseValue</span></a></a><span> </span><a name="local-6989586621679151499"><a href="#local-6989586621679151499"><span class="hs-identifier">_tvMap</span></a></a><span>
</span><a name="line-834"></a><span>        </span><span class="hs-identifier hs-var">ConstructorInfo</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">constructorName</span><span>    </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151500"><a href="#local-6989586621679151500"><span class="hs-identifier">conName</span></a></a><span>
</span><a name="line-835"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">constructorVariant</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">NormalConstructor</span><span>
</span><a name="line-836"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">constructorFields</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-837"></a><span>        </span><a name="local-6989586621679151501"><a href="#local-6989586621679151501"><span class="hs-identifier">conVal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-838"></a><span>      </span><a name="local-6989586621679151502"><a href="#local-6989586621679151502"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;str&quot;</span><span>
</span><a name="line-839"></a><span>      </span><span class="hs-identifier hs-var">caseE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151501"><span class="hs-identifier hs-var">conVal</span></a><span class="hs-special">)</span><span>
</span><a name="line-840"></a><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">match</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conP</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">String</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679151502"><span class="hs-identifier hs-var">str</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-841"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">guardedB</span><span>
</span><a name="line-842"></a><span>                  </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">liftM2</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalG</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">infixApp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151502"><span class="hs-identifier hs-var">str</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#conTxt"><span class="hs-identifier hs-var">conTxt</span></a><span> </span><a href="#local-6989586621679151457"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679151500"><span class="hs-identifier hs-var">conName</span></a><span class="hs-special">)</span><span>
</span><a name="line-843"></a><span>                               </span><span class="hs-special">)</span><span>
</span><a name="line-844"></a><span>                               </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">pure</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">conE</span><span> </span><a href="#local-6989586621679151500"><span class="hs-identifier hs-var">conName</span></a><span class="hs-special">)</span><span>
</span><a name="line-845"></a><span>                  </span><span class="hs-special">]</span><span>
</span><a name="line-846"></a><span>                </span><span class="hs-special">)</span><span>
</span><a name="line-847"></a><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-848"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.TH.html#matchFailed"><span class="hs-identifier hs-var">matchFailed</span></a><span> </span><a href="#local-6989586621679151456"><span class="hs-identifier hs-var">tName</span></a><span> </span><a href="#local-6989586621679151500"><span class="hs-identifier hs-var">conName</span></a><span> </span><span class="hs-string">&quot;String&quot;</span><span>
</span><a name="line-849"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-850"></a><span>    </span><span class="hs-identifier">parseValue</span><span> </span><a name="local-6989586621679151503"><a href="#local-6989586621679151503"><span class="hs-identifier">tvMap</span></a></a><span> </span><a name="local-6989586621679151504"><a href="#local-6989586621679151504"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-6989586621679151505"><a href="#local-6989586621679151505"><span class="hs-identifier">conVal</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-851"></a><span>      </span><a href="#local-6989586621679151460"><span class="hs-identifier hs-var">checkExi</span></a><span> </span><a href="#local-6989586621679151503"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151504"><span class="hs-identifier hs-var">con</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Aeson.TH.html#parseArgs"><span class="hs-identifier hs-var">parseArgs</span></a><span> </span><a href="#local-6989586621679151455"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151503"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151456"><span class="hs-identifier hs-var">tName</span></a><span> </span><a href="#local-6989586621679151457"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679151504"><span class="hs-identifier hs-var">con</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679151505"><span class="hs-identifier hs-var">conVal</span></a><span class="hs-special">)</span><span>
</span><a name="line-852"></a><span>
</span><a name="line-853"></a><span>
</span><a name="line-854"></a><span>    </span><a name="local-6989586621679151468"><a href="#local-6989586621679151468"><span class="hs-identifier">parse2ElemArray</span></a></a><span> </span><a name="local-6989586621679151506"><a href="#local-6989586621679151506"><span class="hs-identifier">tvMap</span></a></a><span> </span><a name="local-6989586621679151507"><a href="#local-6989586621679151507"><span class="hs-identifier">arr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-855"></a><span>      </span><a name="local-6989586621679151508"><a href="#local-6989586621679151508"><span class="hs-identifier">conKey</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;conKey&quot;</span><span>
</span><a name="line-856"></a><span>      </span><a name="local-6989586621679151509"><a href="#local-6989586621679151509"><span class="hs-identifier">conVal</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;conVal&quot;</span><span>
</span><a name="line-857"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679151510"><a href="#local-6989586621679151510"><span class="hs-identifier">letIx</span></a></a><span> </span><a name="local-6989586621679151511"><a href="#local-6989586621679151511"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679151512"><a href="#local-6989586621679151512"><span class="hs-identifier">ix</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-858"></a><span>              </span><span class="hs-identifier hs-var">valD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679151511"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-859"></a><span>                   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unsafeIndex</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span>
</span><a name="line-860"></a><span>                               </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151507"><span class="hs-identifier hs-var">arr</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span>
</span><a name="line-861"></a><span>                               </span><span class="hs-identifier hs-var">litE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">integerL</span><span> </span><a href="#local-6989586621679151512"><span class="hs-identifier hs-var">ix</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-862"></a><span>                   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-863"></a><span>      </span><span class="hs-identifier hs-var">letE</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679151510"><span class="hs-identifier hs-var">letIx</span></a><span> </span><a href="#local-6989586621679151508"><span class="hs-identifier hs-var">conKey</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-864"></a><span>           </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151510"><span class="hs-identifier hs-var">letIx</span></a><span> </span><a href="#local-6989586621679151509"><span class="hs-identifier hs-var">conVal</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-865"></a><span>           </span><span class="hs-special">]</span><span>
</span><a name="line-866"></a><span>           </span><span class="hs-special">(</span><span class="hs-identifier hs-var">caseE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151508"><span class="hs-identifier hs-var">conKey</span></a><span class="hs-special">)</span><span>
</span><a name="line-867"></a><span>                  </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679151513"><a href="#local-6989586621679151513"><span class="hs-identifier">txt</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;txt&quot;</span><span>
</span><a name="line-868"></a><span>                       </span><span class="hs-identifier hs-var">match</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conP</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">String</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679151513"><span class="hs-identifier hs-var">txt</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-869"></a><span>                             </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679151470"><span class="hs-identifier hs-var">parseContents</span></a><span> </span><a href="#local-6989586621679151506"><span class="hs-identifier hs-var">tvMap</span></a><span>
</span><a name="line-870"></a><span>                                                      </span><a href="#local-6989586621679151513"><span class="hs-identifier hs-var">txt</span></a><span>
</span><a name="line-871"></a><span>                                                      </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679151509"><span class="hs-identifier hs-var">conVal</span></a><span class="hs-special">)</span><span>
</span><a name="line-872"></a><span>                                                      </span><span class="hs-special">'</span><span class="hs-identifier">conNotFoundFail2ElemArray</span><span>
</span><a name="line-873"></a><span>                             </span><span class="hs-special">)</span><span>
</span><a name="line-874"></a><span>                             </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-875"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679151514"><a href="#local-6989586621679151514"><span class="hs-identifier">other</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;other&quot;</span><span>
</span><a name="line-876"></a><span>                       </span><span class="hs-identifier hs-var">match</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679151514"><span class="hs-identifier hs-var">other</span></a><span class="hs-special">)</span><span>
</span><a name="line-877"></a><span>                             </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">normalB</span><span>
</span><a name="line-878"></a><span>                               </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><a href="Data.Aeson.TH.html#firstElemNoStringFail"><span class="hs-identifier hs-var">firstElemNoStringFail</span></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a name="line-879"></a><span>                                     </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">litE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">stringL</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679151456"><span class="hs-identifier hs-var">tName</span></a><span class="hs-special">)</span><span>
</span><a name="line-880"></a><span>                                     </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-glyph">|</span><a href="Data.Aeson.TH.html#valueConName"><span class="hs-identifier hs-var">valueConName</span></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151514"><span class="hs-identifier hs-var">other</span></a><span class="hs-special">)</span><span>
</span><a name="line-881"></a><span>                             </span><span class="hs-special">)</span><span>
</span><a name="line-882"></a><span>                             </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-883"></a><span>                  </span><span class="hs-special">]</span><span>
</span><a name="line-884"></a><span>           </span><span class="hs-special">)</span><span>
</span><a name="line-885"></a><span>
</span><a name="line-886"></a><span>    </span><a name="local-6989586621679151469"><a href="#local-6989586621679151469"><span class="hs-identifier">parseObjectWithSingleField</span></a></a><span> </span><a name="local-6989586621679151515"><a href="#local-6989586621679151515"><span class="hs-identifier">tvMap</span></a></a><span> </span><a name="local-6989586621679151516"><a href="#local-6989586621679151516"><span class="hs-identifier">obj</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-887"></a><span>      </span><a name="local-6989586621679151517"><a href="#local-6989586621679151517"><span class="hs-identifier">conKey</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;conKey&quot;</span><span>
</span><a name="line-888"></a><span>      </span><a name="local-6989586621679151518"><a href="#local-6989586621679151518"><span class="hs-identifier">conVal</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;conVal&quot;</span><span>
</span><a name="line-889"></a><span>      </span><span class="hs-identifier hs-var">caseE</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier">e</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">H</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toList</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151516"><span class="hs-identifier hs-var">obj</span></a><span class="hs-special">)</span><span>
</span><a name="line-890"></a><span>            </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">match</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">listP</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">tupP</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679151517"><span class="hs-identifier hs-var">conKey</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679151518"><span class="hs-identifier hs-var">conVal</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-891"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679151470"><span class="hs-identifier hs-var">parseContents</span></a><span> </span><a href="#local-6989586621679151515"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151517"><span class="hs-identifier hs-var">conKey</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679151518"><span class="hs-identifier hs-var">conVal</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">conNotFoundFailObjectSingleField</span><span class="hs-special">)</span><span>
</span><a name="line-892"></a><span>                    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-893"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679151519"><a href="#local-6989586621679151519"><span class="hs-identifier">other</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;other&quot;</span><span>
</span><a name="line-894"></a><span>                 </span><span class="hs-identifier hs-var">match</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679151519"><span class="hs-identifier hs-var">other</span></a><span class="hs-special">)</span><span>
</span><a name="line-895"></a><span>                       </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><a href="Data.Aeson.TH.html#wrongPairCountFail"><span class="hs-identifier hs-var">wrongPairCountFail</span></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a name="line-896"></a><span>                                  </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">litE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">stringL</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679151456"><span class="hs-identifier hs-var">tName</span></a><span class="hs-special">)</span><span>
</span><a name="line-897"></a><span>                                  </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">length</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151519"><span class="hs-identifier hs-var">other</span></a><span class="hs-special">)</span><span>
</span><a name="line-898"></a><span>                       </span><span class="hs-special">)</span><span>
</span><a name="line-899"></a><span>                       </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-900"></a><span>            </span><span class="hs-special">]</span><span>
</span><a name="line-901"></a><span>
</span><a name="line-902"></a><span>    </span><a name="local-6989586621679151470"><a href="#local-6989586621679151470"><span class="hs-identifier">parseContents</span></a></a><span> </span><a name="local-6989586621679151520"><a href="#local-6989586621679151520"><span class="hs-identifier">tvMap</span></a></a><span> </span><a name="local-6989586621679151521"><a href="#local-6989586621679151521"><span class="hs-identifier">conKey</span></a></a><span> </span><a name="local-6989586621679151522"><a href="#local-6989586621679151522"><span class="hs-identifier">contents</span></a></a><span> </span><a name="local-6989586621679151523"><a href="#local-6989586621679151523"><span class="hs-identifier">errorFun</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-903"></a><span>        </span><span class="hs-identifier hs-var">caseE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151521"><span class="hs-identifier hs-var">conKey</span></a><span class="hs-special">)</span><span>
</span><a name="line-904"></a><span>              </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">match</span><span> </span><span class="hs-identifier hs-var">wildP</span><span>
</span><a name="line-905"></a><span>                      </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">guardedB</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-906"></a><span>                        </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679151525"><a href="#local-6989586621679151525"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">normalG</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">infixApp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151521"><span class="hs-identifier hs-var">conKey</span></a><span class="hs-special">)</span><span>
</span><a name="line-907"></a><span>                                                     </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a name="line-908"></a><span>                                                     </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pack</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span>
</span><a name="line-909"></a><span>                                                        </span><a href="Data.Aeson.TH.html#conNameExp"><span class="hs-identifier hs-var">conNameExp</span></a><span> </span><a href="#local-6989586621679151457"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679151524"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span>
</span><a name="line-910"></a><span>                             </span><a name="local-6989586621679151526"><a href="#local-6989586621679151526"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679151460"><span class="hs-identifier hs-var">checkExi</span></a><span> </span><a href="#local-6989586621679151520"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151524"><span class="hs-identifier hs-var">con</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-911"></a><span>                                  </span><a href="Data.Aeson.TH.html#parseArgs"><span class="hs-identifier hs-var">parseArgs</span></a><span> </span><a href="#local-6989586621679151455"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151520"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151456"><span class="hs-identifier hs-var">tName</span></a><span> </span><a href="#local-6989586621679151457"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679151524"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="#local-6989586621679151522"><span class="hs-identifier hs-var">contents</span></a><span>
</span><a name="line-912"></a><span>                             </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151525"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151526"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-913"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679151524"><a href="#local-6989586621679151524"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679151459"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-914"></a><span>                        </span><span class="hs-special">]</span><span>
</span><a name="line-915"></a><span>                        </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-916"></a><span>                        </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">liftM2</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><a name="line-917"></a><span>                                 </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalG</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">e</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">otherwise</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-918"></a><span>                                 </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151523"><span class="hs-identifier hs-var">errorFun</span></a><span>
</span><a name="line-919"></a><span>                                   </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">litE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">stringL</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679151456"><span class="hs-identifier hs-var">tName</span></a><span class="hs-special">)</span><span>
</span><a name="line-920"></a><span>                                   </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">listE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">litE</span><span>
</span><a name="line-921"></a><span>                                                     </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">stringL</span><span>
</span><a name="line-922"></a><span>                                                     </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">constructorTagModifier</span><span> </span><a href="#local-6989586621679151457"><span class="hs-identifier hs-var">opts</span></a><span>
</span><a name="line-923"></a><span>                                                     </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">nameBase</span><span>
</span><a name="line-924"></a><span>                                                     </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">constructorName</span><span>
</span><a name="line-925"></a><span>                                                     </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151459"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-926"></a><span>                                                </span><span class="hs-special">)</span><span>
</span><a name="line-927"></a><span>                                   </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unpack</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151521"><span class="hs-identifier hs-var">conKey</span></a><span class="hs-special">)</span><span>
</span><a name="line-928"></a><span>                                 </span><span class="hs-special">)</span><span>
</span><a name="line-929"></a><span>                        </span><span class="hs-special">]</span><span>
</span><a name="line-930"></a><span>                      </span><span class="hs-special">)</span><span>
</span><a name="line-931"></a><span>                      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-932"></a><span>              </span><span class="hs-special">]</span><span>
</span><a name="line-933"></a><span>
</span><a name="line-934"></a><span class="hs-identifier">parseNullaryMatches</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Match</span><span class="hs-special">]</span><span>
</span><a name="line-935"></a><a name="parseNullaryMatches"><a href="Data.Aeson.TH.html#parseNullaryMatches"><span class="hs-identifier">parseNullaryMatches</span></a></a><span> </span><a name="local-6989586621679151534"><a href="#local-6989586621679151534"><span class="hs-identifier">tName</span></a></a><span> </span><a name="local-6989586621679151535"><a href="#local-6989586621679151535"><span class="hs-identifier">conName</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-936"></a><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679151536"><a href="#local-6989586621679151536"><span class="hs-identifier">arr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;arr&quot;</span><span>
</span><a name="line-937"></a><span>         </span><span class="hs-identifier hs-var">match</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conP</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Array</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679151536"><span class="hs-identifier hs-var">arr</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-938"></a><span>               </span><span class="hs-special">(</span><span class="hs-identifier hs-var">guardedB</span><span>
</span><a name="line-939"></a><span>                </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">liftM2</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalG</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">null</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151536"><span class="hs-identifier hs-var">arr</span></a><span class="hs-special">)</span><span>
</span><a name="line-940"></a><span>                             </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">pure</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">conE</span><span> </span><a href="#local-6989586621679151535"><span class="hs-identifier hs-var">conName</span></a><span class="hs-special">)</span><span>
</span><a name="line-941"></a><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">liftM2</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalG</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">otherwise</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-942"></a><span>                             </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#parseTypeMismatch"><span class="hs-identifier hs-var">parseTypeMismatch</span></a><span> </span><a href="#local-6989586621679151534"><span class="hs-identifier hs-var">tName</span></a><span> </span><a href="#local-6989586621679151535"><span class="hs-identifier hs-var">conName</span></a><span>
</span><a name="line-943"></a><span>                                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">litE</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">stringL</span><span> </span><span class="hs-string">&quot;an empty Array&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-944"></a><span>                                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">infixApp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">litE</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">stringL</span><span> </span><span class="hs-string">&quot;Array of length &quot;</span><span class="hs-special">)</span><span>
</span><a name="line-945"></a><span>                                          </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-special">(</span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a name="line-946"></a><span>                                          </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">length</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151536"><span class="hs-identifier hs-var">arr</span></a><span class="hs-special">)</span><span>
</span><a name="line-947"></a><span>                                </span><span class="hs-special">)</span><span>
</span><a name="line-948"></a><span>                             </span><span class="hs-special">)</span><span>
</span><a name="line-949"></a><span>                </span><span class="hs-special">]</span><span>
</span><a name="line-950"></a><span>               </span><span class="hs-special">)</span><span>
</span><a name="line-951"></a><span>               </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-952"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.TH.html#matchFailed"><span class="hs-identifier hs-var">matchFailed</span></a><span> </span><a href="#local-6989586621679151534"><span class="hs-identifier hs-var">tName</span></a><span> </span><a href="#local-6989586621679151535"><span class="hs-identifier hs-var">conName</span></a><span> </span><span class="hs-string">&quot;Array&quot;</span><span>
</span><a name="line-953"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-954"></a><span>
</span><a name="line-955"></a><span class="hs-identifier">parseUnaryMatches</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#TyVarMap"><span class="hs-identifier hs-type">TyVarMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Match</span><span class="hs-special">]</span><span>
</span><a name="line-956"></a><a name="parseUnaryMatches"><a href="Data.Aeson.TH.html#parseUnaryMatches"><span class="hs-identifier">parseUnaryMatches</span></a></a><span> </span><a name="local-6989586621679151537"><a href="#local-6989586621679151537"><span class="hs-identifier">jc</span></a></a><span> </span><a name="local-6989586621679151538"><a href="#local-6989586621679151538"><span class="hs-identifier">tvMap</span></a></a><span> </span><a name="local-6989586621679151539"><a href="#local-6989586621679151539"><span class="hs-identifier">argTy</span></a></a><span> </span><a name="local-6989586621679151540"><a href="#local-6989586621679151540"><span class="hs-identifier">conName</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-957"></a><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679151541"><a href="#local-6989586621679151541"><span class="hs-identifier">arg</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;arg&quot;</span><span>
</span><a name="line-958"></a><span>         </span><span class="hs-identifier hs-var">match</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679151541"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">)</span><span>
</span><a name="line-959"></a><span>               </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">infixApp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conE</span><span> </span><a href="#local-6989586621679151540"><span class="hs-identifier hs-var">conName</span></a><span class="hs-special">)</span><span>
</span><a name="line-960"></a><span>                                    </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;$&gt;</span><span class="hs-special">)</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a name="line-961"></a><span>                                    </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#dispatchParseJSON"><span class="hs-identifier hs-var">dispatchParseJSON</span></a><span> </span><a href="#local-6989586621679151537"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151540"><span class="hs-identifier hs-var">conName</span></a><span> </span><a href="#local-6989586621679151538"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151539"><span class="hs-identifier hs-var">argTy</span></a><span>
</span><a name="line-962"></a><span>                                      </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151541"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">)</span><span>
</span><a name="line-963"></a><span>               </span><span class="hs-special">)</span><span>
</span><a name="line-964"></a><span>               </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-965"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-966"></a><span>
</span><a name="line-967"></a><span class="hs-identifier">parseRecord</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span>
</span><a name="line-968"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#TyVarMap"><span class="hs-identifier hs-type">TyVarMap</span></a><span>
</span><a name="line-969"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-970"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span>
</span><a name="line-971"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-972"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-973"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">]</span><span>
</span><a name="line-974"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-975"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span>
</span><a name="line-976"></a><a name="parseRecord"><a href="Data.Aeson.TH.html#parseRecord"><span class="hs-identifier">parseRecord</span></a></a><span> </span><a name="local-6989586621679151542"><a href="#local-6989586621679151542"><span class="hs-identifier">jc</span></a></a><span> </span><a name="local-6989586621679151543"><a href="#local-6989586621679151543"><span class="hs-identifier">tvMap</span></a></a><span> </span><a name="local-6989586621679151544"><a href="#local-6989586621679151544"><span class="hs-identifier">argTys</span></a></a><span> </span><a name="local-6989586621679151545"><a href="#local-6989586621679151545"><span class="hs-identifier">opts</span></a></a><span> </span><a name="local-6989586621679151546"><a href="#local-6989586621679151546"><span class="hs-identifier">tName</span></a></a><span> </span><a name="local-6989586621679151547"><a href="#local-6989586621679151547"><span class="hs-identifier">conName</span></a></a><span> </span><a name="local-6989586621679151548"><a href="#local-6989586621679151548"><span class="hs-identifier">fields</span></a></a><span> </span><a name="local-6989586621679151549"><a href="#local-6989586621679151549"><span class="hs-identifier">obj</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-977"></a><span>    </span><span class="hs-identifier hs-var">foldl'</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679151554"><a href="#local-6989586621679151554"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679151555"><a href="#local-6989586621679151555"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">infixApp</span><span> </span><a href="#local-6989586621679151554"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;*&gt;</span><span class="hs-special">)</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679151555"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-978"></a><span>           </span><span class="hs-special">(</span><span class="hs-identifier hs-var">infixApp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conE</span><span> </span><a href="#local-6989586621679151547"><span class="hs-identifier hs-var">conName</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;$&gt;</span><span class="hs-special">)</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679151550"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-979"></a><span>           </span><a href="#local-6989586621679151551"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-980"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-981"></a><span>      </span><a name="local-6989586621679151550"><a href="#local-6989586621679151550"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151551"><a href="#local-6989586621679151551"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><a href="Data.Aeson.TH.html#lookupField"><span class="hs-identifier hs-var">lookupField</span></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a name="line-982"></a><span>               </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><a href="Data.Aeson.TH.html#dispatchParseJSON"><span class="hs-identifier hs-var">dispatchParseJSON</span></a><span> </span><a href="#local-6989586621679151542"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151547"><span class="hs-identifier hs-var">conName</span></a><span> </span><a href="#local-6989586621679151543"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151553"><span class="hs-identifier hs-var">argTy</span></a><span>
</span><a name="line-983"></a><span>               </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">litE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">stringL</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679151546"><span class="hs-identifier hs-var">tName</span></a><span class="hs-special">)</span><span>
</span><a name="line-984"></a><span>               </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">litE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">stringL</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">constructorTagModifier</span><span> </span><a href="#local-6989586621679151545"><span class="hs-identifier hs-var">opts</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">nameBase</span><span> </span><a href="#local-6989586621679151547"><span class="hs-identifier hs-var">conName</span></a><span class="hs-special">)</span><span>
</span><a name="line-985"></a><span>               </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151549"><span class="hs-identifier hs-var">obj</span></a><span>
</span><a name="line-986"></a><span>               </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pack</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">stringE</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#fieldLabel"><span class="hs-identifier hs-var">fieldLabel</span></a><span> </span><a href="#local-6989586621679151545"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679151552"><span class="hs-identifier hs-var">field</span></a><span class="hs-special">)</span><span>
</span><a name="line-987"></a><span>                      </span><span class="hs-special">)</span><span>
</span><a name="line-988"></a><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151552"><a href="#local-6989586621679151552"><span class="hs-identifier">field</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679151553"><a href="#local-6989586621679151553"><span class="hs-identifier">argTy</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621679151548"><span class="hs-identifier hs-var">fields</span></a><span> </span><a href="#local-6989586621679151544"><span class="hs-identifier hs-var">argTys</span></a><span>
</span><a name="line-989"></a><span>             </span><span class="hs-special">]</span><span>
</span><a name="line-990"></a><span>
</span><a name="line-991"></a><span class="hs-identifier">getValField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">MatchQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-992"></a><a name="getValField"><a href="Data.Aeson.TH.html#getValField"><span class="hs-identifier">getValField</span></a></a><span> </span><a name="local-6989586621679151556"><a href="#local-6989586621679151556"><span class="hs-identifier">obj</span></a></a><span> </span><a name="local-6989586621679151557"><a href="#local-6989586621679151557"><span class="hs-identifier">valFieldName</span></a></a><span> </span><a name="local-6989586621679151558"><a href="#local-6989586621679151558"><span class="hs-identifier">matches</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-993"></a><span>  </span><a name="local-6989586621679151559"><a href="#local-6989586621679151559"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;val&quot;</span><span>
</span><a name="line-994"></a><span>  </span><span class="hs-identifier hs-var">doE</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">bindS</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679151559"><span class="hs-identifier hs-var">val</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">infixApp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151556"><span class="hs-identifier hs-var">obj</span></a><span class="hs-special">)</span><span>
</span><a name="line-995"></a><span>                                    </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-special">(</span><a href="Data.Aeson.Types.FromJSON.html#.%3A"><span class="hs-operator hs-var">.:</span></a><span class="hs-special">)</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a name="line-996"></a><span>                                    </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pack</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span>
</span><a name="line-997"></a><span>                                       </span><span class="hs-identifier hs-var">litE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">stringL</span><span> </span><a href="#local-6989586621679151557"><span class="hs-identifier hs-var">valFieldName</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-998"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">noBindS</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">caseE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151559"><span class="hs-identifier hs-var">val</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151558"><span class="hs-identifier hs-var">matches</span></a><span>
</span><a name="line-999"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-1000"></a><span>
</span><a name="line-1001"></a><span class="hs-identifier">matchCases</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Name</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">MatchQ</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-1002"></a><a name="matchCases"><a href="Data.Aeson.TH.html#matchCases"><span class="hs-identifier">matchCases</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151560"><a href="#local-6989586621679151560"><span class="hs-identifier">valFieldName</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679151561"><a href="#local-6989586621679151561"><span class="hs-identifier">obj</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#getValField"><span class="hs-identifier hs-var">getValField</span></a><span> </span><a href="#local-6989586621679151561"><span class="hs-identifier hs-var">obj</span></a><span> </span><a href="#local-6989586621679151560"><span class="hs-identifier hs-var">valFieldName</span></a><span>
</span><a name="line-1003"></a><span class="hs-identifier">matchCases</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679151562"><a href="#local-6989586621679151562"><span class="hs-identifier">valName</span></a></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">caseE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151562"><span class="hs-identifier hs-var">valName</span></a><span class="hs-special">)</span><span>
</span><a name="line-1004"></a><span>
</span><a name="line-1005"></a><span class="hs-comment">-- | Generates code to parse the JSON encoding of a single constructor.</span><span>
</span><a name="line-1006"></a><span class="hs-identifier">parseArgs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span> </span><span class="hs-comment">-- ^ The FromJSON variant being derived.</span><span>
</span><a name="line-1007"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#TyVarMap"><span class="hs-identifier hs-type">TyVarMap</span></a><span> </span><span class="hs-comment">-- ^ Maps the last type variables to their decoding</span><span>
</span><a name="line-1008"></a><span>                      </span><span class="hs-comment">--   function arguments.</span><span>
</span><a name="line-1009"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-comment">-- ^ Name of the type to which the constructor belongs.</span><span>
</span><a name="line-1010"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-1011"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ConstructorInfo</span><span> </span><span class="hs-comment">-- ^ Constructor for which to generate JSON parsing code.</span><span>
</span><a name="line-1012"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Name</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-comment">-- ^ Left (valFieldName, objName) or</span><span>
</span><a name="line-1013"></a><span>                                        </span><span class="hs-comment">--   Right valName</span><span>
</span><a name="line-1014"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-1015"></a><span class="hs-comment">-- Nullary constructors.</span><span>
</span><a name="line-1016"></a><a name="parseArgs"><a href="Data.Aeson.TH.html#parseArgs"><span class="hs-identifier">parseArgs</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-1017"></a><span>  </span><span class="hs-identifier hs-var">ConstructorInfo</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">constructorName</span><span>    </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151563"><a href="#local-6989586621679151563"><span class="hs-identifier">conName</span></a></a><span>
</span><a name="line-1018"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">constructorVariant</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">NormalConstructor</span><span>
</span><a name="line-1019"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">constructorFields</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1020"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1021"></a><span>    </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">pure</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">conE</span><span> </span><a href="#local-6989586621679151563"><span class="hs-identifier hs-var">conName</span></a><span>
</span><a name="line-1022"></a><span class="hs-identifier">parseArgs</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679151564"><a href="#local-6989586621679151564"><span class="hs-identifier">tName</span></a></a><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-1023"></a><span>  </span><span class="hs-identifier hs-var">ConstructorInfo</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">constructorName</span><span>    </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151565"><a href="#local-6989586621679151565"><span class="hs-identifier">conName</span></a></a><span>
</span><a name="line-1024"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">constructorVariant</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">NormalConstructor</span><span>
</span><a name="line-1025"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">constructorFields</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1026"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679151566"><a href="#local-6989586621679151566"><span class="hs-identifier">valName</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1027"></a><span>    </span><span class="hs-identifier hs-var">caseE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151566"><span class="hs-identifier hs-var">valName</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Aeson.TH.html#parseNullaryMatches"><span class="hs-identifier hs-var">parseNullaryMatches</span></a><span> </span><a href="#local-6989586621679151564"><span class="hs-identifier hs-var">tName</span></a><span> </span><a href="#local-6989586621679151565"><span class="hs-identifier hs-var">conName</span></a><span>
</span><a name="line-1028"></a><span>
</span><a name="line-1029"></a><span class="hs-comment">-- Unary constructors.</span><span>
</span><a name="line-1030"></a><span class="hs-identifier">parseArgs</span><span> </span><a name="local-6989586621679151567"><a href="#local-6989586621679151567"><span class="hs-identifier">jc</span></a></a><span> </span><a name="local-6989586621679151568"><a href="#local-6989586621679151568"><span class="hs-identifier">tvMap</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-1031"></a><span>  </span><span class="hs-identifier hs-var">ConstructorInfo</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">constructorName</span><span>    </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151569"><a href="#local-6989586621679151569"><span class="hs-identifier">conName</span></a></a><span>
</span><a name="line-1032"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">constructorVariant</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">NormalConstructor</span><span>
</span><a name="line-1033"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">constructorFields</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679151570"><a href="#local-6989586621679151570"><span class="hs-identifier">argTy</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1034"></a><span>  </span><a name="local-6989586621679151571"><a href="#local-6989586621679151571"><span class="hs-identifier">contents</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1035"></a><span>    </span><a name="local-6989586621679151572"><a href="#local-6989586621679151572"><span class="hs-identifier">argTy'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">resolveTypeSynonyms</span><span> </span><a href="#local-6989586621679151570"><span class="hs-identifier hs-var">argTy</span></a><span>
</span><a name="line-1036"></a><span>    </span><a href="Data.Aeson.TH.html#matchCases"><span class="hs-identifier hs-var">matchCases</span></a><span> </span><a href="#local-6989586621679151571"><span class="hs-identifier hs-var">contents</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Aeson.TH.html#parseUnaryMatches"><span class="hs-identifier hs-var">parseUnaryMatches</span></a><span> </span><a href="#local-6989586621679151567"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151568"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151572"><span class="hs-identifier hs-var">argTy'</span></a><span> </span><a href="#local-6989586621679151569"><span class="hs-identifier hs-var">conName</span></a><span>
</span><a name="line-1037"></a><span>
</span><a name="line-1038"></a><span class="hs-comment">-- Polyadic constructors.</span><span>
</span><a name="line-1039"></a><span class="hs-identifier">parseArgs</span><span> </span><a name="local-6989586621679151573"><a href="#local-6989586621679151573"><span class="hs-identifier">jc</span></a></a><span> </span><a name="local-6989586621679151574"><a href="#local-6989586621679151574"><span class="hs-identifier">tvMap</span></a></a><span> </span><a name="local-6989586621679151575"><a href="#local-6989586621679151575"><span class="hs-identifier">tName</span></a></a><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-1040"></a><span>  </span><span class="hs-identifier hs-var">ConstructorInfo</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">constructorName</span><span>    </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151576"><a href="#local-6989586621679151576"><span class="hs-identifier">conName</span></a></a><span>
</span><a name="line-1041"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">constructorVariant</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">NormalConstructor</span><span>
</span><a name="line-1042"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">constructorFields</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151577"><a href="#local-6989586621679151577"><span class="hs-identifier">argTys</span></a></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1043"></a><span>  </span><a name="local-6989586621679151578"><a href="#local-6989586621679151578"><span class="hs-identifier">contents</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1044"></a><span>    </span><a name="local-6989586621679151579"><a href="#local-6989586621679151579"><span class="hs-identifier">argTys'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-identifier hs-var">resolveTypeSynonyms</span><span> </span><a href="#local-6989586621679151577"><span class="hs-identifier hs-var">argTys</span></a><span>
</span><a name="line-1045"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679151580"><a href="#local-6989586621679151580"><span class="hs-identifier">len</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">genericLength</span><span> </span><a href="#local-6989586621679151579"><span class="hs-identifier hs-var">argTys'</span></a><span>
</span><a name="line-1046"></a><span>    </span><a href="Data.Aeson.TH.html#matchCases"><span class="hs-identifier hs-var">matchCases</span></a><span> </span><a href="#local-6989586621679151578"><span class="hs-identifier hs-var">contents</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Aeson.TH.html#parseProduct"><span class="hs-identifier hs-var">parseProduct</span></a><span> </span><a href="#local-6989586621679151573"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151574"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151579"><span class="hs-identifier hs-var">argTys'</span></a><span> </span><a href="#local-6989586621679151575"><span class="hs-identifier hs-var">tName</span></a><span> </span><a href="#local-6989586621679151576"><span class="hs-identifier hs-var">conName</span></a><span> </span><a href="#local-6989586621679151580"><span class="hs-identifier hs-var">len</span></a><span>
</span><a name="line-1047"></a><span>
</span><a name="line-1048"></a><span class="hs-comment">-- Records.</span><span>
</span><a name="line-1049"></a><span class="hs-identifier">parseArgs</span><span> </span><a name="local-6989586621679151581"><a href="#local-6989586621679151581"><span class="hs-identifier">jc</span></a></a><span> </span><a name="local-6989586621679151582"><a href="#local-6989586621679151582"><span class="hs-identifier">tvMap</span></a></a><span> </span><a name="local-6989586621679151583"><a href="#local-6989586621679151583"><span class="hs-identifier">tName</span></a></a><span> </span><a name="local-6989586621679151584"><a href="#local-6989586621679151584"><span class="hs-identifier">opts</span></a></a><span>
</span><a name="line-1050"></a><span>  </span><span class="hs-identifier hs-var">ConstructorInfo</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">constructorName</span><span>    </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151585"><a href="#local-6989586621679151585"><span class="hs-identifier">conName</span></a></a><span>
</span><a name="line-1051"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">constructorVariant</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">RecordConstructor</span><span> </span><a name="local-6989586621679151586"><a href="#local-6989586621679151586"><span class="hs-identifier">fields</span></a></a><span>
</span><a name="line-1052"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">constructorFields</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151587"><a href="#local-6989586621679151587"><span class="hs-identifier">argTys</span></a></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1053"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679151588"><a href="#local-6989586621679151588"><span class="hs-identifier">obj</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1054"></a><span>    </span><a name="local-6989586621679151589"><a href="#local-6989586621679151589"><span class="hs-identifier">argTys'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-identifier hs-var">resolveTypeSynonyms</span><span> </span><a href="#local-6989586621679151587"><span class="hs-identifier hs-var">argTys</span></a><span>
</span><a name="line-1055"></a><span>    </span><a href="Data.Aeson.TH.html#parseRecord"><span class="hs-identifier hs-var">parseRecord</span></a><span> </span><a href="#local-6989586621679151581"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151582"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151589"><span class="hs-identifier hs-var">argTys'</span></a><span> </span><a href="#local-6989586621679151584"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679151583"><span class="hs-identifier hs-var">tName</span></a><span> </span><a href="#local-6989586621679151585"><span class="hs-identifier hs-var">conName</span></a><span> </span><a href="#local-6989586621679151586"><span class="hs-identifier hs-var">fields</span></a><span> </span><a href="#local-6989586621679151588"><span class="hs-identifier hs-var">obj</span></a><span>
</span><a name="line-1056"></a><span class="hs-identifier">parseArgs</span><span> </span><a name="local-6989586621679151590"><a href="#local-6989586621679151590"><span class="hs-identifier">jc</span></a></a><span> </span><a name="local-6989586621679151591"><a href="#local-6989586621679151591"><span class="hs-identifier">tvMap</span></a></a><span> </span><a name="local-6989586621679151592"><a href="#local-6989586621679151592"><span class="hs-identifier">tName</span></a></a><span> </span><a name="local-6989586621679151593"><a href="#local-6989586621679151593"><span class="hs-identifier">opts</span></a></a><span>
</span><a name="line-1057"></a><span>  </span><a name="local-6989586621679151594"><a href="#local-6989586621679151594"><span class="hs-identifier">info</span></a></a><span class="hs-glyph">@</span><span class="hs-identifier hs-var">ConstructorInfo</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">constructorName</span><span>    </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151595"><a href="#local-6989586621679151595"><span class="hs-identifier">conName</span></a></a><span>
</span><a name="line-1058"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">constructorVariant</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">RecordConstructor</span><span> </span><a name="local-6989586621679151596"><a href="#local-6989586621679151596"><span class="hs-identifier">fields</span></a></a><span>
</span><a name="line-1059"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">constructorFields</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151597"><a href="#local-6989586621679151597"><span class="hs-identifier">argTys</span></a></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1060"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679151598"><a href="#local-6989586621679151598"><span class="hs-identifier">valName</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1061"></a><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unwrapUnaryRecords</span><span> </span><a href="#local-6989586621679151593"><span class="hs-identifier hs-var">opts</span></a><span class="hs-special">,</span><a href="#local-6989586621679151597"><span class="hs-identifier hs-var">argTys</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1062"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#parseArgs"><span class="hs-identifier hs-var">parseArgs</span></a><span> </span><a href="#local-6989586621679151590"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151591"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151592"><span class="hs-identifier hs-var">tName</span></a><span> </span><a href="#local-6989586621679151593"><span class="hs-identifier hs-var">opts</span></a><span>
</span><a name="line-1063"></a><span>                             </span><span class="hs-special">(</span><a href="#local-6989586621679151594"><span class="hs-identifier hs-var">info</span></a><span class="hs-special">{</span><span class="hs-identifier">constructorVariant</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">NormalConstructor</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1064"></a><span>                             </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679151598"><span class="hs-identifier hs-var">valName</span></a><span class="hs-special">)</span><span>
</span><a name="line-1065"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1066"></a><span>        </span><a name="local-6989586621679151599"><a href="#local-6989586621679151599"><span class="hs-identifier">obj</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;recObj&quot;</span><span>
</span><a name="line-1067"></a><span>        </span><a name="local-6989586621679151600"><a href="#local-6989586621679151600"><span class="hs-identifier">argTys'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-identifier hs-var">resolveTypeSynonyms</span><span> </span><a href="#local-6989586621679151597"><span class="hs-identifier hs-var">argTys</span></a><span>
</span><a name="line-1068"></a><span>        </span><span class="hs-identifier hs-var">caseE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151598"><span class="hs-identifier hs-var">valName</span></a><span class="hs-special">)</span><span>
</span><a name="line-1069"></a><span>          </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">match</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conP</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Object</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679151599"><span class="hs-identifier hs-var">obj</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1070"></a><span>              </span><a href="Data.Aeson.TH.html#parseRecord"><span class="hs-identifier hs-var">parseRecord</span></a><span> </span><a href="#local-6989586621679151590"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151591"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151600"><span class="hs-identifier hs-var">argTys'</span></a><span> </span><a href="#local-6989586621679151593"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679151592"><span class="hs-identifier hs-var">tName</span></a><span> </span><a href="#local-6989586621679151595"><span class="hs-identifier hs-var">conName</span></a><span> </span><a href="#local-6989586621679151596"><span class="hs-identifier hs-var">fields</span></a><span> </span><a href="#local-6989586621679151599"><span class="hs-identifier hs-var">obj</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1071"></a><span>          </span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.TH.html#matchFailed"><span class="hs-identifier hs-var">matchFailed</span></a><span> </span><a href="#local-6989586621679151592"><span class="hs-identifier hs-var">tName</span></a><span> </span><a href="#local-6989586621679151595"><span class="hs-identifier hs-var">conName</span></a><span> </span><span class="hs-string">&quot;Object&quot;</span><span>
</span><a name="line-1072"></a><span>          </span><span class="hs-special">]</span><span>
</span><a name="line-1073"></a><span>
</span><a name="line-1074"></a><span class="hs-comment">-- Infix constructors. Apart from syntax these are the same as</span><span>
</span><a name="line-1075"></a><span class="hs-comment">-- polyadic constructors.</span><span>
</span><a name="line-1076"></a><span class="hs-identifier">parseArgs</span><span> </span><a name="local-6989586621679151601"><a href="#local-6989586621679151601"><span class="hs-identifier">jc</span></a></a><span> </span><a name="local-6989586621679151602"><a href="#local-6989586621679151602"><span class="hs-identifier">tvMap</span></a></a><span> </span><a name="local-6989586621679151603"><a href="#local-6989586621679151603"><span class="hs-identifier">tName</span></a></a><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-1077"></a><span>  </span><span class="hs-identifier hs-var">ConstructorInfo</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">constructorName</span><span>    </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151604"><a href="#local-6989586621679151604"><span class="hs-identifier">conName</span></a></a><span>
</span><a name="line-1078"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">constructorVariant</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">InfixConstructor</span><span>
</span><a name="line-1079"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">constructorFields</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151605"><a href="#local-6989586621679151605"><span class="hs-identifier">argTys</span></a></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1080"></a><span>  </span><a name="local-6989586621679151606"><a href="#local-6989586621679151606"><span class="hs-identifier">contents</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1081"></a><span>    </span><a name="local-6989586621679151607"><a href="#local-6989586621679151607"><span class="hs-identifier">argTys'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-identifier hs-var">resolveTypeSynonyms</span><span> </span><a href="#local-6989586621679151605"><span class="hs-identifier hs-var">argTys</span></a><span>
</span><a name="line-1082"></a><span>    </span><a href="Data.Aeson.TH.html#matchCases"><span class="hs-identifier hs-var">matchCases</span></a><span> </span><a href="#local-6989586621679151606"><span class="hs-identifier hs-var">contents</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Aeson.TH.html#parseProduct"><span class="hs-identifier hs-var">parseProduct</span></a><span> </span><a href="#local-6989586621679151601"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151602"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151607"><span class="hs-identifier hs-var">argTys'</span></a><span> </span><a href="#local-6989586621679151603"><span class="hs-identifier hs-var">tName</span></a><span> </span><a href="#local-6989586621679151604"><span class="hs-identifier hs-var">conName</span></a><span> </span><span class="hs-number">2</span><span>
</span><a name="line-1083"></a><span>
</span><a name="line-1084"></a><span class="hs-comment">-- | Generates code to parse the JSON encoding of an n-ary</span><span>
</span><a name="line-1085"></a><span class="hs-comment">-- constructor.</span><span>
</span><a name="line-1086"></a><span class="hs-identifier">parseProduct</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span> </span><span class="hs-comment">-- ^ The FromJSON variant being derived.</span><span>
</span><a name="line-1087"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#TyVarMap"><span class="hs-identifier hs-type">TyVarMap</span></a><span> </span><span class="hs-comment">-- ^ Maps the last type variables to their decoding</span><span>
</span><a name="line-1088"></a><span>                         </span><span class="hs-comment">--   function arguments.</span><span>
</span><a name="line-1089"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ The argument types of the constructor.</span><span>
</span><a name="line-1090"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-comment">-- ^ Name of the type to which the constructor belongs.</span><span>
</span><a name="line-1091"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-comment">-- ^ 'Con'structor name.</span><span>
</span><a name="line-1092"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-comment">-- ^ 'Con'structor arity.</span><span>
</span><a name="line-1093"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Match</span><span class="hs-special">]</span><span>
</span><a name="line-1094"></a><a name="parseProduct"><a href="Data.Aeson.TH.html#parseProduct"><span class="hs-identifier">parseProduct</span></a></a><span> </span><a name="local-6989586621679151608"><a href="#local-6989586621679151608"><span class="hs-identifier">jc</span></a></a><span> </span><a name="local-6989586621679151609"><a href="#local-6989586621679151609"><span class="hs-identifier">tvMap</span></a></a><span> </span><a name="local-6989586621679151610"><a href="#local-6989586621679151610"><span class="hs-identifier">argTys</span></a></a><span> </span><a name="local-6989586621679151611"><a href="#local-6989586621679151611"><span class="hs-identifier">tName</span></a></a><span> </span><a name="local-6989586621679151612"><a href="#local-6989586621679151612"><span class="hs-identifier">conName</span></a></a><span> </span><a name="local-6989586621679151613"><a href="#local-6989586621679151613"><span class="hs-identifier">numArgs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1095"></a><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679151614"><a href="#local-6989586621679151614"><span class="hs-identifier">arr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;arr&quot;</span><span>
</span><a name="line-1096"></a><span>         </span><span class="hs-comment">-- List of: &quot;parseJSON (arr `V.unsafeIndex` &lt;IX&gt;)&quot;</span><span>
</span><a name="line-1097"></a><span>         </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679151615"><a href="#local-6989586621679151615"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151616"><a href="#local-6989586621679151616"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="Data.Aeson.TH.html#dispatchParseJSON"><span class="hs-identifier hs-var">dispatchParseJSON</span></a><span> </span><a href="#local-6989586621679151608"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151612"><span class="hs-identifier hs-var">conName</span></a><span> </span><a href="#local-6989586621679151609"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151617"><span class="hs-identifier hs-var">argTy</span></a><span>
</span><a name="line-1098"></a><span>                      </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span>
</span><a name="line-1099"></a><span>                      </span><span class="hs-identifier hs-var">infixApp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151614"><span class="hs-identifier hs-var">arr</span></a><span class="hs-special">)</span><span>
</span><a name="line-1100"></a><span>                               </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unsafeIndex</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a name="line-1101"></a><span>                               </span><span class="hs-special">(</span><span class="hs-identifier hs-var">litE</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">integerL</span><span> </span><a href="#local-6989586621679151618"><span class="hs-identifier hs-var">ix</span></a><span class="hs-special">)</span><span>
</span><a name="line-1102"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151617"><a href="#local-6989586621679151617"><span class="hs-identifier">argTy</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679151618"><a href="#local-6989586621679151618"><span class="hs-identifier">ix</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621679151610"><span class="hs-identifier hs-var">argTys</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">..</span><span> </span><a href="#local-6989586621679151613"><span class="hs-identifier hs-var">numArgs</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">]</span><span>
</span><a name="line-1103"></a><span>                    </span><span class="hs-special">]</span><span>
</span><a name="line-1104"></a><span>         </span><span class="hs-identifier hs-var">match</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conP</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Array</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679151614"><span class="hs-identifier hs-var">arr</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1105"></a><span>               </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">condE</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">infixApp</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">length</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151614"><span class="hs-identifier hs-var">arr</span></a><span class="hs-special">)</span><span>
</span><a name="line-1106"></a><span>                                           </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a name="line-1107"></a><span>                                           </span><span class="hs-special">(</span><span class="hs-identifier hs-var">litE</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">integerL</span><span> </span><a href="#local-6989586621679151613"><span class="hs-identifier hs-var">numArgs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1108"></a><span>                                </span><span class="hs-special">)</span><span>
</span><a name="line-1109"></a><span>                                </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">foldl'</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679151619"><a href="#local-6989586621679151619"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679151620"><a href="#local-6989586621679151620"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">infixApp</span><span> </span><a href="#local-6989586621679151619"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;*&gt;</span><span class="hs-special">)</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679151620"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-1110"></a><span>                                         </span><span class="hs-special">(</span><span class="hs-identifier hs-var">infixApp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">conE</span><span> </span><a href="#local-6989586621679151612"><span class="hs-identifier hs-var">conName</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;$&gt;</span><span class="hs-special">)</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679151615"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-1111"></a><span>                                         </span><a href="#local-6989586621679151616"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1112"></a><span>                                </span><span class="hs-special">)</span><span>
</span><a name="line-1113"></a><span>                                </span><span class="hs-special">(</span><span> </span><a href="Data.Aeson.TH.html#parseTypeMismatch"><span class="hs-identifier hs-var">parseTypeMismatch</span></a><span> </span><a href="#local-6989586621679151611"><span class="hs-identifier hs-var">tName</span></a><span> </span><a href="#local-6989586621679151612"><span class="hs-identifier hs-var">conName</span></a><span>
</span><a name="line-1114"></a><span>                                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">litE</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">stringL</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;Array of length &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679151613"><span class="hs-identifier hs-var">numArgs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1115"></a><span>                                    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">infixApp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">litE</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">stringL</span><span> </span><span class="hs-string">&quot;Array of length &quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1116"></a><span>                                               </span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-special">(</span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a name="line-1117"></a><span>                                               </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">length</span><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151614"><span class="hs-identifier hs-var">arr</span></a><span class="hs-special">)</span><span>
</span><a name="line-1118"></a><span>                                    </span><span class="hs-special">)</span><span>
</span><a name="line-1119"></a><span>                                </span><span class="hs-special">)</span><span>
</span><a name="line-1120"></a><span>               </span><span class="hs-special">)</span><span>
</span><a name="line-1121"></a><span>               </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1122"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Aeson.TH.html#matchFailed"><span class="hs-identifier hs-var">matchFailed</span></a><span> </span><a href="#local-6989586621679151611"><span class="hs-identifier hs-var">tName</span></a><span> </span><a href="#local-6989586621679151612"><span class="hs-identifier hs-var">conName</span></a><span> </span><span class="hs-string">&quot;Array&quot;</span><span>
</span><a name="line-1123"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-1124"></a><span>
</span><a name="line-1125"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-1126"></a><span class="hs-comment">-- Parsing errors</span><span>
</span><a name="line-1127"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-1128"></a><span>
</span><a name="line-1129"></a><span class="hs-identifier">matchFailed</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">MatchQ</span><span>
</span><a name="line-1130"></a><a name="matchFailed"><a href="Data.Aeson.TH.html#matchFailed"><span class="hs-identifier">matchFailed</span></a></a><span> </span><a name="local-6989586621679151621"><a href="#local-6989586621679151621"><span class="hs-identifier">tName</span></a></a><span> </span><a name="local-6989586621679151622"><a href="#local-6989586621679151622"><span class="hs-identifier">conName</span></a></a><span> </span><a name="local-6989586621679151623"><a href="#local-6989586621679151623"><span class="hs-identifier">expected</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1131"></a><span>  </span><a name="local-6989586621679151624"><a href="#local-6989586621679151624"><span class="hs-identifier">other</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;other&quot;</span><span>
</span><a name="line-1132"></a><span>  </span><span class="hs-identifier hs-var">match</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679151624"><span class="hs-identifier hs-var">other</span></a><span class="hs-special">)</span><span>
</span><a name="line-1133"></a><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Aeson.TH.html#parseTypeMismatch"><span class="hs-identifier hs-var">parseTypeMismatch</span></a><span> </span><a href="#local-6989586621679151621"><span class="hs-identifier hs-var">tName</span></a><span> </span><a href="#local-6989586621679151622"><span class="hs-identifier hs-var">conName</span></a><span>
</span><a name="line-1134"></a><span>                      </span><span class="hs-special">(</span><span class="hs-identifier hs-var">litE</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">stringL</span><span> </span><a href="#local-6989586621679151623"><span class="hs-identifier hs-var">expected</span></a><span class="hs-special">)</span><span>
</span><a name="line-1135"></a><span>                      </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-glyph">|</span><a href="Data.Aeson.TH.html#valueConName"><span class="hs-identifier hs-var">valueConName</span></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679151624"><span class="hs-identifier hs-var">other</span></a><span class="hs-special">)</span><span>
</span><a name="line-1136"></a><span>        </span><span class="hs-special">)</span><span>
</span><a name="line-1137"></a><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1138"></a><span>
</span><a name="line-1139"></a><span class="hs-identifier">parseTypeMismatch</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span>
</span><a name="line-1140"></a><a name="parseTypeMismatch"><a href="Data.Aeson.TH.html#parseTypeMismatch"><span class="hs-identifier">parseTypeMismatch</span></a></a><span> </span><a name="local-6989586621679151625"><a href="#local-6989586621679151625"><span class="hs-identifier">tName</span></a></a><span> </span><a name="local-6989586621679151626"><a href="#local-6989586621679151626"><span class="hs-identifier">conName</span></a></a><span> </span><a name="local-6989586621679151627"><a href="#local-6989586621679151627"><span class="hs-identifier">expected</span></a></a><span> </span><a name="local-6989586621679151628"><a href="#local-6989586621679151628"><span class="hs-identifier">actual</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1141"></a><span>    </span><span class="hs-identifier hs-var">foldl</span><span> </span><span class="hs-identifier hs-var">appE</span><span>
</span><a name="line-1142"></a><span>          </span><span class="hs-special">[</span><span class="hs-glyph">|</span><a href="Data.Aeson.TH.html#parseTypeMismatch%27"><span class="hs-identifier hs-var">parseTypeMismatch'</span></a><span class="hs-glyph">|</span><span class="hs-special">]</span><span>
</span><a name="line-1143"></a><span>          </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">litE</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">stringL</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">nameBase</span><span> </span><a href="#local-6989586621679151626"><span class="hs-identifier hs-var">conName</span></a><span>
</span><a name="line-1144"></a><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">litE</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">stringL</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679151625"><span class="hs-identifier hs-var">tName</span></a><span>
</span><a name="line-1145"></a><span>          </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151627"><span class="hs-identifier hs-var">expected</span></a><span>
</span><a name="line-1146"></a><span>          </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151628"><span class="hs-identifier hs-var">actual</span></a><span>
</span><a name="line-1147"></a><span>          </span><span class="hs-special">]</span><span>
</span><a name="line-1148"></a><span>
</span><a name="line-1149"></a><span class="hs-keyword">class</span><span> </span><a name="LookupField"><a href="Data.Aeson.TH.html#LookupField"><span class="hs-identifier">LookupField</span></a></a><span> </span><a name="local-6989586621679151274"><a href="#local-6989586621679151274"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1150"></a><span>    </span><span class="hs-identifier">lookupField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Parser"><span class="hs-identifier hs-type">Parser</span></a><span> </span><a href="#local-6989586621679151274"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-1151"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-type">Object</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Parser"><span class="hs-identifier hs-type">Parser</span></a><span> </span><a href="#local-6989586621679151274"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1152"></a><span>
</span><a name="line-1153"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">OVERLAPPABLE_</span><span> </span><span class="hs-identifier">LookupField</span><span> </span><a href="Data.Aeson.TH.html#LookupField"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1154"></a><span>    </span><a name="local-8214565720323926058"><a href="Data.Aeson.TH.html#lookupField"><span class="hs-identifier">lookupField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#lookupFieldWith"><span class="hs-identifier hs-var">lookupFieldWith</span></a><span>
</span><a name="line-1155"></a><span>
</span><a name="line-1156"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">INCOHERENT_</span><span> </span><span class="hs-identifier">LookupField</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#LookupField"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1157"></a><span>    </span><a name="local-8214565720323926058"><a href="Data.Aeson.TH.html#lookupField"><span class="hs-identifier">lookupField</span></a></a><span> </span><a name="local-6989586621679151282"><a href="#local-6989586621679151282"><span class="hs-identifier">pj</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.Types.FromJSON.html#parseOptionalFieldWith"><span class="hs-identifier hs-var">parseOptionalFieldWith</span></a><span> </span><a href="#local-6989586621679151282"><span class="hs-identifier hs-var">pj</span></a><span>
</span><a name="line-1158"></a><span>
</span><a name="line-1159"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">INCOHERENT_</span><span> </span><span class="hs-identifier">LookupField</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Semigroup</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Option</span><span> </span><span class="hs-identifier hs-type">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1160"></a><span>    </span><a name="local-8214565720323926058"><a href="Data.Aeson.TH.html#lookupField"><span class="hs-identifier">lookupField</span></a></a><span> </span><a name="local-6989586621679151276"><a href="#local-6989586621679151276"><span class="hs-identifier">pj</span></a></a><span> </span><a name="local-6989586621679151277"><a href="#local-6989586621679151277"><span class="hs-identifier">tName</span></a></a><span> </span><a name="local-6989586621679151278"><a href="#local-6989586621679151278"><span class="hs-identifier">rec</span></a></a><span> </span><a name="local-6989586621679151279"><a href="#local-6989586621679151279"><span class="hs-identifier">obj</span></a></a><span> </span><a name="local-6989586621679151280"><a href="#local-6989586621679151280"><span class="hs-identifier">key</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1161"></a><span>        </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">Semigroup</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Option</span><span>
</span><a name="line-1162"></a><span>             </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#lookupField"><span class="hs-identifier hs-var">lookupField</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier">Semigroup</span><span class="hs-operator">.</span><span class="hs-identifier">getOption</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679151276"><span class="hs-identifier hs-var">pj</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151277"><span class="hs-identifier hs-var">tName</span></a><span> </span><a href="#local-6989586621679151278"><span class="hs-identifier hs-var">rec</span></a><span> </span><a href="#local-6989586621679151279"><span class="hs-identifier hs-var">obj</span></a><span> </span><a href="#local-6989586621679151280"><span class="hs-identifier hs-var">key</span></a><span class="hs-special">)</span><span>
</span><a name="line-1163"></a><span>
</span><a name="line-1164"></a><span class="hs-identifier">lookupFieldWith</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Parser"><span class="hs-identifier hs-type">Parser</span></a><span> </span><a href="#local-6989586621679151304"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-1165"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-type">Object</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Parser"><span class="hs-identifier hs-type">Parser</span></a><span> </span><a href="#local-6989586621679151304"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1166"></a><a name="lookupFieldWith"><a href="Data.Aeson.TH.html#lookupFieldWith"><span class="hs-identifier">lookupFieldWith</span></a></a><span> </span><a name="local-6989586621679151629"><a href="#local-6989586621679151629"><span class="hs-identifier">pj</span></a></a><span> </span><a name="local-6989586621679151630"><a href="#local-6989586621679151630"><span class="hs-identifier">tName</span></a></a><span> </span><a name="local-6989586621679151631"><a href="#local-6989586621679151631"><span class="hs-identifier">rec</span></a></a><span> </span><a name="local-6989586621679151632"><a href="#local-6989586621679151632"><span class="hs-identifier">obj</span></a></a><span> </span><a name="local-6989586621679151633"><a href="#local-6989586621679151633"><span class="hs-identifier">key</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1167"></a><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">H</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">lookup</span><span> </span><a href="#local-6989586621679151633"><span class="hs-identifier hs-var">key</span></a><span> </span><a href="#local-6989586621679151632"><span class="hs-identifier hs-var">obj</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1168"></a><span>      </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#unknownFieldFail"><span class="hs-identifier hs-var">unknownFieldFail</span></a><span> </span><a href="#local-6989586621679151630"><span class="hs-identifier hs-var">tName</span></a><span> </span><a href="#local-6989586621679151631"><span class="hs-identifier hs-var">rec</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unpack</span><span> </span><a href="#local-6989586621679151633"><span class="hs-identifier hs-var">key</span></a><span class="hs-special">)</span><span>
</span><a name="line-1169"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679151634"><a href="#local-6989586621679151634"><span class="hs-identifier">v</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151629"><span class="hs-identifier hs-var">pj</span></a><span> </span><a href="#local-6989586621679151634"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="Data.Aeson.Types.Internal.html#%3C%3F%3E"><span class="hs-operator hs-var">&lt;?&gt;</span></a><span> </span><a href="Data.Aeson.Types.Internal.html#Key"><span class="hs-identifier hs-var">Key</span></a><span> </span><a href="#local-6989586621679151633"><span class="hs-identifier hs-var">key</span></a><span>
</span><a name="line-1170"></a><span>
</span><a name="line-1171"></a><span class="hs-identifier">unknownFieldFail</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Parser"><span class="hs-identifier hs-type">Parser</span></a><span> </span><a href="#local-6989586621679151303"><span class="hs-identifier hs-type">fail</span></a><span>
</span><a name="line-1172"></a><a name="unknownFieldFail"><a href="Data.Aeson.TH.html#unknownFieldFail"><span class="hs-identifier">unknownFieldFail</span></a></a><span> </span><a name="local-6989586621679151635"><a href="#local-6989586621679151635"><span class="hs-identifier">tName</span></a></a><span> </span><a name="local-6989586621679151636"><a href="#local-6989586621679151636"><span class="hs-identifier">rec</span></a></a><span> </span><a name="local-6989586621679151637"><a href="#local-6989586621679151637"><span class="hs-identifier">key</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1173"></a><span>    </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">printf</span><span> </span><span class="hs-string">&quot;When parsing the record %s of type %s the key %s was not present.&quot;</span><span>
</span><a name="line-1174"></a><span>                  </span><a href="#local-6989586621679151636"><span class="hs-identifier hs-var">rec</span></a><span> </span><a href="#local-6989586621679151635"><span class="hs-identifier hs-var">tName</span></a><span> </span><a href="#local-6989586621679151637"><span class="hs-identifier hs-var">key</span></a><span>
</span><a name="line-1175"></a><span>
</span><a name="line-1176"></a><span class="hs-identifier">noArrayFail</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Parser"><span class="hs-identifier hs-type">Parser</span></a><span> </span><a href="#local-6989586621679151302"><span class="hs-identifier hs-type">fail</span></a><span>
</span><a name="line-1177"></a><a name="noArrayFail"><a href="Data.Aeson.TH.html#noArrayFail"><span class="hs-identifier">noArrayFail</span></a></a><span> </span><a name="local-6989586621679151638"><a href="#local-6989586621679151638"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679151639"><a href="#local-6989586621679151639"><span class="hs-identifier">o</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">printf</span><span> </span><span class="hs-string">&quot;When parsing %s expected Array but got %s.&quot;</span><span> </span><a href="#local-6989586621679151638"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679151639"><span class="hs-identifier hs-var">o</span></a><span>
</span><a name="line-1178"></a><span>
</span><a name="line-1179"></a><span class="hs-identifier">noObjectFail</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Parser"><span class="hs-identifier hs-type">Parser</span></a><span> </span><a href="#local-6989586621679151301"><span class="hs-identifier hs-type">fail</span></a><span>
</span><a name="line-1180"></a><a name="noObjectFail"><a href="Data.Aeson.TH.html#noObjectFail"><span class="hs-identifier">noObjectFail</span></a></a><span> </span><a name="local-6989586621679151640"><a href="#local-6989586621679151640"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679151641"><a href="#local-6989586621679151641"><span class="hs-identifier">o</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">printf</span><span> </span><span class="hs-string">&quot;When parsing %s expected Object but got %s.&quot;</span><span> </span><a href="#local-6989586621679151640"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679151641"><span class="hs-identifier hs-var">o</span></a><span>
</span><a name="line-1181"></a><span>
</span><a name="line-1182"></a><span class="hs-identifier">firstElemNoStringFail</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Parser"><span class="hs-identifier hs-type">Parser</span></a><span> </span><a href="#local-6989586621679151300"><span class="hs-identifier hs-type">fail</span></a><span>
</span><a name="line-1183"></a><a name="firstElemNoStringFail"><a href="Data.Aeson.TH.html#firstElemNoStringFail"><span class="hs-identifier">firstElemNoStringFail</span></a></a><span> </span><a name="local-6989586621679151642"><a href="#local-6989586621679151642"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679151643"><a href="#local-6989586621679151643"><span class="hs-identifier">o</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">printf</span><span> </span><span class="hs-string">&quot;When parsing %s expected an Array of 2 elements where the first element is a String but got %s at the first element.&quot;</span><span> </span><a href="#local-6989586621679151642"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679151643"><span class="hs-identifier hs-var">o</span></a><span>
</span><a name="line-1184"></a><span>
</span><a name="line-1185"></a><span class="hs-identifier">wrongPairCountFail</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Parser"><span class="hs-identifier hs-type">Parser</span></a><span> </span><a href="#local-6989586621679151299"><span class="hs-identifier hs-type">fail</span></a><span>
</span><a name="line-1186"></a><a name="wrongPairCountFail"><a href="Data.Aeson.TH.html#wrongPairCountFail"><span class="hs-identifier">wrongPairCountFail</span></a></a><span> </span><a name="local-6989586621679151644"><a href="#local-6989586621679151644"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679151645"><a href="#local-6989586621679151645"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1187"></a><span>    </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">printf</span><span> </span><span class="hs-string">&quot;When parsing %s expected an Object with a single tag/contents pair but got %s pairs.&quot;</span><span>
</span><a name="line-1188"></a><span>                  </span><a href="#local-6989586621679151644"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679151645"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1189"></a><span>
</span><a name="line-1190"></a><span class="hs-identifier">noStringFail</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Parser"><span class="hs-identifier hs-type">Parser</span></a><span> </span><a href="#local-6989586621679151298"><span class="hs-identifier hs-type">fail</span></a><span>
</span><a name="line-1191"></a><a name="noStringFail"><a href="Data.Aeson.TH.html#noStringFail"><span class="hs-identifier">noStringFail</span></a></a><span> </span><a name="local-6989586621679151646"><a href="#local-6989586621679151646"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679151647"><a href="#local-6989586621679151647"><span class="hs-identifier">o</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">printf</span><span> </span><span class="hs-string">&quot;When parsing %s expected String but got %s.&quot;</span><span> </span><a href="#local-6989586621679151646"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679151647"><span class="hs-identifier hs-var">o</span></a><span>
</span><a name="line-1192"></a><span>
</span><a name="line-1193"></a><span class="hs-identifier">noMatchFail</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Parser"><span class="hs-identifier hs-type">Parser</span></a><span> </span><a href="#local-6989586621679151297"><span class="hs-identifier hs-type">fail</span></a><span>
</span><a name="line-1194"></a><a name="noMatchFail"><a href="Data.Aeson.TH.html#noMatchFail"><span class="hs-identifier">noMatchFail</span></a></a><span> </span><a name="local-6989586621679151648"><a href="#local-6989586621679151648"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679151649"><a href="#local-6989586621679151649"><span class="hs-identifier">o</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1195"></a><span>    </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">printf</span><span> </span><span class="hs-string">&quot;When parsing %s expected a String with the tag of a constructor but got %s.&quot;</span><span> </span><a href="#local-6989586621679151648"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679151649"><span class="hs-identifier hs-var">o</span></a><span>
</span><a name="line-1196"></a><span>
</span><a name="line-1197"></a><span class="hs-identifier">not2ElemArray</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Parser"><span class="hs-identifier hs-type">Parser</span></a><span> </span><a href="#local-6989586621679151296"><span class="hs-identifier hs-type">fail</span></a><span>
</span><a name="line-1198"></a><a name="not2ElemArray"><a href="Data.Aeson.TH.html#not2ElemArray"><span class="hs-identifier">not2ElemArray</span></a></a><span> </span><a name="local-6989586621679151650"><a href="#local-6989586621679151650"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679151651"><a href="#local-6989586621679151651"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">printf</span><span> </span><span class="hs-string">&quot;When parsing %s expected an Array of 2 elements but got %i elements&quot;</span><span> </span><a href="#local-6989586621679151650"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679151651"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-1199"></a><span>
</span><a name="line-1200"></a><span class="hs-identifier">conNotFoundFail2ElemArray</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Parser"><span class="hs-identifier hs-type">Parser</span></a><span> </span><a href="#local-6989586621679151295"><span class="hs-identifier hs-type">fail</span></a><span>
</span><a name="line-1201"></a><a name="conNotFoundFail2ElemArray"><a href="Data.Aeson.TH.html#conNotFoundFail2ElemArray"><span class="hs-identifier">conNotFoundFail2ElemArray</span></a></a><span> </span><a name="local-6989586621679151652"><a href="#local-6989586621679151652"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679151653"><a href="#local-6989586621679151653"><span class="hs-identifier">cs</span></a></a><span> </span><a name="local-6989586621679151654"><a href="#local-6989586621679151654"><span class="hs-identifier">o</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1202"></a><span>    </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">printf</span><span> </span><span class="hs-string">&quot;When parsing %s expected a 2-element Array with a tag and contents element where the tag is one of [%s], but got %s.&quot;</span><span>
</span><a name="line-1203"></a><span>                  </span><a href="#local-6989586621679151652"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">intercalate</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><a href="#local-6989586621679151653"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151654"><span class="hs-identifier hs-var">o</span></a><span>
</span><a name="line-1204"></a><span>
</span><a name="line-1205"></a><span class="hs-identifier">conNotFoundFailObjectSingleField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Parser"><span class="hs-identifier hs-type">Parser</span></a><span> </span><a href="#local-6989586621679151294"><span class="hs-identifier hs-type">fail</span></a><span>
</span><a name="line-1206"></a><a name="conNotFoundFailObjectSingleField"><a href="Data.Aeson.TH.html#conNotFoundFailObjectSingleField"><span class="hs-identifier">conNotFoundFailObjectSingleField</span></a></a><span> </span><a name="local-6989586621679151655"><a href="#local-6989586621679151655"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679151656"><a href="#local-6989586621679151656"><span class="hs-identifier">cs</span></a></a><span> </span><a name="local-6989586621679151657"><a href="#local-6989586621679151657"><span class="hs-identifier">o</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1207"></a><span>    </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">printf</span><span> </span><span class="hs-string">&quot;When parsing %s expected an Object with a single tag/contents pair where the tag is one of [%s], but got %s.&quot;</span><span>
</span><a name="line-1208"></a><span>                  </span><a href="#local-6989586621679151655"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">intercalate</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><a href="#local-6989586621679151656"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151657"><span class="hs-identifier hs-var">o</span></a><span>
</span><a name="line-1209"></a><span>
</span><a name="line-1210"></a><span class="hs-identifier">conNotFoundFailTaggedObject</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Parser"><span class="hs-identifier hs-type">Parser</span></a><span> </span><a href="#local-6989586621679151293"><span class="hs-identifier hs-type">fail</span></a><span>
</span><a name="line-1211"></a><a name="conNotFoundFailTaggedObject"><a href="Data.Aeson.TH.html#conNotFoundFailTaggedObject"><span class="hs-identifier">conNotFoundFailTaggedObject</span></a></a><span> </span><a name="local-6989586621679151658"><a href="#local-6989586621679151658"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679151659"><a href="#local-6989586621679151659"><span class="hs-identifier">cs</span></a></a><span> </span><a name="local-6989586621679151660"><a href="#local-6989586621679151660"><span class="hs-identifier">o</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1212"></a><span>    </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">printf</span><span> </span><span class="hs-string">&quot;When parsing %s expected an Object with a tag field where the value is one of [%s], but got %s.&quot;</span><span>
</span><a name="line-1213"></a><span>                  </span><a href="#local-6989586621679151658"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">intercalate</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><a href="#local-6989586621679151659"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151660"><span class="hs-identifier hs-var">o</span></a><span>
</span><a name="line-1214"></a><span>
</span><a name="line-1215"></a><span class="hs-identifier">parseTypeMismatch'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Parser"><span class="hs-identifier hs-type">Parser</span></a><span> </span><a href="#local-6989586621679151292"><span class="hs-identifier hs-type">fail</span></a><span>
</span><a name="line-1216"></a><a name="parseTypeMismatch%27"><a href="Data.Aeson.TH.html#parseTypeMismatch%27"><span class="hs-identifier">parseTypeMismatch'</span></a></a><span> </span><a name="local-6989586621679151661"><a href="#local-6989586621679151661"><span class="hs-identifier">conName</span></a></a><span> </span><a name="local-6989586621679151662"><a href="#local-6989586621679151662"><span class="hs-identifier">tName</span></a></a><span> </span><a name="local-6989586621679151663"><a href="#local-6989586621679151663"><span class="hs-identifier">expected</span></a></a><span> </span><a name="local-6989586621679151664"><a href="#local-6989586621679151664"><span class="hs-identifier">actual</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1217"></a><span>    </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">printf</span><span> </span><span class="hs-string">&quot;When parsing the constructor %s of type %s expected %s but got %s.&quot;</span><span>
</span><a name="line-1218"></a><span>                  </span><a href="#local-6989586621679151661"><span class="hs-identifier hs-var">conName</span></a><span> </span><a href="#local-6989586621679151662"><span class="hs-identifier hs-var">tName</span></a><span> </span><a href="#local-6989586621679151663"><span class="hs-identifier hs-var">expected</span></a><span> </span><a href="#local-6989586621679151664"><span class="hs-identifier hs-var">actual</span></a><span>
</span><a name="line-1219"></a><span>
</span><a name="line-1220"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-1221"></a><span class="hs-comment">-- Shared ToJSON and FromJSON code</span><span>
</span><a name="line-1222"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-1223"></a><span>
</span><a name="line-1224"></a><span class="hs-comment">-- | Functionality common to 'deriveJSON', 'deriveJSON1', and 'deriveJSON2'.</span><span>
</span><a name="line-1225"></a><span class="hs-identifier">deriveJSONBoth</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1226"></a><span>               </span><span class="hs-comment">-- ^ Function which derives a flavor of 'ToJSON'.</span><span>
</span><a name="line-1227"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1228"></a><span>               </span><span class="hs-comment">-- ^ Function which derives a flavor of 'FromJSON'.</span><span>
</span><a name="line-1229"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span>
</span><a name="line-1230"></a><span>               </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-1231"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-1232"></a><span>               </span><span class="hs-comment">-- ^ Name of the type for which to generate 'ToJSON' and 'FromJSON'</span><span>
</span><a name="line-1233"></a><span>               </span><span class="hs-comment">-- instances.</span><span>
</span><a name="line-1234"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-1235"></a><a name="deriveJSONBoth"><a href="Data.Aeson.TH.html#deriveJSONBoth"><span class="hs-identifier">deriveJSONBoth</span></a></a><span> </span><a name="local-6989586621679151665"><a href="#local-6989586621679151665"><span class="hs-identifier">dtj</span></a></a><span> </span><a name="local-6989586621679151666"><a href="#local-6989586621679151666"><span class="hs-identifier">dfj</span></a></a><span> </span><a name="local-6989586621679151667"><a href="#local-6989586621679151667"><span class="hs-identifier">opts</span></a></a><span> </span><a name="local-6989586621679151668"><a href="#local-6989586621679151668"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1236"></a><span>    </span><span class="hs-identifier hs-var">liftM2</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151665"><span class="hs-identifier hs-var">dtj</span></a><span> </span><a href="#local-6989586621679151667"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679151668"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151666"><span class="hs-identifier hs-var">dfj</span></a><span> </span><a href="#local-6989586621679151667"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679151668"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1237"></a><span>
</span><a name="line-1238"></a><span class="hs-comment">-- | Functionality common to @deriveToJSON(1)(2)@ and @deriveFromJSON(1)(2)@.</span><span>
</span><a name="line-1239"></a><span class="hs-identifier">deriveJSONClass</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#JSONFun"><span class="hs-identifier hs-type">JSONFun</span></a><span class="hs-special">,</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-1240"></a><span>                                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">ConstructorInfo</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1241"></a><span>                </span><span class="hs-comment">-- ^ The class methods and the functions which derive them.</span><span>
</span><a name="line-1242"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span>
</span><a name="line-1243"></a><span>                </span><span class="hs-comment">-- ^ The class for which to generate an instance.</span><span>
</span><a name="line-1244"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span>
</span><a name="line-1245"></a><span>                </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-1246"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-1247"></a><span>                </span><span class="hs-comment">-- ^ Name of the type for which to generate a class instance</span><span>
</span><a name="line-1248"></a><span>                </span><span class="hs-comment">-- declaration.</span><span>
</span><a name="line-1249"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-1250"></a><a name="deriveJSONClass"><a href="Data.Aeson.TH.html#deriveJSONClass"><span class="hs-identifier">deriveJSONClass</span></a></a><span> </span><a name="local-6989586621679151669"><a href="#local-6989586621679151669"><span class="hs-identifier">consFuns</span></a></a><span> </span><a name="local-6989586621679151670"><a href="#local-6989586621679151670"><span class="hs-identifier">jc</span></a></a><span> </span><a name="local-6989586621679151671"><a href="#local-6989586621679151671"><span class="hs-identifier">opts</span></a></a><span> </span><a name="local-6989586621679151672"><a href="#local-6989586621679151672"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1251"></a><span>  </span><a name="local-6989586621679151679"><a href="#local-6989586621679151679"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">reifyDatatype</span><span> </span><a href="#local-6989586621679151672"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1252"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679151679"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1253"></a><span>    </span><span class="hs-identifier hs-var">DatatypeInfo</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">datatypeContext</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151680"><a href="#local-6989586621679151680"><span class="hs-identifier">ctxt</span></a></a><span>
</span><a name="line-1254"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">datatypeName</span><span>    </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151681"><a href="#local-6989586621679151681"><span class="hs-identifier">parentName</span></a></a><span>
</span><a name="line-1255"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">datatypeVars</span><span>    </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151682"><a href="#local-6989586621679151682"><span class="hs-identifier">vars</span></a></a><span>
</span><a name="line-1256"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">datatypeVariant</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151683"><a href="#local-6989586621679151683"><span class="hs-identifier">variant</span></a></a><span>
</span><a name="line-1257"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">datatypeCons</span><span>    </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151684"><a href="#local-6989586621679151684"><span class="hs-identifier">cons</span></a></a><span>
</span><a name="line-1258"></a><span>                 </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1259"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621679151685"><a href="#local-6989586621679151685"><span class="hs-identifier">instanceCxt</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679151686"><a href="#local-6989586621679151686"><span class="hs-identifier">instanceType</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1260"></a><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Aeson.TH.html#buildTypeInstance"><span class="hs-identifier hs-var">buildTypeInstance</span></a><span> </span><a href="#local-6989586621679151681"><span class="hs-identifier hs-var">parentName</span></a><span> </span><a href="#local-6989586621679151670"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151680"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-6989586621679151682"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679151683"><span class="hs-identifier hs-var">variant</span></a><span>
</span><a name="line-1261"></a><span>      </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">instanceD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679151685"><span class="hs-identifier hs-var">instanceCxt</span></a><span class="hs-special">)</span><span>
</span><a name="line-1262"></a><span>                          </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679151686"><span class="hs-identifier hs-var">instanceType</span></a><span class="hs-special">)</span><span>
</span><a name="line-1263"></a><span>                          </span><span class="hs-special">(</span><a href="#local-6989586621679151673"><span class="hs-identifier hs-var">methodDecs</span></a><span> </span><a href="#local-6989586621679151681"><span class="hs-identifier hs-var">parentName</span></a><span> </span><a href="#local-6989586621679151682"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679151684"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">)</span><span>
</span><a name="line-1264"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1265"></a><span>    </span><span class="hs-identifier">methodDecs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">ConstructorInfo</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Dec</span><span class="hs-special">]</span><span>
</span><a name="line-1266"></a><span>    </span><a name="local-6989586621679151673"><a href="#local-6989586621679151673"><span class="hs-identifier">methodDecs</span></a></a><span> </span><a name="local-6989586621679151674"><a href="#local-6989586621679151674"><span class="hs-identifier">parentName</span></a></a><span> </span><a name="local-6989586621679151675"><a href="#local-6989586621679151675"><span class="hs-identifier">vars</span></a></a><span> </span><a name="local-6989586621679151676"><a href="#local-6989586621679151676"><span class="hs-identifier">cons</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679151669"><span class="hs-identifier hs-var">consFuns</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679151677"><a href="#local-6989586621679151677"><span class="hs-identifier">jf</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679151678"><a href="#local-6989586621679151678"><span class="hs-identifier">jfMaker</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1267"></a><span>      </span><span class="hs-identifier hs-var">funD</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#jsonFunValName"><span class="hs-identifier hs-var">jsonFunValName</span></a><span> </span><a href="#local-6989586621679151677"><span class="hs-identifier hs-var">jf</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">arity</span><span> </span><a href="#local-6989586621679151670"><span class="hs-identifier hs-var">jc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1268"></a><span>           </span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">clause</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1269"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">normalB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679151678"><span class="hs-identifier hs-var">jfMaker</span></a><span> </span><a href="#local-6989586621679151670"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151674"><span class="hs-identifier hs-var">parentName</span></a><span> </span><a href="#local-6989586621679151671"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679151675"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679151676"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">)</span><span>
</span><a name="line-1270"></a><span>                    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1271"></a><span>           </span><span class="hs-special">]</span><span>
</span><a name="line-1272"></a><span>
</span><a name="line-1273"></a><span class="hs-identifier">mkFunCommon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">ConstructorInfo</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span class="hs-special">)</span><span>
</span><a name="line-1274"></a><span>            </span><span class="hs-comment">-- ^ The function which derives the expression.</span><span>
</span><a name="line-1275"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span>
</span><a name="line-1276"></a><span>            </span><span class="hs-comment">-- ^ Which class's method is being derived.</span><span>
</span><a name="line-1277"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span>
</span><a name="line-1278"></a><span>            </span><span class="hs-comment">-- ^ Encoding options.</span><span>
</span><a name="line-1279"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-1280"></a><span>            </span><span class="hs-comment">-- ^ Name of the encoded type.</span><span>
</span><a name="line-1281"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-1282"></a><a name="mkFunCommon"><a href="Data.Aeson.TH.html#mkFunCommon"><span class="hs-identifier">mkFunCommon</span></a></a><span> </span><a name="local-6989586621679151687"><a href="#local-6989586621679151687"><span class="hs-identifier">consFun</span></a></a><span> </span><a name="local-6989586621679151688"><a href="#local-6989586621679151688"><span class="hs-identifier">jc</span></a></a><span> </span><a name="local-6989586621679151689"><a href="#local-6989586621679151689"><span class="hs-identifier">opts</span></a></a><span> </span><a name="local-6989586621679151690"><a href="#local-6989586621679151690"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1283"></a><span>  </span><a name="local-6989586621679151691"><a href="#local-6989586621679151691"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">reifyDatatype</span><span> </span><a href="#local-6989586621679151690"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1284"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679151691"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1285"></a><span>    </span><span class="hs-identifier hs-var">DatatypeInfo</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">datatypeContext</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151692"><a href="#local-6989586621679151692"><span class="hs-identifier">ctxt</span></a></a><span>
</span><a name="line-1286"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">datatypeName</span><span>    </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151693"><a href="#local-6989586621679151693"><span class="hs-identifier">parentName</span></a></a><span>
</span><a name="line-1287"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">datatypeVars</span><span>    </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151694"><a href="#local-6989586621679151694"><span class="hs-identifier">vars</span></a></a><span>
</span><a name="line-1288"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">datatypeVariant</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151695"><a href="#local-6989586621679151695"><span class="hs-identifier">variant</span></a></a><span>
</span><a name="line-1289"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">datatypeCons</span><span>    </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679151696"><a href="#local-6989586621679151696"><span class="hs-identifier">cons</span></a></a><span>
</span><a name="line-1290"></a><span>                 </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1291"></a><span>      </span><span class="hs-comment">-- We force buildTypeInstance here since it performs some checks for whether</span><span>
</span><a name="line-1292"></a><span>      </span><span class="hs-comment">-- or not the provided datatype's kind matches the derived method's</span><span>
</span><a name="line-1293"></a><span>      </span><span class="hs-comment">-- typeclass, and produces errors if it can't.</span><span>
</span><a name="line-1294"></a><span>      </span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Aeson.TH.html#buildTypeInstance"><span class="hs-identifier hs-var">buildTypeInstance</span></a><span> </span><a href="#local-6989586621679151693"><span class="hs-identifier hs-var">parentName</span></a><span> </span><a href="#local-6989586621679151688"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151692"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-6989586621679151694"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679151695"><span class="hs-identifier hs-var">variant</span></a><span>
</span><a name="line-1295"></a><span>      </span><a href="#local-6989586621679151687"><span class="hs-identifier hs-var">consFun</span></a><span> </span><a href="#local-6989586621679151688"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151693"><span class="hs-identifier hs-var">parentName</span></a><span> </span><a href="#local-6989586621679151689"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679151694"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679151696"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-1296"></a><span>
</span><a name="line-1297"></a><span class="hs-identifier">dispatchFunByType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span>
</span><a name="line-1298"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#JSONFun"><span class="hs-identifier hs-type">JSONFun</span></a><span>
</span><a name="line-1299"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-1300"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#TyVarMap"><span class="hs-identifier hs-type">TyVarMap</span></a><span>
</span><a name="line-1301"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-comment">-- True if we are using the function argument that works</span><span>
</span><a name="line-1302"></a><span>                          </span><span class="hs-comment">-- on lists (e.g., [a] -&gt; Value). False is we are using</span><span>
</span><a name="line-1303"></a><span>                          </span><span class="hs-comment">-- the function argument that works on single values</span><span>
</span><a name="line-1304"></a><span>                          </span><span class="hs-comment">-- (e.g., a -&gt; Value).</span><span>
</span><a name="line-1305"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-1306"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-1307"></a><a name="dispatchFunByType"><a href="Data.Aeson.TH.html#dispatchFunByType"><span class="hs-identifier">dispatchFunByType</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679151697"><a href="#local-6989586621679151697"><span class="hs-identifier">jf</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679151698"><a href="#local-6989586621679151698"><span class="hs-identifier">tvMap</span></a></a><span> </span><a name="local-6989586621679151699"><a href="#local-6989586621679151699"><span class="hs-identifier">list</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VarT</span><span> </span><a name="local-6989586621679151700"><a href="#local-6989586621679151700"><span class="hs-identifier">tyName</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1308"></a><span>    </span><span class="hs-identifier hs-var">varE</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">lookup</span><span> </span><a href="#local-6989586621679151700"><span class="hs-identifier hs-var">tyName</span></a><span> </span><a href="#local-6989586621679151698"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1309"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151701"><a href="#local-6989586621679151701"><span class="hs-identifier">tfjExp</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679151702"><a href="#local-6989586621679151702"><span class="hs-identifier">tfjlExp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679151699"><span class="hs-identifier hs-var">list</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679151702"><span class="hs-identifier hs-var">tfjlExp</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679151701"><span class="hs-identifier hs-var">tfjExp</span></a><span>
</span><a name="line-1310"></a><span>                </span><span class="hs-identifier hs-var">Nothing</span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#jsonFunValOrListName"><span class="hs-identifier hs-var">jsonFunValOrListName</span></a><span> </span><a href="#local-6989586621679151699"><span class="hs-identifier hs-var">list</span></a><span> </span><a href="#local-6989586621679151697"><span class="hs-identifier hs-var">jf</span></a><span> </span><a href="Data.Aeson.TH.html#Arity0"><span class="hs-identifier hs-var">Arity0</span></a><span>
</span><a name="line-1311"></a><span class="hs-identifier">dispatchFunByType</span><span> </span><a name="local-6989586621679151703"><a href="#local-6989586621679151703"><span class="hs-identifier">jc</span></a></a><span> </span><a name="local-6989586621679151704"><a href="#local-6989586621679151704"><span class="hs-identifier">jf</span></a></a><span> </span><a name="local-6989586621679151705"><a href="#local-6989586621679151705"><span class="hs-identifier">conName</span></a></a><span> </span><a name="local-6989586621679151706"><a href="#local-6989586621679151706"><span class="hs-identifier">tvMap</span></a></a><span> </span><a name="local-6989586621679151707"><a href="#local-6989586621679151707"><span class="hs-identifier">list</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SigT</span><span> </span><a name="local-6989586621679151708"><a href="#local-6989586621679151708"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1312"></a><span>    </span><a href="Data.Aeson.TH.html#dispatchFunByType"><span class="hs-identifier hs-var">dispatchFunByType</span></a><span> </span><a href="#local-6989586621679151703"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151704"><span class="hs-identifier hs-var">jf</span></a><span> </span><a href="#local-6989586621679151705"><span class="hs-identifier hs-var">conName</span></a><span> </span><a href="#local-6989586621679151706"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151707"><span class="hs-identifier hs-var">list</span></a><span> </span><a href="#local-6989586621679151708"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1313"></a><span class="hs-identifier">dispatchFunByType</span><span> </span><a name="local-6989586621679151709"><a href="#local-6989586621679151709"><span class="hs-identifier">jc</span></a></a><span> </span><a name="local-6989586621679151710"><a href="#local-6989586621679151710"><span class="hs-identifier">jf</span></a></a><span> </span><a name="local-6989586621679151711"><a href="#local-6989586621679151711"><span class="hs-identifier">conName</span></a></a><span> </span><a name="local-6989586621679151712"><a href="#local-6989586621679151712"><span class="hs-identifier">tvMap</span></a></a><span> </span><a name="local-6989586621679151713"><a href="#local-6989586621679151713"><span class="hs-identifier">list</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ForallT</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679151714"><a href="#local-6989586621679151714"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1314"></a><span>    </span><a href="Data.Aeson.TH.html#dispatchFunByType"><span class="hs-identifier hs-var">dispatchFunByType</span></a><span> </span><a href="#local-6989586621679151709"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151710"><span class="hs-identifier hs-var">jf</span></a><span> </span><a href="#local-6989586621679151711"><span class="hs-identifier hs-var">conName</span></a><span> </span><a href="#local-6989586621679151712"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><a href="#local-6989586621679151713"><span class="hs-identifier hs-var">list</span></a><span> </span><a href="#local-6989586621679151714"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1315"></a><span class="hs-identifier">dispatchFunByType</span><span> </span><a name="local-6989586621679151715"><a href="#local-6989586621679151715"><span class="hs-identifier">jc</span></a></a><span> </span><a name="local-6989586621679151716"><a href="#local-6989586621679151716"><span class="hs-identifier">jf</span></a></a><span> </span><a name="local-6989586621679151717"><a href="#local-6989586621679151717"><span class="hs-identifier">conName</span></a></a><span> </span><a name="local-6989586621679151718"><a href="#local-6989586621679151718"><span class="hs-identifier">tvMap</span></a></a><span> </span><a name="local-6989586621679151719"><a href="#local-6989586621679151719"><span class="hs-identifier">list</span></a></a><span> </span><a name="local-6989586621679151720"><a href="#local-6989586621679151720"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1316"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">tyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-1317"></a><span>        </span><span class="hs-identifier">tyArgs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-1318"></a><span>        </span><a name="local-6989586621679151721"><a href="#local-6989586621679151721"><span class="hs-identifier">tyCon</span></a></a><span> </span><span class="hs-operator hs-var">:|</span><span> </span><a name="local-6989586621679151722"><a href="#local-6989586621679151722"><span class="hs-identifier">tyArgs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#unapplyTy"><span class="hs-identifier hs-var">unapplyTy</span></a><span> </span><a href="#local-6989586621679151720"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1319"></a><span>
</span><a name="line-1320"></a><span>        </span><span class="hs-identifier">numLastArgs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-1321"></a><span>        </span><a name="local-6989586621679151723"><a href="#local-6989586621679151723"><span class="hs-identifier">numLastArgs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">min</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#arityInt"><span class="hs-identifier hs-var">arityInt</span></a><span> </span><a href="#local-6989586621679151715"><span class="hs-identifier hs-var">jc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679151722"><span class="hs-identifier hs-var">tyArgs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1322"></a><span>
</span><a name="line-1323"></a><span>        </span><span class="hs-identifier">lhsArgs</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rhsArgs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-1324"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679151724"><a href="#local-6989586621679151724"><span class="hs-identifier">lhsArgs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679151725"><a href="#local-6989586621679151725"><span class="hs-identifier">rhsArgs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">splitAt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679151722"><span class="hs-identifier hs-var">tyArgs</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679151723"><span class="hs-identifier hs-var">numLastArgs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151722"><span class="hs-identifier hs-var">tyArgs</span></a><span>
</span><a name="line-1325"></a><span>
</span><a name="line-1326"></a><span>        </span><span class="hs-identifier">tyVarNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">]</span><span>
</span><a name="line-1327"></a><span>        </span><a name="local-6989586621679151726"><a href="#local-6989586621679151726"><span class="hs-identifier">tyVarNames</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">keys</span><span> </span><a href="#local-6989586621679151718"><span class="hs-identifier hs-var">tvMap</span></a><span>
</span><a name="line-1328"></a><span>
</span><a name="line-1329"></a><span>    </span><a name="local-6989586621679151727"><a href="#local-6989586621679151727"><span class="hs-identifier">itf</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Aeson.TH.html#isTyFamily"><span class="hs-identifier hs-var">isTyFamily</span></a><span> </span><a href="#local-6989586621679151721"><span class="hs-identifier hs-var">tyCon</span></a><span>
</span><a name="line-1330"></a><span>    </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="Data.Aeson.TH.html#mentionsName"><span class="hs-identifier hs-var">mentionsName</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679151726"><span class="hs-identifier hs-var">tyVarNames</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151724"><span class="hs-identifier hs-var">lhsArgs</span></a><span>
</span><a name="line-1331"></a><span>          </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679151727"><span class="hs-identifier hs-var">itf</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="Data.Aeson.TH.html#mentionsName"><span class="hs-identifier hs-var">mentionsName</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679151726"><span class="hs-identifier hs-var">tyVarNames</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151722"><span class="hs-identifier hs-var">tyArgs</span></a><span>
</span><a name="line-1332"></a><span>       </span><span class="hs-keyword">then</span><span> </span><a href="Data.Aeson.TH.html#outOfPlaceTyVarError"><span class="hs-identifier hs-var">outOfPlaceTyVarError</span></a><span> </span><a href="#local-6989586621679151715"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151717"><span class="hs-identifier hs-var">conName</span></a><span>
</span><a name="line-1333"></a><span>       </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="Data.Aeson.TH.html#mentionsName"><span class="hs-identifier hs-var">mentionsName</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679151726"><span class="hs-identifier hs-var">tyVarNames</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151725"><span class="hs-identifier hs-var">rhsArgs</span></a><span>
</span><a name="line-1334"></a><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">appsE</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#jsonFunValOrListName"><span class="hs-identifier hs-var">jsonFunValOrListName</span></a><span> </span><a href="#local-6989586621679151719"><span class="hs-identifier hs-var">list</span></a><span> </span><a href="#local-6989586621679151716"><span class="hs-identifier hs-var">jf</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">toEnum</span><span> </span><a href="#local-6989586621679151723"><span class="hs-identifier hs-var">numLastArgs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1335"></a><span>                         </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#dispatchFunByType"><span class="hs-identifier hs-var">dispatchFunByType</span></a><span> </span><a href="#local-6989586621679151715"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151716"><span class="hs-identifier hs-var">jf</span></a><span> </span><a href="#local-6989586621679151717"><span class="hs-identifier hs-var">conName</span></a><span> </span><a href="#local-6989586621679151718"><span class="hs-identifier hs-var">tvMap</span></a><span class="hs-special">)</span><span>
</span><a name="line-1336"></a><span>                                   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">cycle</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span class="hs-identifier hs-var">True</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1337"></a><span>                                   </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#interleave"><span class="hs-identifier hs-var">interleave</span></a><span> </span><a href="#local-6989586621679151725"><span class="hs-identifier hs-var">rhsArgs</span></a><span> </span><a href="#local-6989586621679151725"><span class="hs-identifier hs-var">rhsArgs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1338"></a><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">varE</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Aeson.TH.html#jsonFunValOrListName"><span class="hs-identifier hs-var">jsonFunValOrListName</span></a><span> </span><a href="#local-6989586621679151719"><span class="hs-identifier hs-var">list</span></a><span> </span><a href="#local-6989586621679151716"><span class="hs-identifier hs-var">jf</span></a><span> </span><a href="Data.Aeson.TH.html#Arity0"><span class="hs-identifier hs-var">Arity0</span></a><span>
</span><a name="line-1339"></a><span>
</span><a name="line-1340"></a><span class="hs-identifier">dispatchToJSON</span><span>
</span><a name="line-1341"></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#ToJSONFun"><span class="hs-identifier hs-type">ToJSONFun</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#TyVarMap"><span class="hs-identifier hs-type">TyVarMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-1342"></a><a name="dispatchToJSON"><a href="Data.Aeson.TH.html#dispatchToJSON"><span class="hs-identifier">dispatchToJSON</span></a></a><span> </span><a name="local-6989586621679151728"><a href="#local-6989586621679151728"><span class="hs-identifier">target</span></a></a><span> </span><a name="local-6989586621679151729"><a href="#local-6989586621679151729"><span class="hs-identifier">jc</span></a></a><span> </span><a name="local-6989586621679151730"><a href="#local-6989586621679151730"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679151731"><a href="#local-6989586621679151731"><span class="hs-identifier">tvMap</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1343"></a><span>    </span><a href="Data.Aeson.TH.html#dispatchFunByType"><span class="hs-identifier hs-var">dispatchFunByType</span></a><span> </span><a href="#local-6989586621679151729"><span class="hs-identifier hs-var">jc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#targetToJSONFun"><span class="hs-identifier hs-var">targetToJSONFun</span></a><span> </span><a href="#local-6989586621679151728"><span class="hs-identifier hs-var">target</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151730"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679151731"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1344"></a><span>
</span><a name="line-1345"></a><span class="hs-identifier">dispatchParseJSON</span><span>
</span><a name="line-1346"></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#TyVarMap"><span class="hs-identifier hs-type">TyVarMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-1347"></a><a name="dispatchParseJSON"><a href="Data.Aeson.TH.html#dispatchParseJSON"><span class="hs-identifier">dispatchParseJSON</span></a></a><span>  </span><a name="local-6989586621679151732"><a href="#local-6989586621679151732"><span class="hs-identifier">jc</span></a></a><span> </span><a name="local-6989586621679151733"><a href="#local-6989586621679151733"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679151734"><a href="#local-6989586621679151734"><span class="hs-identifier">tvMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#dispatchFunByType"><span class="hs-identifier hs-var">dispatchFunByType</span></a><span> </span><a href="#local-6989586621679151732"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="Data.Aeson.TH.html#ParseJSON"><span class="hs-identifier hs-var">ParseJSON</span></a><span>  </span><a href="#local-6989586621679151733"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679151734"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1348"></a><span>
</span><a name="line-1349"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-1350"></a><span class="hs-comment">-- Utility functions</span><span>
</span><a name="line-1351"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-1352"></a><span>
</span><a name="line-1353"></a><span class="hs-comment">-- For the given Types, generate an instance context and head.</span><span>
</span><a name="line-1354"></a><span class="hs-identifier">buildTypeInstance</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-1355"></a><span>                  </span><span class="hs-comment">-- ^ The type constructor or data family name</span><span>
</span><a name="line-1356"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span>
</span><a name="line-1357"></a><span>                  </span><span class="hs-comment">-- ^ The typeclass to derive</span><span>
</span><a name="line-1358"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Cxt</span><span>
</span><a name="line-1359"></a><span>                  </span><span class="hs-comment">-- ^ The datatype context</span><span>
</span><a name="line-1360"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-1361"></a><span>                  </span><span class="hs-comment">-- ^ The types to instantiate the instance with</span><span>
</span><a name="line-1362"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DatatypeVariant</span><span>
</span><a name="line-1363"></a><span>                  </span><span class="hs-comment">-- ^ Are we dealing with a data family instance or not</span><span>
</span><a name="line-1364"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Cxt</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span>
</span><a name="line-1365"></a><a name="buildTypeInstance"><a href="Data.Aeson.TH.html#buildTypeInstance"><span class="hs-identifier">buildTypeInstance</span></a></a><span> </span><a name="local-6989586621679151735"><a href="#local-6989586621679151735"><span class="hs-identifier">tyConName</span></a></a><span> </span><a name="local-6989586621679151736"><a href="#local-6989586621679151736"><span class="hs-identifier">jc</span></a></a><span> </span><a name="local-6989586621679151737"><a href="#local-6989586621679151737"><span class="hs-identifier">dataCxt</span></a></a><span> </span><a name="local-6989586621679151738"><a href="#local-6989586621679151738"><span class="hs-identifier">varTysOrig</span></a></a><span> </span><a name="local-6989586621679151739"><a href="#local-6989586621679151739"><span class="hs-identifier">variant</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1366"></a><span>    </span><span class="hs-comment">-- Make sure to expand through type/kind synonyms! Otherwise, the</span><span>
</span><a name="line-1367"></a><span>    </span><span class="hs-comment">-- eta-reduction check might get tripped up over type variables in a</span><span>
</span><a name="line-1368"></a><span>    </span><span class="hs-comment">-- synonym that are actually dropped.</span><span>
</span><a name="line-1369"></a><span>    </span><span class="hs-comment">-- (See GHC Trac #11416 for a scenario where this actually happened.)</span><span>
</span><a name="line-1370"></a><span>    </span><a name="local-6989586621679151740"><a href="#local-6989586621679151740"><span class="hs-identifier">varTysExp</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-identifier hs-var">resolveTypeSynonyms</span><span> </span><a href="#local-6989586621679151738"><span class="hs-identifier hs-var">varTysOrig</span></a><span>
</span><a name="line-1371"></a><span>
</span><a name="line-1372"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">remainingLength</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-1373"></a><span>        </span><a name="local-6989586621679151741"><a href="#local-6989586621679151741"><span class="hs-identifier">remainingLength</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679151738"><span class="hs-identifier hs-var">varTysOrig</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="Data.Aeson.TH.html#arityInt"><span class="hs-identifier hs-var">arityInt</span></a><span> </span><a href="#local-6989586621679151736"><span class="hs-identifier hs-var">jc</span></a><span>
</span><a name="line-1374"></a><span>
</span><a name="line-1375"></a><span>        </span><span class="hs-identifier">droppedTysExp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-1376"></a><span>        </span><a name="local-6989586621679151742"><a href="#local-6989586621679151742"><span class="hs-identifier">droppedTysExp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">drop</span><span> </span><a href="#local-6989586621679151741"><span class="hs-identifier hs-var">remainingLength</span></a><span> </span><a href="#local-6989586621679151740"><span class="hs-identifier hs-var">varTysExp</span></a><span>
</span><a name="line-1377"></a><span>
</span><a name="line-1378"></a><span>        </span><span class="hs-identifier">droppedStarKindStati</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Data.Aeson.TH.html#StarKindStatus"><span class="hs-identifier hs-type">StarKindStatus</span></a><span class="hs-special">]</span><span>
</span><a name="line-1379"></a><span>        </span><a name="local-6989586621679151743"><a href="#local-6989586621679151743"><span class="hs-identifier">droppedStarKindStati</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Data.Aeson.TH.html#canRealizeKindStar"><span class="hs-identifier hs-var">canRealizeKindStar</span></a><span> </span><a href="#local-6989586621679151742"><span class="hs-identifier hs-var">droppedTysExp</span></a><span>
</span><a name="line-1380"></a><span>
</span><a name="line-1381"></a><span>    </span><span class="hs-comment">-- Check there are enough types to drop and that all of them are either of</span><span>
</span><a name="line-1382"></a><span>    </span><span class="hs-comment">-- kind * or kind k (for some kind variable k). If not, throw an error.</span><span>
</span><a name="line-1383"></a><span>    </span><span class="hs-identifier hs-var">when</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151741"><span class="hs-identifier hs-var">remainingLength</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier hs-var">elem</span><span> </span><a href="Data.Aeson.TH.html#NotKindStar"><span class="hs-identifier hs-var">NotKindStar</span></a><span> </span><a href="#local-6989586621679151743"><span class="hs-identifier hs-var">droppedStarKindStati</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1384"></a><span>      </span><a href="Data.Aeson.TH.html#derivingKindError"><span class="hs-identifier hs-var">derivingKindError</span></a><span> </span><a href="#local-6989586621679151736"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151735"><span class="hs-identifier hs-var">tyConName</span></a><span>
</span><a name="line-1385"></a><span>
</span><a name="line-1386"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">droppedKindVarNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">]</span><span>
</span><a name="line-1387"></a><span>        </span><a name="local-6989586621679151744"><a href="#local-6989586621679151744"><span class="hs-identifier">droppedKindVarNames</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#catKindVarNames"><span class="hs-identifier hs-var">catKindVarNames</span></a><span> </span><a href="#local-6989586621679151743"><span class="hs-identifier hs-var">droppedStarKindStati</span></a><span>
</span><a name="line-1388"></a><span>
</span><a name="line-1389"></a><span>        </span><span class="hs-comment">-- Substitute kind * for any dropped kind variables</span><span>
</span><a name="line-1390"></a><span>        </span><span class="hs-identifier">varTysExpSubst</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-1391"></a><span>        </span><a name="local-6989586621679151745"><a href="#local-6989586621679151745"><span class="hs-identifier">varTysExpSubst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#substNamesWithKindStar"><span class="hs-identifier hs-var">substNamesWithKindStar</span></a><span> </span><a href="#local-6989586621679151744"><span class="hs-identifier hs-var">droppedKindVarNames</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151740"><span class="hs-identifier hs-var">varTysExp</span></a><span>
</span><a name="line-1392"></a><span>
</span><a name="line-1393"></a><span>        </span><span class="hs-identifier">remainingTysExpSubst</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">droppedTysExpSubst</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-1394"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679151746"><a href="#local-6989586621679151746"><span class="hs-identifier">remainingTysExpSubst</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679151747"><a href="#local-6989586621679151747"><span class="hs-identifier">droppedTysExpSubst</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1395"></a><span>          </span><span class="hs-identifier hs-var">splitAt</span><span> </span><a href="#local-6989586621679151741"><span class="hs-identifier hs-var">remainingLength</span></a><span> </span><a href="#local-6989586621679151745"><span class="hs-identifier hs-var">varTysExpSubst</span></a><span>
</span><a name="line-1396"></a><span>
</span><a name="line-1397"></a><span>        </span><span class="hs-comment">-- All of the type variables mentioned in the dropped types</span><span>
</span><a name="line-1398"></a><span>        </span><span class="hs-comment">-- (post-synonym expansion)</span><span>
</span><a name="line-1399"></a><span>        </span><span class="hs-identifier">droppedTyVarNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">]</span><span>
</span><a name="line-1400"></a><span>        </span><a name="local-6989586621679151748"><a href="#local-6989586621679151748"><span class="hs-identifier">droppedTyVarNames</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">freeVariables</span><span> </span><a href="#local-6989586621679151747"><span class="hs-identifier hs-var">droppedTysExpSubst</span></a><span>
</span><a name="line-1401"></a><span>
</span><a name="line-1402"></a><span>    </span><span class="hs-comment">-- If any of the dropped types were polykinded, ensure that they are of kind *</span><span>
</span><a name="line-1403"></a><span>    </span><span class="hs-comment">-- after substituting * for the dropped kind variables. If not, throw an error.</span><span>
</span><a name="line-1404"></a><span>    </span><span class="hs-identifier hs-var">unless</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">all</span><span> </span><a href="Data.Aeson.TH.html#hasKindStar"><span class="hs-identifier hs-var">hasKindStar</span></a><span> </span><a href="#local-6989586621679151747"><span class="hs-identifier hs-var">droppedTysExpSubst</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1405"></a><span>      </span><a href="Data.Aeson.TH.html#derivingKindError"><span class="hs-identifier hs-var">derivingKindError</span></a><span> </span><a href="#local-6989586621679151736"><span class="hs-identifier hs-var">jc</span></a><span> </span><a href="#local-6989586621679151735"><span class="hs-identifier hs-var">tyConName</span></a><span>
</span><a name="line-1406"></a><span>
</span><a name="line-1407"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">preds</span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Pred</span><span class="hs-special">]</span><span>
</span><a name="line-1408"></a><span>        </span><span class="hs-identifier">kvNames</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1409"></a><span>        </span><span class="hs-identifier">kvNames'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">]</span><span>
</span><a name="line-1410"></a><span>        </span><span class="hs-comment">-- Derive instance constraints (and any kind variables which are specialized</span><span>
</span><a name="line-1411"></a><span>        </span><span class="hs-comment">-- to * in those constraints)</span><span>
</span><a name="line-1412"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679151749"><a href="#local-6989586621679151749"><span class="hs-identifier">preds</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679151750"><a href="#local-6989586621679151750"><span class="hs-identifier">kvNames</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unzip</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#deriveConstraint"><span class="hs-identifier hs-var">deriveConstraint</span></a><span> </span><a href="#local-6989586621679151736"><span class="hs-identifier hs-var">jc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151746"><span class="hs-identifier hs-var">remainingTysExpSubst</span></a><span>
</span><a name="line-1413"></a><span>        </span><a name="local-6989586621679151751"><a href="#local-6989586621679151751"><span class="hs-identifier">kvNames'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><a href="#local-6989586621679151750"><span class="hs-identifier hs-var">kvNames</span></a><span>
</span><a name="line-1414"></a><span>
</span><a name="line-1415"></a><span>        </span><span class="hs-comment">-- Substitute the kind variables specialized in the constraints with *</span><span>
</span><a name="line-1416"></a><span>        </span><span class="hs-identifier">remainingTysExpSubst'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-1417"></a><span>        </span><a name="local-6989586621679151752"><a href="#local-6989586621679151752"><span class="hs-identifier">remainingTysExpSubst'</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1418"></a><span>          </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#substNamesWithKindStar"><span class="hs-identifier hs-var">substNamesWithKindStar</span></a><span> </span><a href="#local-6989586621679151751"><span class="hs-identifier hs-var">kvNames'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151746"><span class="hs-identifier hs-var">remainingTysExpSubst</span></a><span>
</span><a name="line-1419"></a><span>
</span><a name="line-1420"></a><span>        </span><span class="hs-comment">-- We now substitute all of the specialized-to-* kind variable names with</span><span>
</span><a name="line-1421"></a><span>        </span><span class="hs-comment">-- *, but in the original types, not the synonym-expanded types. The reason</span><span>
</span><a name="line-1422"></a><span>        </span><span class="hs-comment">-- we do this is a superficial one: we want the derived instance to resemble</span><span>
</span><a name="line-1423"></a><span>        </span><span class="hs-comment">-- the datatype written in source code as closely as possible. For example,</span><span>
</span><a name="line-1424"></a><span>        </span><span class="hs-comment">-- for the following data family instance:</span><span>
</span><a name="line-1425"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-1426"></a><span>        </span><span class="hs-comment">--   data family Fam a</span><span>
</span><a name="line-1427"></a><span>        </span><span class="hs-comment">--   newtype instance Fam String = Fam String</span><span>
</span><a name="line-1428"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-1429"></a><span>        </span><span class="hs-comment">-- We'd want to generate the instance:</span><span>
</span><a name="line-1430"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-1431"></a><span>        </span><span class="hs-comment">--   instance C (Fam String)</span><span>
</span><a name="line-1432"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-1433"></a><span>        </span><span class="hs-comment">-- Not:</span><span>
</span><a name="line-1434"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-1435"></a><span>        </span><span class="hs-comment">--   instance C (Fam [Char])</span><span>
</span><a name="line-1436"></a><span>        </span><span class="hs-identifier">remainingTysOrigSubst</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-1437"></a><span>        </span><a name="local-6989586621679151753"><a href="#local-6989586621679151753"><span class="hs-identifier">remainingTysOrigSubst</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1438"></a><span>          </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#substNamesWithKindStar"><span class="hs-identifier hs-var">substNamesWithKindStar</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151744"><span class="hs-identifier hs-var">droppedKindVarNames</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">union</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679151751"><span class="hs-identifier hs-var">kvNames'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1439"></a><span>            </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">take</span><span> </span><a href="#local-6989586621679151741"><span class="hs-identifier hs-var">remainingLength</span></a><span> </span><a href="#local-6989586621679151738"><span class="hs-identifier hs-var">varTysOrig</span></a><span>
</span><a name="line-1440"></a><span>
</span><a name="line-1441"></a><span>        </span><span class="hs-identifier">isDataFamily</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1442"></a><span>        </span><a name="local-6989586621679151754"><a href="#local-6989586621679151754"><span class="hs-identifier">isDataFamily</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679151739"><span class="hs-identifier hs-var">variant</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1443"></a><span>                         </span><span class="hs-identifier hs-var">Datatype</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1444"></a><span>                         </span><span class="hs-identifier hs-var">Newtype</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1445"></a><span>                         </span><span class="hs-identifier hs-var">DataInstance</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1446"></a><span>                         </span><span class="hs-identifier hs-var">NewtypeInstance</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1447"></a><span>
</span><a name="line-1448"></a><span>        </span><span class="hs-identifier">remainingTysOrigSubst'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span>
</span><a name="line-1449"></a><span>        </span><span class="hs-comment">-- See Note [Kind signatures in derived instances] for an explanation</span><span>
</span><a name="line-1450"></a><span>        </span><span class="hs-comment">-- of the isDataFamily check.</span><span>
</span><a name="line-1451"></a><span>        </span><a name="local-6989586621679151755"><a href="#local-6989586621679151755"><span class="hs-identifier">remainingTysOrigSubst'</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1452"></a><span>          </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679151754"><span class="hs-identifier hs-var">isDataFamily</span></a><span>
</span><a name="line-1453"></a><span>             </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679151753"><span class="hs-identifier hs-var">remainingTysOrigSubst</span></a><span>
</span><a name="line-1454"></a><span>             </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Data.Aeson.TH.html#unSigT"><span class="hs-identifier hs-var">unSigT</span></a><span> </span><a href="#local-6989586621679151753"><span class="hs-identifier hs-var">remainingTysOrigSubst</span></a><span>
</span><a name="line-1455"></a><span>
</span><a name="line-1456"></a><span>        </span><span class="hs-identifier">instanceCxt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Cxt</span><span>
</span><a name="line-1457"></a><span>        </span><a name="local-6989586621679151756"><a href="#local-6989586621679151756"><span class="hs-identifier">instanceCxt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">catMaybes</span><span> </span><a href="#local-6989586621679151749"><span class="hs-identifier hs-var">preds</span></a><span>
</span><a name="line-1458"></a><span>
</span><a name="line-1459"></a><span>        </span><span class="hs-identifier">instanceType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-1460"></a><span>        </span><a name="local-6989586621679151757"><a href="#local-6989586621679151757"><span class="hs-identifier">instanceType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">AppT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ConT</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Aeson.TH.html#jsonClassName"><span class="hs-identifier hs-var">jsonClassName</span></a><span> </span><a href="#local-6989586621679151736"><span class="hs-identifier hs-var">jc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1461"></a><span>                     </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Aeson.TH.html#applyTyCon"><span class="hs-identifier hs-var">applyTyCon</span></a><span> </span><a href="#local-6989586621679151735"><span class="hs-identifier hs-var">tyConName</span></a><span> </span><a href="#local-6989586621679151755"><span class="hs-identifier hs-var">remainingTysOrigSubst'</span></a><span>
</span><a name="line-1462"></a><span>
</span><a name="line-1463"></a><span>    </span><span class="hs-comment">-- If the datatype context mentions any of the dropped type variables,</span><span>
</span><a name="line-1464"></a><span>    </span><span class="hs-comment">-- we can't derive an instance, so throw an error.</span><span>
</span><a name="line-1465"></a><span>    </span><span class="hs-identifier hs-var">when</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="Data.Aeson.TH.html#predMentionsName"><span class="hs-identifier hs-var">predMentionsName</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679151748"><span class="hs-identifier hs-var">droppedTyVarNames</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151737"><span class="hs-identifier hs-var">dataCxt</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1466"></a><span>      </span><a href="Data.Aeson.TH.html#datatypeContextError"><span class="hs-identifier hs-var">datatypeContextError</span></a><span> </span><a href="#local-6989586621679151735"><span class="hs-identifier hs-var">tyConName</span></a><span> </span><a href="#local-6989586621679151757"><span class="hs-identifier hs-var">instanceType</span></a><span>
</span><a name="line-1467"></a><span>    </span><span class="hs-comment">-- Also ensure the dropped types can be safely eta-reduced. Otherwise,</span><span>
</span><a name="line-1468"></a><span>    </span><span class="hs-comment">-- throw an error.</span><span>
</span><a name="line-1469"></a><span>    </span><span class="hs-identifier hs-var">unless</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#canEtaReduce"><span class="hs-identifier hs-var">canEtaReduce</span></a><span> </span><a href="#local-6989586621679151752"><span class="hs-identifier hs-var">remainingTysExpSubst'</span></a><span> </span><a href="#local-6989586621679151747"><span class="hs-identifier hs-var">droppedTysExpSubst</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1470"></a><span>      </span><a href="Data.Aeson.TH.html#etaReductionError"><span class="hs-identifier hs-var">etaReductionError</span></a><span> </span><a href="#local-6989586621679151757"><span class="hs-identifier hs-var">instanceType</span></a><span>
</span><a name="line-1471"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151756"><span class="hs-identifier hs-var">instanceCxt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151757"><span class="hs-identifier hs-var">instanceType</span></a><span class="hs-special">)</span><span>
</span><a name="line-1472"></a><span>
</span><a name="line-1473"></a><span class="hs-comment">-- | Attempt to derive a constraint on a Type. If successful, return</span><span>
</span><a name="line-1474"></a><span class="hs-comment">-- Just the constraint and any kind variable names constrained to *.</span><span>
</span><a name="line-1475"></a><span class="hs-comment">-- Otherwise, return Nothing and the empty list.</span><span>
</span><a name="line-1476"></a><span class="hs-comment">--</span><span>
</span><a name="line-1477"></a><span class="hs-comment">-- See Note [Type inference in derived instances] for the heuristics used to</span><span>
</span><a name="line-1478"></a><span class="hs-comment">-- come up with constraints.</span><span>
</span><a name="line-1479"></a><span class="hs-identifier">deriveConstraint</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Pred</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1480"></a><a name="deriveConstraint"><a href="Data.Aeson.TH.html#deriveConstraint"><span class="hs-identifier">deriveConstraint</span></a></a><span> </span><a name="local-6989586621679151758"><a href="#local-6989586621679151758"><span class="hs-identifier">jc</span></a></a><span> </span><a name="local-6989586621679151759"><a href="#local-6989586621679151759"><span class="hs-identifier">t</span></a></a><span>
</span><a name="line-1481"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a><span> </span><a href="#local-6989586621679151759"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1482"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Data.Aeson.TH.html#hasKindStar"><span class="hs-identifier hs-var">hasKindStar</span></a><span> </span><a href="#local-6989586621679151759"><span class="hs-identifier hs-var">t</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#applyCon"><span class="hs-identifier hs-var">applyCon</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151762"><span class="hs-identifier hs-var">jcConstraint</span></a><span> </span><a href="Data.Aeson.TH.html#Arity0"><span class="hs-identifier hs-var">Arity0</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151760"><span class="hs-identifier hs-var">tName</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1483"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.Aeson.TH.html#hasKindVarChain"><span class="hs-identifier hs-var">hasKindVarChain</span></a><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679151759"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1484"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679151763"><a href="#local-6989586621679151763"><span class="hs-identifier">ns</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679151761"><span class="hs-identifier hs-var">jcArity</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="Data.Aeson.TH.html#Arity1"><span class="hs-identifier hs-var">Arity1</span></a><span>
</span><a name="line-1485"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#applyCon"><span class="hs-identifier hs-var">applyCon</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151762"><span class="hs-identifier hs-var">jcConstraint</span></a><span> </span><a href="Data.Aeson.TH.html#Arity1"><span class="hs-identifier hs-var">Arity1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151760"><span class="hs-identifier hs-var">tName</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151763"><span class="hs-identifier hs-var">ns</span></a><span class="hs-special">)</span><span>
</span><a name="line-1486"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.Aeson.TH.html#hasKindVarChain"><span class="hs-identifier hs-var">hasKindVarChain</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621679151759"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1487"></a><span>           </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679151764"><a href="#local-6989586621679151764"><span class="hs-identifier">ns</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679151761"><span class="hs-identifier hs-var">jcArity</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Data.Aeson.TH.html#Arity2"><span class="hs-identifier hs-var">Arity2</span></a><span>
</span><a name="line-1488"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#applyCon"><span class="hs-identifier hs-var">applyCon</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151762"><span class="hs-identifier hs-var">jcConstraint</span></a><span> </span><a href="Data.Aeson.TH.html#Arity2"><span class="hs-identifier hs-var">Arity2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151760"><span class="hs-identifier hs-var">tName</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151764"><span class="hs-identifier hs-var">ns</span></a><span class="hs-special">)</span><span>
</span><a name="line-1489"></a><span>           </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1490"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1491"></a><span>    </span><span class="hs-identifier">tName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-1492"></a><span>    </span><a name="local-6989586621679151760"><a href="#local-6989586621679151760"><span class="hs-identifier">tName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#varTToName"><span class="hs-identifier hs-var">varTToName</span></a><span> </span><a href="#local-6989586621679151759"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1493"></a><span>
</span><a name="line-1494"></a><span>    </span><span class="hs-identifier">jcArity</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span>
</span><a name="line-1495"></a><span>    </span><a name="local-6989586621679151761"><a href="#local-6989586621679151761"><span class="hs-identifier">jcArity</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">arity</span><span> </span><a href="#local-6989586621679151758"><span class="hs-identifier hs-var">jc</span></a><span>
</span><a name="line-1496"></a><span>
</span><a name="line-1497"></a><span>    </span><span class="hs-identifier">jcConstraint</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-1498"></a><span>    </span><a name="local-6989586621679151762"><a href="#local-6989586621679151762"><span class="hs-identifier">jcConstraint</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#jsonClassName"><span class="hs-identifier hs-var">jsonClassName</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-var">JSONClass</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">direction</span><span> </span><a href="#local-6989586621679151758"><span class="hs-identifier hs-var">jc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1499"></a><span>
</span><a name="line-1500"></a><span class="hs-comment">{-
Note [Kind signatures in derived instances]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

It is possible to put explicit kind signatures into the derived instances, e.g.,

  instance C a =&gt; C (Data (f :: * -&gt; *)) where ...

But it is preferable to avoid this if possible. If we come up with an incorrect
kind signature (which is entirely possible, since Template Haskell doesn't always
have the best track record with reifying kind signatures), then GHC will flat-out
reject the instance, which is quite unfortunate.

Plain old datatypes have the advantage that you can avoid using any kind signatures
at all in their instances. This is because a datatype declaration uses all type
variables, so the types that we use in a derived instance uniquely determine their
kinds. As long as we plug in the right types, the kind inferencer can do the rest
of the work. For this reason, we use unSigT to remove all kind signatures before
splicing in the instance context and head.

Data family instances are trickier, since a data family can have two instances that
are distinguished by kind alone, e.g.,

  data family Fam (a :: k)
  data instance Fam (a :: * -&gt; *)
  data instance Fam (a :: *)

If we dropped the kind signatures for C (Fam a), then GHC will have no way of
knowing which instance we are talking about. To avoid this scenario, we always
include explicit kind signatures in data family instances. There is a chance that
the inferred kind signatures will be incorrect, but if so, we can always fall back
on the mk- functions.

Note [Type inference in derived instances]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Type inference is can be tricky to get right, and we want to avoid recreating the
entirety of GHC's type inferencer in Template Haskell. For this reason, we will
probably never come up with derived instance contexts that are as accurate as
GHC's. But that doesn't mean we can't do anything! There are a couple of simple
things we can do to make instance contexts that work for 80% of use cases:

1. If one of the last type parameters is polykinded, then its kind will be
   specialized to * in the derived instance. We note what kind variable the type
   parameter had and substitute it with * in the other types as well. For example,
   imagine you had

     data Data (a :: k) (b :: k)

   Then you'd want to derived instance to be:

     instance C (Data (a :: *))

   Not:

     instance C (Data (a :: k))

2. We na&#239;vely come up with instance constraints using the following criteria:

   (i)   If there's a type parameter n of kind *, generate a ToJSON n/FromJSON n
         constraint.
   (ii)  If there's a type parameter n of kind k1 -&gt; k2 (where k1/k2 are * or kind
         variables), then generate a ToJSON1 n/FromJSON1 n constraint, and if
         k1/k2 are kind variables, then substitute k1/k2 with * elsewhere in the
         types. We must consider the case where they are kind variables because
         you might have a scenario like this:

           newtype Compose (f :: k2 -&gt; *) (g :: k1 -&gt; k2) (a :: k1)
             = Compose (f (g a))

         Which would have a derived ToJSON1 instance of:

           instance (ToJSON1 f, ToJSON1 g) =&gt; ToJSON1 (Compose f g) where ...
   (iii) If there's a type parameter n of kind k1 -&gt; k2 -&gt; k3 (where k1/k2/k3 are
         * or kind variables), then generate a ToJSON2 n/FromJSON2 n constraint
         and perform kind substitution as in the other cases.
-}</span><span>
</span><a name="line-1577"></a><span>
</span><a name="line-1578"></a><span class="hs-identifier">checkExistentialContext</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#TyVarMap"><span class="hs-identifier hs-type">TyVarMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Cxt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-1579"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><a href="#local-6989586621679151291"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><a href="#local-6989586621679151291"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1580"></a><a name="checkExistentialContext"><a href="Data.Aeson.TH.html#checkExistentialContext"><span class="hs-identifier">checkExistentialContext</span></a></a><span> </span><a name="local-6989586621679151765"><a href="#local-6989586621679151765"><span class="hs-identifier">jc</span></a></a><span> </span><a name="local-6989586621679151766"><a href="#local-6989586621679151766"><span class="hs-identifier">tvMap</span></a></a><span> </span><a name="local-6989586621679151767"><a href="#local-6989586621679151767"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621679151768"><a href="#local-6989586621679151768"><span class="hs-identifier">conName</span></a></a><span> </span><a name="local-6989586621679151769"><a href="#local-6989586621679151769"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1581"></a><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="Data.Aeson.TH.html#predMentionsName"><span class="hs-identifier hs-var">predMentionsName</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">keys</span><span> </span><a href="#local-6989586621679151766"><span class="hs-identifier hs-var">tvMap</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151767"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-1582"></a><span>       </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">size</span><span> </span><a href="#local-6989586621679151766"><span class="hs-identifier hs-var">tvMap</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="Data.Aeson.TH.html#arityInt"><span class="hs-identifier hs-var">arityInt</span></a><span> </span><a href="#local-6989586621679151765"><span class="hs-identifier hs-var">jc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1583"></a><span>       </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#allowExQuant"><span class="hs-identifier hs-var">allowExQuant</span></a><span> </span><a href="#local-6989586621679151765"><span class="hs-identifier hs-var">jc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1584"></a><span>     </span><span class="hs-keyword">then</span><span> </span><a href="Data.Aeson.TH.html#existentialContextError"><span class="hs-identifier hs-var">existentialContextError</span></a><span> </span><a href="#local-6989586621679151768"><span class="hs-identifier hs-var">conName</span></a><span>
</span><a name="line-1585"></a><span>     </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679151769"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-1586"></a><span>
</span><a name="line-1587"></a><span class="hs-comment">{-
Note [Matching functions with GADT type variables]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

When deriving ToJSON2, there is a tricky corner case to consider:

  data Both a b where
    BothCon :: x -&gt; x -&gt; Both x x

Which encoding functions should be applied to which arguments of BothCon?
We have a choice, since both the function of type (a -&gt; Value) and of type
(b -&gt; Value) can be applied to either argument. In such a scenario, the
second encoding function takes precedence over the first encoding function, so the
derived ToJSON2 instance would be something like:

  instance ToJSON2 Both where
    liftToJSON2 tj1 tj2 p (BothCon x1 x2) = Array $ create $ do
      mv &lt;- unsafeNew 2
      unsafeWrite mv 0 (tj1 x1)
      unsafeWrite mv 1 (tj2 x2)
      return mv

This is not an arbitrary choice, as this definition ensures that
liftToJSON2 toJSON = liftToJSON for a derived ToJSON1 instance for
Both.
-}</span><span>
</span><a name="line-1613"></a><span>
</span><a name="line-1614"></a><span class="hs-comment">-- A mapping of type variable Names to their encoding/decoding function Names.</span><span>
</span><a name="line-1615"></a><span class="hs-comment">-- For example, in a ToJSON2 declaration, a TyVarMap might look like</span><span>
</span><a name="line-1616"></a><span class="hs-comment">--</span><span>
</span><a name="line-1617"></a><span class="hs-comment">-- { a ~&gt; (tj1, tjl1)</span><span>
</span><a name="line-1618"></a><span class="hs-comment">-- , b ~&gt; (tj2, tjl2) }</span><span>
</span><a name="line-1619"></a><span class="hs-comment">--</span><span>
</span><a name="line-1620"></a><span class="hs-comment">-- where a and b are the last two type variables of the datatype, tj1 and tjl1 are</span><span>
</span><a name="line-1621"></a><span class="hs-comment">-- the function arguments of types (a -&gt; Value) and ([a] -&gt; Value), and tj2 and tjl2</span><span>
</span><a name="line-1622"></a><span class="hs-comment">-- are the function arguments of types (b -&gt; Value) and ([b] -&gt; Value).</span><span>
</span><a name="line-1623"></a><span class="hs-keyword">type</span><span> </span><a name="TyVarMap"><a href="Data.Aeson.TH.html#TyVarMap"><span class="hs-identifier">TyVarMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Name</span><span class="hs-special">)</span><span>
</span><a name="line-1624"></a><span>
</span><a name="line-1625"></a><span class="hs-comment">-- | Returns True if a Type has kind *.</span><span>
</span><a name="line-1626"></a><span class="hs-identifier">hasKindStar</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1627"></a><a name="hasKindStar"><a href="Data.Aeson.TH.html#hasKindStar"><span class="hs-identifier">hasKindStar</span></a></a><span> </span><span class="hs-identifier hs-var">VarT</span><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1628"></a><span class="hs-cpp">#if MIN_VERSION_template_haskell(2,8,0)</span><span>
</span><a name="line-1629"></a><span class="hs-identifier">hasKindStar</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SigT</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">StarT</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1630"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1631"></a><span class="hs-identifier">hasKindStar</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SigT</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">StarK</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><a name="line-1632"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1633"></a><span class="hs-identifier">hasKindStar</span><span> </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1634"></a><span>
</span><a name="line-1635"></a><span class="hs-comment">-- Returns True is a kind is equal to *, or if it is a kind variable.</span><span>
</span><a name="line-1636"></a><span class="hs-identifier">isStarOrVar</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Kind</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1637"></a><span class="hs-cpp">#if MIN_VERSION_template_haskell(2,8,0)</span><span>
</span><a name="line-1638"></a><a name="isStarOrVar"><a href="Data.Aeson.TH.html#isStarOrVar"><span class="hs-identifier">isStarOrVar</span></a></a><span> </span><span class="hs-identifier hs-var">StarT</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1639"></a><span class="hs-identifier">isStarOrVar</span><span> </span><span class="hs-identifier hs-var">VarT</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1640"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1641"></a><span class="hs-identifier">isStarOrVar</span><span> </span><span class="hs-identifier">StarK</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><a name="line-1642"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1643"></a><span class="hs-identifier">isStarOrVar</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1644"></a><span>
</span><a name="line-1645"></a><span class="hs-comment">-- Generate a list of fresh names with a common prefix, and numbered suffixes.</span><span>
</span><a name="line-1646"></a><span class="hs-identifier">newNameList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">]</span><span>
</span><a name="line-1647"></a><a name="newNameList"><a href="Data.Aeson.TH.html#newNameList"><span class="hs-identifier">newNameList</span></a></a><span> </span><a name="local-6989586621679151770"><a href="#local-6989586621679151770"><span class="hs-identifier">prefix</span></a></a><span> </span><a name="local-6989586621679151771"><a href="#local-6989586621679151771"><span class="hs-identifier">len</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151770"><span class="hs-identifier hs-var">prefix</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679151772"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679151772"><a href="#local-6989586621679151772"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679151771"><span class="hs-identifier hs-var">len</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1648"></a><span>
</span><a name="line-1649"></a><span class="hs-comment">-- | @hasKindVarChain n kind@ Checks if @kind@ is of the form</span><span>
</span><a name="line-1650"></a><span class="hs-comment">-- k_0 -&gt; k_1 -&gt; ... -&gt; k_(n-1), where k0, k1, ..., and k_(n-1) can be * or</span><span>
</span><a name="line-1651"></a><span class="hs-comment">-- kind variables.</span><span>
</span><a name="line-1652"></a><span class="hs-identifier">hasKindVarChain</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">]</span><span>
</span><a name="line-1653"></a><a name="hasKindVarChain"><a href="Data.Aeson.TH.html#hasKindVarChain"><span class="hs-identifier">hasKindVarChain</span></a></a><span> </span><a name="local-6989586621679151773"><a href="#local-6989586621679151773"><span class="hs-identifier">kindArrows</span></a></a><span> </span><a name="local-6989586621679151774"><a href="#local-6989586621679151774"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1654"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679151775"><a href="#local-6989586621679151775"><span class="hs-identifier">uk</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#uncurryKind"><span class="hs-identifier hs-var">uncurryKind</span></a><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#tyKind"><span class="hs-identifier hs-var">tyKind</span></a><span> </span><a href="#local-6989586621679151774"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-1655"></a><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NE</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679151775"><span class="hs-identifier hs-var">uk</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679151773"><span class="hs-identifier hs-var">kindArrows</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">F</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">all</span><span> </span><a href="Data.Aeson.TH.html#isStarOrVar"><span class="hs-identifier hs-var">isStarOrVar</span></a><span> </span><a href="#local-6989586621679151775"><span class="hs-identifier hs-var">uk</span></a><span>
</span><a name="line-1656"></a><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-identifier hs-var">freeVariables</span><span> </span><a href="#local-6989586621679151775"><span class="hs-identifier hs-var">uk</span></a><span class="hs-special">)</span><span>
</span><a name="line-1657"></a><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1658"></a><span>
</span><a name="line-1659"></a><span class="hs-comment">-- | If a Type is a SigT, returns its kind signature. Otherwise, return *.</span><span>
</span><a name="line-1660"></a><span class="hs-identifier">tyKind</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Kind</span><span>
</span><a name="line-1661"></a><a name="tyKind"><a href="Data.Aeson.TH.html#tyKind"><span class="hs-identifier">tyKind</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SigT</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679151776"><a href="#local-6989586621679151776"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151776"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-1662"></a><span class="hs-identifier">tyKind</span><span> </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">starK</span><span>
</span><a name="line-1663"></a><span>
</span><a name="line-1664"></a><span class="hs-comment">-- | Extract Just the Name from a type variable. If the argument Type is not a</span><span>
</span><a name="line-1665"></a><span class="hs-comment">-- type variable, return Nothing.</span><span>
</span><a name="line-1666"></a><span class="hs-identifier">varTToNameMaybe</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-1667"></a><a name="varTToNameMaybe"><a href="Data.Aeson.TH.html#varTToNameMaybe"><span class="hs-identifier">varTToNameMaybe</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VarT</span><span> </span><a name="local-6989586621679151777"><a href="#local-6989586621679151777"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679151777"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1668"></a><span class="hs-identifier">varTToNameMaybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SigT</span><span> </span><a name="local-6989586621679151778"><a href="#local-6989586621679151778"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#varTToNameMaybe"><span class="hs-identifier hs-var">varTToNameMaybe</span></a><span> </span><a href="#local-6989586621679151778"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1669"></a><span class="hs-identifier">varTToNameMaybe</span><span> </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1670"></a><span>
</span><a name="line-1671"></a><span class="hs-comment">-- | Extract the Name from a type variable. If the argument Type is not a</span><span>
</span><a name="line-1672"></a><span class="hs-comment">-- type variable, throw an error.</span><span>
</span><a name="line-1673"></a><span class="hs-identifier">varTToName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-1674"></a><a name="varTToName"><a href="Data.Aeson.TH.html#varTToName"><span class="hs-identifier">varTToName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Not a type variable!&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.Aeson.TH.html#varTToNameMaybe"><span class="hs-identifier hs-var">varTToNameMaybe</span></a><span>
</span><a name="line-1675"></a><span>
</span><a name="line-1676"></a><span class="hs-identifier">interleave</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151290"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151290"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151290"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-1677"></a><a name="interleave"><a href="Data.Aeson.TH.html#interleave"><span class="hs-identifier">interleave</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679151779"><a href="#local-6989586621679151779"><span class="hs-identifier">a1</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151780"><a href="#local-6989586621679151780"><span class="hs-identifier">a1s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151781"><a href="#local-6989586621679151781"><span class="hs-identifier">a2</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151782"><a href="#local-6989586621679151782"><span class="hs-identifier">a2s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151779"><span class="hs-identifier hs-var">a1</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679151781"><span class="hs-identifier hs-var">a2</span></a><span class="hs-glyph">:</span><a href="Data.Aeson.TH.html#interleave"><span class="hs-identifier hs-var">interleave</span></a><span> </span><a href="#local-6989586621679151780"><span class="hs-identifier hs-var">a1s</span></a><span> </span><a href="#local-6989586621679151782"><span class="hs-identifier hs-var">a2s</span></a><span>
</span><a name="line-1678"></a><span class="hs-identifier">interleave</span><span> </span><span class="hs-identifier">_</span><span>        </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1679"></a><span>
</span><a name="line-1680"></a><span class="hs-comment">-- | Fully applies a type constructor to its type variables.</span><span>
</span><a name="line-1681"></a><span class="hs-identifier">applyTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-1682"></a><a name="applyTyCon"><a href="Data.Aeson.TH.html#applyTyCon"><span class="hs-identifier">applyTyCon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl'</span><span> </span><span class="hs-identifier hs-var">AppT</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">ConT</span><span>
</span><a name="line-1683"></a><span>
</span><a name="line-1684"></a><span class="hs-comment">-- | Is the given type a variable?</span><span>
</span><a name="line-1685"></a><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1686"></a><a name="isTyVar"><a href="Data.Aeson.TH.html#isTyVar"><span class="hs-identifier">isTyVar</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VarT</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1687"></a><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SigT</span><span> </span><a name="local-6989586621679151783"><a href="#local-6989586621679151783"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a><span> </span><a href="#local-6989586621679151783"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1688"></a><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1689"></a><span>
</span><a name="line-1690"></a><span class="hs-comment">-- | Is the given type a type family constructor (and not a data family constructor)?</span><span>
</span><a name="line-1691"></a><span class="hs-identifier">isTyFamily</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1692"></a><a name="isTyFamily"><a href="Data.Aeson.TH.html#isTyFamily"><span class="hs-identifier">isTyFamily</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ConT</span><span> </span><a name="local-6989586621679151784"><a href="#local-6989586621679151784"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1693"></a><span>    </span><a name="local-6989586621679151785"><a href="#local-6989586621679151785"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">reify</span><span> </span><a href="#local-6989586621679151784"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1694"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679151785"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1695"></a><span class="hs-cpp">#if MIN_VERSION_template_haskell(2,11,0)</span><span>
</span><a name="line-1696"></a><span>         </span><span class="hs-identifier hs-var">FamilyI</span><span> </span><span class="hs-identifier hs-var">OpenTypeFamilyD</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1697"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1698"></a><span>         </span><span class="hs-identifier">FamilyI</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FamilyD</span><span> </span><span class="hs-identifier">TypeFam</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">True</span><span>
</span><a name="line-1699"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1700"></a><span class="hs-cpp">#if MIN_VERSION_template_haskell(2,9,0)</span><span>
</span><a name="line-1701"></a><span>         </span><span class="hs-identifier hs-var">FamilyI</span><span> </span><span class="hs-identifier hs-var">ClosedTypeFamilyD</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1702"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1703"></a><span>         </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1704"></a><span class="hs-identifier">isTyFamily</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1705"></a><span>
</span><a name="line-1706"></a><span class="hs-comment">-- | Peel off a kind signature from a Type (if it has one).</span><span>
</span><a name="line-1707"></a><span class="hs-identifier">unSigT</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-1708"></a><a name="unSigT"><a href="Data.Aeson.TH.html#unSigT"><span class="hs-identifier">unSigT</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SigT</span><span> </span><a name="local-6989586621679151786"><a href="#local-6989586621679151786"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151786"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1709"></a><span class="hs-identifier">unSigT</span><span> </span><a name="local-6989586621679151787"><a href="#local-6989586621679151787"><span class="hs-identifier">t</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151787"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1710"></a><span>
</span><a name="line-1711"></a><span class="hs-comment">-- | Are all of the items in a list (which have an ordering) distinct?</span><span>
</span><a name="line-1712"></a><span class="hs-comment">--</span><span>
</span><a name="line-1713"></a><span class="hs-comment">-- This uses Set (as opposed to nub) for better asymptotic time complexity.</span><span>
</span><a name="line-1714"></a><span class="hs-identifier">allDistinct</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679151289"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151289"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1715"></a><a name="allDistinct"><a href="Data.Aeson.TH.html#allDistinct"><span class="hs-identifier">allDistinct</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151788"><span class="hs-identifier hs-var">allDistinct'</span></a><span> </span><span class="hs-identifier hs-var">Set</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span><span>
</span><a name="line-1716"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1717"></a><span>    </span><span class="hs-identifier">allDistinct'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679151789"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679151789"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151789"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1718"></a><span>    </span><a name="local-6989586621679151788"><a href="#local-6989586621679151788"><span class="hs-identifier">allDistinct'</span></a></a><span> </span><a name="local-6989586621679151790"><a href="#local-6989586621679151790"><span class="hs-identifier">uniqs</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679151791"><a href="#local-6989586621679151791"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151792"><a href="#local-6989586621679151792"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1719"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679151791"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">Set</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">member</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679151790"><span class="hs-identifier hs-var">uniqs</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1720"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151788"><span class="hs-identifier hs-var">allDistinct'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Set</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">insert</span><span> </span><a href="#local-6989586621679151791"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679151790"><span class="hs-identifier hs-var">uniqs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151792"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1721"></a><span>    </span><span class="hs-identifier">allDistinct'</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1722"></a><span>
</span><a name="line-1723"></a><span class="hs-comment">-- | Does the given type mention any of the Names in the list?</span><span>
</span><a name="line-1724"></a><span class="hs-identifier">mentionsName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1725"></a><a name="mentionsName"><a href="Data.Aeson.TH.html#mentionsName"><span class="hs-identifier">mentionsName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151793"><span class="hs-identifier hs-var">go</span></a><span>
</span><a name="line-1726"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1727"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1728"></a><span>    </span><a name="local-6989586621679151793"><a href="#local-6989586621679151793"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">AppT</span><span> </span><a name="local-6989586621679151794"><a href="#local-6989586621679151794"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679151795"><a href="#local-6989586621679151795"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679151796"><a href="#local-6989586621679151796"><span class="hs-identifier">names</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151793"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679151794"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679151796"><span class="hs-identifier hs-var">names</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679151793"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679151795"><span class="hs-identifier hs-var">t2</span></a><span> </span><a href="#local-6989586621679151796"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-1729"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SigT</span><span> </span><a name="local-6989586621679151797"><a href="#local-6989586621679151797"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679151798"><a href="#local-6989586621679151798"><span class="hs-identifier">_k</span></a></a><span class="hs-special">)</span><span>  </span><a name="local-6989586621679151799"><a href="#local-6989586621679151799"><span class="hs-identifier">names</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151793"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679151797"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679151799"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-1730"></a><span class="hs-cpp">#if MIN_VERSION_template_haskell(2,8,0)</span><span>
</span><a name="line-1731"></a><span>                              </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679151793"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679151798"><span class="hs-identifier hs-var">_k</span></a><span> </span><a href="#local-6989586621679151799"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-1732"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1733"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VarT</span><span> </span><a name="local-6989586621679151800"><a href="#local-6989586621679151800"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>     </span><a name="local-6989586621679151801"><a href="#local-6989586621679151801"><span class="hs-identifier">names</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151800"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679151801"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-1734"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span>            </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1735"></a><span>
</span><a name="line-1736"></a><span class="hs-comment">-- | Does an instance predicate mention any of the Names in the list?</span><span>
</span><a name="line-1737"></a><span class="hs-identifier">predMentionsName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Pred</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1738"></a><span class="hs-cpp">#if MIN_VERSION_template_haskell(2,10,0)</span><span>
</span><a name="line-1739"></a><a name="predMentionsName"><a href="Data.Aeson.TH.html#predMentionsName"><span class="hs-identifier">predMentionsName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#mentionsName"><span class="hs-identifier hs-var">mentionsName</span></a><span>
</span><a name="line-1740"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1741"></a><span class="hs-identifier">predMentionsName</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ClassP</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">names</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">elem</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">names</span><span> </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">any</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier">mentionsName</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">names</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">tys</span><span>
</span><a name="line-1742"></a><span class="hs-identifier">predMentionsName</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">EqualP</span><span> </span><span class="hs-identifier">t1</span><span> </span><span class="hs-identifier">t2</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">names</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mentionsName</span><span> </span><span class="hs-identifier">t1</span><span> </span><span class="hs-identifier">names</span><span> </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">mentionsName</span><span> </span><span class="hs-identifier">t2</span><span> </span><span class="hs-identifier">names</span><span>
</span><a name="line-1743"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1744"></a><span>
</span><a name="line-1745"></a><span class="hs-comment">-- | Split an applied type into its individual components. For example, this:</span><span>
</span><a name="line-1746"></a><span class="hs-comment">--</span><span>
</span><a name="line-1747"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-1748"></a><span class="hs-comment">-- Either Int Char</span><span>
</span><a name="line-1749"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-1750"></a><span class="hs-comment">--</span><span>
</span><a name="line-1751"></a><span class="hs-comment">-- would split to this:</span><span>
</span><a name="line-1752"></a><span class="hs-comment">--</span><span>
</span><a name="line-1753"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-1754"></a><span class="hs-comment">-- [Either, Int, Char]</span><span>
</span><a name="line-1755"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-1756"></a><span class="hs-identifier">unapplyTy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">NonEmpty</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-1757"></a><a name="unapplyTy"><a href="Data.Aeson.TH.html#unapplyTy"><span class="hs-identifier">unapplyTy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">NE</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679151802"><span class="hs-identifier hs-var">go</span></a><span>
</span><a name="line-1758"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1759"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">NonEmpty</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-1760"></a><span>    </span><a name="local-6989586621679151802"><a href="#local-6989586621679151802"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">AppT</span><span> </span><a name="local-6989586621679151803"><a href="#local-6989586621679151803"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679151804"><a href="#local-6989586621679151804"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151804"><span class="hs-identifier hs-var">t2</span></a><span> </span><span class="hs-operator hs-var">&lt;|</span><span> </span><a href="#local-6989586621679151802"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679151803"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-1761"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SigT</span><span> </span><a name="local-6989586621679151805"><a href="#local-6989586621679151805"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151802"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679151805"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1762"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ForallT</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679151806"><a href="#local-6989586621679151806"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151802"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679151806"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1763"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679151807"><a href="#local-6989586621679151807"><span class="hs-identifier">t</span></a></a><span>               </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151807"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">:|</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1764"></a><span>
</span><a name="line-1765"></a><span class="hs-comment">-- | Split a type signature by the arrows on its spine. For example, this:</span><span>
</span><a name="line-1766"></a><span class="hs-comment">--</span><span>
</span><a name="line-1767"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-1768"></a><span class="hs-comment">-- forall a b. (a ~ b) =&gt; (a -&gt; b) -&gt; Char -&gt; ()</span><span>
</span><a name="line-1769"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-1770"></a><span class="hs-comment">--</span><span>
</span><a name="line-1771"></a><span class="hs-comment">-- would split to this:</span><span>
</span><a name="line-1772"></a><span class="hs-comment">--</span><span>
</span><a name="line-1773"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-1774"></a><span class="hs-comment">-- (a ~ b, [a -&gt; b, Char, ()])</span><span>
</span><a name="line-1775"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-1776"></a><span class="hs-identifier">uncurryTy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Cxt</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">NonEmpty</span><span> </span><span class="hs-identifier hs-type">Type</span><span class="hs-special">)</span><span>
</span><a name="line-1777"></a><a name="uncurryTy"><a href="Data.Aeson.TH.html#uncurryTy"><span class="hs-identifier">uncurryTy</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">AppT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">AppT</span><span> </span><span class="hs-identifier hs-var">ArrowT</span><span> </span><a name="local-6989586621679151808"><a href="#local-6989586621679151808"><span class="hs-identifier">t1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679151809"><a href="#local-6989586621679151809"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1778"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151810"><a href="#local-6989586621679151810"><span class="hs-identifier">ctxt</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679151811"><a href="#local-6989586621679151811"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#uncurryTy"><span class="hs-identifier hs-var">uncurryTy</span></a><span> </span><a href="#local-6989586621679151809"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-1779"></a><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151810"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151808"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-operator hs-var">&lt;|</span><span> </span><a href="#local-6989586621679151811"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1780"></a><span class="hs-identifier">uncurryTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SigT</span><span> </span><a name="local-6989586621679151812"><a href="#local-6989586621679151812"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#uncurryTy"><span class="hs-identifier hs-var">uncurryTy</span></a><span> </span><a href="#local-6989586621679151812"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1781"></a><span class="hs-identifier">uncurryTy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ForallT</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679151813"><a href="#local-6989586621679151813"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621679151814"><a href="#local-6989586621679151814"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1782"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151815"><a href="#local-6989586621679151815"><span class="hs-identifier">ctxt'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679151816"><a href="#local-6989586621679151816"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#uncurryTy"><span class="hs-identifier hs-var">uncurryTy</span></a><span> </span><a href="#local-6989586621679151814"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1783"></a><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151813"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679151815"><span class="hs-identifier hs-var">ctxt'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151816"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1784"></a><span class="hs-identifier">uncurryTy</span><span> </span><a name="local-6989586621679151817"><a href="#local-6989586621679151817"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151817"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">:|</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1785"></a><span>
</span><a name="line-1786"></a><span class="hs-comment">-- | Like uncurryType, except on a kind level.</span><span>
</span><a name="line-1787"></a><span class="hs-identifier">uncurryKind</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Kind</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">NonEmpty</span><span> </span><span class="hs-identifier hs-type">Kind</span><span>
</span><a name="line-1788"></a><span class="hs-cpp">#if MIN_VERSION_template_haskell(2,8,0)</span><span>
</span><a name="line-1789"></a><a name="uncurryKind"><a href="Data.Aeson.TH.html#uncurryKind"><span class="hs-identifier">uncurryKind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.Aeson.TH.html#uncurryTy"><span class="hs-identifier hs-var">uncurryTy</span></a><span>
</span><a name="line-1790"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1791"></a><span class="hs-identifier">uncurryKind</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ArrowK</span><span> </span><span class="hs-identifier">k1</span><span> </span><span class="hs-identifier">k2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">k1</span><span> </span><span class="hs-operator">&lt;|</span><span> </span><span class="hs-identifier">uncurryKind</span><span> </span><span class="hs-identifier">k2</span><span>
</span><a name="line-1792"></a><span class="hs-identifier">uncurryKind</span><span> </span><span class="hs-identifier">k</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">k</span><span> </span><span class="hs-operator">:|</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1793"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1794"></a><span>
</span><a name="line-1795"></a><span class="hs-identifier">createKindChain</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Kind</span><span>
</span><a name="line-1796"></a><a name="createKindChain"><a href="Data.Aeson.TH.html#createKindChain"><span class="hs-identifier">createKindChain</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151818"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-identifier hs-var">starK</span><span>
</span><a name="line-1797"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1798"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Kind</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Kind</span><span>
</span><a name="line-1799"></a><span>    </span><a name="local-6989586621679151818"><a href="#local-6989586621679151818"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679151819"><a href="#local-6989586621679151819"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151819"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-1800"></a><span class="hs-cpp">#if MIN_VERSION_template_haskell(2,8,0)</span><span>
</span><a name="line-1801"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679151820"><a href="#local-6989586621679151820"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679151821"><a href="#local-6989586621679151821"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151818"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">AppT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">AppT</span><span> </span><span class="hs-identifier hs-var">ArrowT</span><span> </span><span class="hs-identifier hs-var">StarT</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151820"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151821"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-1802"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1803"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">k</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ArrowK</span><span> </span><span class="hs-identifier">StarK</span><span> </span><span class="hs-identifier">k</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-1804"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1805"></a><span>
</span><a name="line-1806"></a><span class="hs-comment">-- | Makes a string literal expression from a constructor's name.</span><span>
</span><a name="line-1807"></a><span class="hs-identifier">conNameExp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ConstructorInfo</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><span class="hs-identifier hs-type">Exp</span><span>
</span><a name="line-1808"></a><a name="conNameExp"><a href="Data.Aeson.TH.html#conNameExp"><span class="hs-identifier">conNameExp</span></a></a><span> </span><a name="local-6989586621679151822"><a href="#local-6989586621679151822"><span class="hs-identifier">opts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">litE</span><span>
</span><a name="line-1809"></a><span>                </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">stringL</span><span>
</span><a name="line-1810"></a><span>                </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">constructorTagModifier</span><span> </span><a href="#local-6989586621679151822"><span class="hs-identifier hs-var">opts</span></a><span>
</span><a name="line-1811"></a><span>                </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">nameBase</span><span>
</span><a name="line-1812"></a><span>                </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">constructorName</span><span>
</span><a name="line-1813"></a><span>
</span><a name="line-1814"></a><span class="hs-comment">-- | Extracts a record field label.</span><span>
</span><a name="line-1815"></a><span class="hs-identifier">fieldLabel</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.Types.Internal.html#Options"><span class="hs-identifier hs-type">Options</span></a><span> </span><span class="hs-comment">-- ^ Encoding options</span><span>
</span><a name="line-1816"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-1817"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-1818"></a><a name="fieldLabel"><a href="Data.Aeson.TH.html#fieldLabel"><span class="hs-identifier">fieldLabel</span></a></a><span> </span><a name="local-6989586621679151823"><a href="#local-6989586621679151823"><span class="hs-identifier">opts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fieldLabelModifier</span><span> </span><a href="#local-6989586621679151823"><span class="hs-identifier hs-var">opts</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">nameBase</span><span>
</span><a name="line-1819"></a><span>
</span><a name="line-1820"></a><span class="hs-comment">-- | The name of the outermost 'Value' constructor.</span><span>
</span><a name="line-1821"></a><span class="hs-identifier">valueConName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-1822"></a><a name="valueConName"><a href="Data.Aeson.TH.html#valueConName"><span class="hs-identifier">valueConName</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-var">Object</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Object&quot;</span><span>
</span><a name="line-1823"></a><span class="hs-identifier">valueConName</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.Types.Internal.html#Array"><span class="hs-identifier hs-var">Array</span></a><span>  </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Array&quot;</span><span>
</span><a name="line-1824"></a><span class="hs-identifier">valueConName</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.Types.Internal.html#String"><span class="hs-identifier hs-var">String</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;String&quot;</span><span>
</span><a name="line-1825"></a><span class="hs-identifier">valueConName</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.Types.Internal.html#Number"><span class="hs-identifier hs-var">Number</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Number&quot;</span><span>
</span><a name="line-1826"></a><span class="hs-identifier">valueConName</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.Types.Internal.html#Bool"><span class="hs-identifier hs-var">Bool</span></a><span>   </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Boolean&quot;</span><span>
</span><a name="line-1827"></a><span class="hs-identifier">valueConName</span><span> </span><a href="Data.Aeson.Types.Internal.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Null&quot;</span><span>
</span><a name="line-1828"></a><span>
</span><a name="line-1829"></a><span class="hs-identifier">applyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Pred</span><span>
</span><a name="line-1830"></a><a name="applyCon"><a href="Data.Aeson.TH.html#applyCon"><span class="hs-identifier">applyCon</span></a></a><span> </span><a name="local-6989586621679151824"><a href="#local-6989586621679151824"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-6989586621679151825"><a href="#local-6989586621679151825"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1831"></a><span class="hs-cpp">#if MIN_VERSION_template_haskell(2,10,0)</span><span>
</span><a name="line-1832"></a><span>          </span><span class="hs-identifier hs-var">AppT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ConT</span><span> </span><a href="#local-6989586621679151824"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VarT</span><span> </span><a href="#local-6989586621679151825"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-1833"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1834"></a><span>          </span><span class="hs-identifier">ClassP</span><span> </span><span class="hs-identifier">con</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">VarT</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">]</span><span>
</span><a name="line-1835"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1836"></a><span>
</span><a name="line-1837"></a><span class="hs-comment">-- | Checks to see if the last types in a data family instance can be safely eta-</span><span>
</span><a name="line-1838"></a><span class="hs-comment">-- reduced (i.e., dropped), given the other types. This checks for three conditions:</span><span>
</span><a name="line-1839"></a><span class="hs-comment">--</span><span>
</span><a name="line-1840"></a><span class="hs-comment">-- (1) All of the dropped types are type variables</span><span>
</span><a name="line-1841"></a><span class="hs-comment">-- (2) All of the dropped types are distinct</span><span>
</span><a name="line-1842"></a><span class="hs-comment">-- (3) None of the remaining types mention any of the dropped types</span><span>
</span><a name="line-1843"></a><span class="hs-identifier">canEtaReduce</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Type</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1844"></a><a name="canEtaReduce"><a href="Data.Aeson.TH.html#canEtaReduce"><span class="hs-identifier">canEtaReduce</span></a></a><span> </span><a name="local-6989586621679151826"><a href="#local-6989586621679151826"><span class="hs-identifier">remaining</span></a></a><span> </span><a name="local-6989586621679151827"><a href="#local-6989586621679151827"><span class="hs-identifier">dropped</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1845"></a><span>       </span><span class="hs-identifier hs-var">all</span><span> </span><a href="Data.Aeson.TH.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a><span> </span><a href="#local-6989586621679151827"><span class="hs-identifier hs-var">dropped</span></a><span>
</span><a name="line-1846"></a><span>    </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Data.Aeson.TH.html#allDistinct"><span class="hs-identifier hs-var">allDistinct</span></a><span> </span><a href="#local-6989586621679151828"><span class="hs-identifier hs-var">droppedNames</span></a><span> </span><span class="hs-comment">-- Make sure not to pass something of type [Type], since Type</span><span>
</span><a name="line-1847"></a><span>                                </span><span class="hs-comment">-- didn't have an Ord instance until template-haskell-2.10.0.0</span><span>
</span><a name="line-1848"></a><span>    </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="Data.Aeson.TH.html#mentionsName"><span class="hs-identifier hs-var">mentionsName</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679151828"><span class="hs-identifier hs-var">droppedNames</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151826"><span class="hs-identifier hs-var">remaining</span></a><span class="hs-special">)</span><span>
</span><a name="line-1849"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1850"></a><span>    </span><span class="hs-identifier">droppedNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">]</span><span>
</span><a name="line-1851"></a><span>    </span><a name="local-6989586621679151828"><a href="#local-6989586621679151828"><span class="hs-identifier">droppedNames</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Data.Aeson.TH.html#varTToName"><span class="hs-identifier hs-var">varTToName</span></a><span> </span><a href="#local-6989586621679151827"><span class="hs-identifier hs-var">dropped</span></a><span>
</span><a name="line-1852"></a><span>
</span><a name="line-1853"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-1854"></a><span class="hs-comment">-- Expanding type synonyms</span><span>
</span><a name="line-1855"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-1856"></a><span>
</span><a name="line-1857"></a><span class="hs-identifier">applySubstitutionKind</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-identifier hs-type">Kind</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-1858"></a><span class="hs-cpp">#if MIN_VERSION_template_haskell(2,8,0)</span><span>
</span><a name="line-1859"></a><a name="applySubstitutionKind"><a href="Data.Aeson.TH.html#applySubstitutionKind"><span class="hs-identifier">applySubstitutionKind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">applySubstitution</span><span>
</span><a name="line-1860"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1861"></a><span class="hs-identifier">applySubstitutionKind</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">t</span><span>
</span><a name="line-1862"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1863"></a><span>
</span><a name="line-1864"></a><span class="hs-identifier">substNameWithKind</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Kind</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-1865"></a><a name="substNameWithKind"><a href="Data.Aeson.TH.html#substNameWithKind"><span class="hs-identifier">substNameWithKind</span></a></a><span> </span><a name="local-6989586621679151829"><a href="#local-6989586621679151829"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679151830"><a href="#local-6989586621679151830"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#applySubstitutionKind"><span class="hs-identifier hs-var">applySubstitutionKind</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">singleton</span><span> </span><a href="#local-6989586621679151829"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679151830"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span>
</span><a name="line-1866"></a><span>
</span><a name="line-1867"></a><span class="hs-identifier">substNamesWithKindStar</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span>
</span><a name="line-1868"></a><a name="substNamesWithKindStar"><a href="Data.Aeson.TH.html#substNamesWithKindStar"><span class="hs-identifier">substNamesWithKindStar</span></a></a><span> </span><a name="local-6989586621679151831"><a href="#local-6989586621679151831"><span class="hs-identifier">ns</span></a></a><span> </span><a name="local-6989586621679151832"><a href="#local-6989586621679151832"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr'</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="Data.Aeson.TH.html#substNameWithKind"><span class="hs-identifier hs-var">substNameWithKind</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">starK</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151832"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679151831"><span class="hs-identifier hs-var">ns</span></a><span>
</span><a name="line-1869"></a><span>
</span><a name="line-1870"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-1871"></a><span class="hs-comment">-- Error messages</span><span>
</span><a name="line-1872"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-1873"></a><span>
</span><a name="line-1874"></a><span class="hs-comment">-- | Either the given data type doesn't have enough type variables, or one of</span><span>
</span><a name="line-1875"></a><span class="hs-comment">-- the type variables to be eta-reduced cannot realize kind *.</span><span>
</span><a name="line-1876"></a><span class="hs-identifier">derivingKindError</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><a href="#local-6989586621679151288"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1877"></a><a name="derivingKindError"><a href="Data.Aeson.TH.html#derivingKindError"><span class="hs-identifier">derivingKindError</span></a></a><span> </span><a name="local-6989586621679151833"><a href="#local-6989586621679151833"><span class="hs-identifier">jc</span></a></a><span> </span><a name="local-6989586621679151834"><a href="#local-6989586621679151834"><span class="hs-identifier">tyConName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fail</span><span>
</span><a name="line-1878"></a><span>  </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;Cannot derive well-kinded instance of form &#8216;&quot;</span><span>
</span><a name="line-1879"></a><span>  </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><a href="#local-6989586621679151835"><span class="hs-identifier hs-var">className</span></a><span>
</span><a name="line-1880"></a><span>  </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showChar</span><span> </span><span class="hs-char">' '</span><span>
</span><a name="line-1881"></a><span>  </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showParen</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1882"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">nameBase</span><span> </span><a href="#local-6989586621679151834"><span class="hs-identifier hs-var">tyConName</span></a><span class="hs-special">)</span><span>
</span><a name="line-1883"></a><span>    </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot; ...&quot;</span><span>
</span><a name="line-1884"></a><span>    </span><span class="hs-special">)</span><span>
</span><a name="line-1885"></a><span>  </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;&#8216;\n\tClass &quot;</span><span>
</span><a name="line-1886"></a><span>  </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><a href="#local-6989586621679151835"><span class="hs-identifier hs-var">className</span></a><span>
</span><a name="line-1887"></a><span>  </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot; expects an argument of kind &quot;</span><span>
</span><a name="line-1888"></a><span>  </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pprint</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.Aeson.TH.html#createKindChain"><span class="hs-identifier hs-var">createKindChain</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Aeson.TH.html#arityInt"><span class="hs-identifier hs-var">arityInt</span></a><span> </span><a href="#local-6989586621679151833"><span class="hs-identifier hs-var">jc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1889"></a><span>  </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-1890"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1891"></a><span>    </span><span class="hs-identifier">className</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-1892"></a><span>    </span><a name="local-6989586621679151835"><a href="#local-6989586621679151835"><span class="hs-identifier">className</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">nameBase</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Aeson.TH.html#jsonClassName"><span class="hs-identifier hs-var">jsonClassName</span></a><span> </span><a href="#local-6989586621679151833"><span class="hs-identifier hs-var">jc</span></a><span>
</span><a name="line-1893"></a><span>
</span><a name="line-1894"></a><span class="hs-comment">-- | One of the last type variables cannot be eta-reduced (see the canEtaReduce</span><span>
</span><a name="line-1895"></a><span class="hs-comment">-- function for the criteria it would have to meet).</span><span>
</span><a name="line-1896"></a><span class="hs-identifier">etaReductionError</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><a href="#local-6989586621679151287"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1897"></a><a name="etaReductionError"><a href="Data.Aeson.TH.html#etaReductionError"><span class="hs-identifier">etaReductionError</span></a></a><span> </span><a name="local-6989586621679152726"><a href="#local-6989586621679152726"><span class="hs-identifier">instanceType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1898"></a><span>    </span><span class="hs-string">&quot;Cannot eta-reduce to an instance of form \n\tinstance (...) =&gt; &quot;</span><span>
</span><a name="line-1899"></a><span>    </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">pprint</span><span> </span><a href="#local-6989586621679152726"><span class="hs-identifier hs-var">instanceType</span></a><span>
</span><a name="line-1900"></a><span>
</span><a name="line-1901"></a><span class="hs-comment">-- | The data type has a DatatypeContext which mentions one of the eta-reduced</span><span>
</span><a name="line-1902"></a><span class="hs-comment">-- type variables.</span><span>
</span><a name="line-1903"></a><span class="hs-identifier">datatypeContextError</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Q</span><span> </span><a href="#local-6989586621679151286"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1904"></a><a name="datatypeContextError"><a href="Data.Aeson.TH.html#datatypeContextError"><span class="hs-identifier">datatypeContextError</span></a></a><span> </span><a name="local-6989586621679152727"><a href="#local-6989586621679152727"><span class="hs-identifier">dataName</span></a></a><span> </span><a name="local-6989586621679152728"><a href="#local-6989586621679152728"><span class="hs-identifier">instanceType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fail</span><span>
</span><a name="line-1905"></a><span>    </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;Can't make a derived instance of &#8216;&quot;</span><span>
</span><a name="line-1906"></a><span>    </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pprint</span><span> </span><a href="#local-6989586621679152728"><span class="hs-identifier hs-var">instanceType</span></a><span class="hs-special">)</span><span>
</span><a name="line-1907"></a><span>    </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;&#8216;:\n\tData type &#8216;&quot;</span><span>
</span><a name="line-1908"></a><span>    </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">nameBase</span><span> </span><a href="#local-6989586621679152727"><span class="hs-identifier hs-var">dataName</span></a><span class="hs-special">)</span><span>
</span><a name="line-1909"></a><span>    </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;&#8216; must not have a class context involving the last type argument(s)&quot;</span><span>
</span><a name="line-1910"></a><span>    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-1911"></a><span>
</span><a name="line-1912"></a><span class="hs-comment">-- | The data type mentions one of the n eta-reduced type variables in a place other</span><span>
</span><a name="line-1913"></a><span class="hs-comment">-- than the last nth positions of a data type in a constructor's field.</span><span>
</span><a name="line-1914"></a><span class="hs-identifier">outOfPlaceTyVarError</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151285"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1915"></a><a name="outOfPlaceTyVarError"><a href="Data.Aeson.TH.html#outOfPlaceTyVarError"><span class="hs-identifier">outOfPlaceTyVarError</span></a></a><span> </span><a name="local-6989586621679152729"><a href="#local-6989586621679152729"><span class="hs-identifier">jc</span></a></a><span> </span><a name="local-6989586621679152730"><a href="#local-6989586621679152730"><span class="hs-identifier">conName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span>
</span><a name="line-1916"></a><span>    </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;Constructor &#8216;&quot;</span><span>
</span><a name="line-1917"></a><span>    </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">nameBase</span><span> </span><a href="#local-6989586621679152730"><span class="hs-identifier hs-var">conName</span></a><span class="hs-special">)</span><span>
</span><a name="line-1918"></a><span>    </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;&#8216; must only use its last &quot;</span><span>
</span><a name="line-1919"></a><span>    </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">shows</span><span> </span><a href="#local-6989586621679152731"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1920"></a><span>    </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot; type variable(s) within the last &quot;</span><span>
</span><a name="line-1921"></a><span>    </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">shows</span><span> </span><a href="#local-6989586621679152731"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1922"></a><span>    </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot; argument(s) of a data type&quot;</span><span>
</span><a name="line-1923"></a><span>    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-1924"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1925"></a><span>    </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-1926"></a><span>    </span><a name="local-6989586621679152731"><a href="#local-6989586621679152731"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#arityInt"><span class="hs-identifier hs-var">arityInt</span></a><span> </span><a href="#local-6989586621679152729"><span class="hs-identifier hs-var">jc</span></a><span>
</span><a name="line-1927"></a><span>
</span><a name="line-1928"></a><span class="hs-comment">-- | The data type has an existential constraint which mentions one of the</span><span>
</span><a name="line-1929"></a><span class="hs-comment">-- eta-reduced type variables.</span><span>
</span><a name="line-1930"></a><span class="hs-identifier">existentialContextError</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151284"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1931"></a><a name="existentialContextError"><a href="Data.Aeson.TH.html#existentialContextError"><span class="hs-identifier">existentialContextError</span></a></a><span> </span><a name="local-6989586621679152732"><a href="#local-6989586621679152732"><span class="hs-identifier">conName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span>
</span><a name="line-1932"></a><span>  </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;Constructor &#8216;&quot;</span><span>
</span><a name="line-1933"></a><span>  </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">nameBase</span><span> </span><a href="#local-6989586621679152732"><span class="hs-identifier hs-var">conName</span></a><span class="hs-special">)</span><span>
</span><a name="line-1934"></a><span>  </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;&#8216; must be truly polymorphic in the last argument(s) of the data type&quot;</span><span>
</span><a name="line-1935"></a><span>  </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-1936"></a><span>
</span><a name="line-1937"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-1938"></a><span class="hs-comment">-- Class-specific constants</span><span>
</span><a name="line-1939"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-1940"></a><span>
</span><a name="line-1941"></a><span class="hs-comment">-- | A representation of the arity of the ToJSON/FromJSON typeclass being derived.</span><span>
</span><a name="line-1942"></a><span class="hs-keyword">data</span><span> </span><a name="Arity"><a href="Data.Aeson.TH.html#Arity"><span class="hs-identifier">Arity</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Arity0"><a href="Data.Aeson.TH.html#Arity0"><span class="hs-identifier">Arity0</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Arity1"><a href="Data.Aeson.TH.html#Arity1"><span class="hs-identifier">Arity1</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Arity2"><a href="Data.Aeson.TH.html#Arity2"><span class="hs-identifier">Arity2</span></a></a><span>
</span><a name="line-1943"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-1944"></a><span>
</span><a name="line-1945"></a><span class="hs-comment">-- | Whether ToJSON(1)(2) or FromJSON(1)(2) is being derived.</span><span>
</span><a name="line-1946"></a><span class="hs-keyword">data</span><span> </span><a name="Direction"><a href="Data.Aeson.TH.html#Direction"><span class="hs-identifier">Direction</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="To"><a href="Data.Aeson.TH.html#To"><span class="hs-identifier">To</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="From"><a href="Data.Aeson.TH.html#From"><span class="hs-identifier">From</span></a></a><span>
</span><a name="line-1947"></a><span>
</span><a name="line-1948"></a><span class="hs-comment">-- | A representation of which typeclass method is being spliced in.</span><span>
</span><a name="line-1949"></a><span class="hs-keyword">data</span><span> </span><a name="JSONFun"><a href="Data.Aeson.TH.html#JSONFun"><span class="hs-identifier">JSONFun</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ToJSON"><a href="Data.Aeson.TH.html#ToJSON"><span class="hs-identifier">ToJSON</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ToEncoding"><a href="Data.Aeson.TH.html#ToEncoding"><span class="hs-identifier">ToEncoding</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ParseJSON"><a href="Data.Aeson.TH.html#ParseJSON"><span class="hs-identifier">ParseJSON</span></a></a><span>
</span><a name="line-1950"></a><span>
</span><a name="line-1951"></a><span class="hs-comment">-- | A refinement of JSONFun to [ToJSON, ToEncoding].</span><span>
</span><a name="line-1952"></a><span class="hs-keyword">data</span><span> </span><a name="ToJSONFun"><a href="Data.Aeson.TH.html#ToJSONFun"><span class="hs-identifier">ToJSONFun</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Value"><a href="Data.Aeson.TH.html#Value"><span class="hs-identifier">Value</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Encoding"><a href="Data.Aeson.TH.html#Encoding"><span class="hs-identifier">Encoding</span></a></a><span>
</span><a name="line-1953"></a><span>
</span><a name="line-1954"></a><span class="hs-identifier">targetToJSONFun</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#ToJSONFun"><span class="hs-identifier hs-type">ToJSONFun</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#JSONFun"><span class="hs-identifier hs-type">JSONFun</span></a><span>
</span><a name="line-1955"></a><a name="targetToJSONFun"><a href="Data.Aeson.TH.html#targetToJSONFun"><span class="hs-identifier">targetToJSONFun</span></a></a><span> </span><a href="Data.Aeson.TH.html#Value"><span class="hs-identifier hs-var">Value</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#ToJSON"><span class="hs-identifier hs-var">ToJSON</span></a><span>
</span><a name="line-1956"></a><span class="hs-identifier">targetToJSONFun</span><span> </span><a href="Data.Aeson.TH.html#Encoding"><span class="hs-identifier hs-var">Encoding</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#ToEncoding"><span class="hs-identifier hs-var">ToEncoding</span></a><span>
</span><a name="line-1957"></a><span>
</span><a name="line-1958"></a><span class="hs-comment">-- | A representation of which typeclass is being derived.</span><span>
</span><a name="line-1959"></a><span class="hs-keyword">data</span><span> </span><a name="JSONClass"><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier">JSONClass</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="JSONClass"><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier">JSONClass</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="direction"><a href="Data.Aeson.TH.html#direction"><span class="hs-identifier">direction</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#Direction"><span class="hs-identifier hs-type">Direction</span></a><span class="hs-special">,</span><span> </span><a name="arity"><a href="Data.Aeson.TH.html#arity"><span class="hs-identifier">arity</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1960"></a><span>
</span><a name="line-1961"></a><span class="hs-identifier">toJSONClass</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">toJSON1Class</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">toJSON2Class</span><span class="hs-special">,</span><span>
</span><a name="line-1962"></a><span>    </span><span class="hs-identifier">fromJSONClass</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fromJSON1Class</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fromJSON2Class</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span>
</span><a name="line-1963"></a><a name="toJSONClass"><a href="Data.Aeson.TH.html#toJSONClass"><span class="hs-identifier">toJSONClass</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-var">JSONClass</span></a><span> </span><a href="Data.Aeson.TH.html#To"><span class="hs-identifier hs-var">To</span></a><span>   </span><a href="Data.Aeson.TH.html#Arity0"><span class="hs-identifier hs-var">Arity0</span></a><span>
</span><a name="line-1964"></a><a name="toJSON1Class"><a href="Data.Aeson.TH.html#toJSON1Class"><span class="hs-identifier">toJSON1Class</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-var">JSONClass</span></a><span> </span><a href="Data.Aeson.TH.html#To"><span class="hs-identifier hs-var">To</span></a><span>   </span><a href="Data.Aeson.TH.html#Arity1"><span class="hs-identifier hs-var">Arity1</span></a><span>
</span><a name="line-1965"></a><a name="toJSON2Class"><a href="Data.Aeson.TH.html#toJSON2Class"><span class="hs-identifier">toJSON2Class</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-var">JSONClass</span></a><span> </span><a href="Data.Aeson.TH.html#To"><span class="hs-identifier hs-var">To</span></a><span>   </span><a href="Data.Aeson.TH.html#Arity2"><span class="hs-identifier hs-var">Arity2</span></a><span>
</span><a name="line-1966"></a><a name="fromJSONClass"><a href="Data.Aeson.TH.html#fromJSONClass"><span class="hs-identifier">fromJSONClass</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-var">JSONClass</span></a><span> </span><a href="Data.Aeson.TH.html#From"><span class="hs-identifier hs-var">From</span></a><span> </span><a href="Data.Aeson.TH.html#Arity0"><span class="hs-identifier hs-var">Arity0</span></a><span>
</span><a name="line-1967"></a><a name="fromJSON1Class"><a href="Data.Aeson.TH.html#fromJSON1Class"><span class="hs-identifier">fromJSON1Class</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-var">JSONClass</span></a><span> </span><a href="Data.Aeson.TH.html#From"><span class="hs-identifier hs-var">From</span></a><span> </span><a href="Data.Aeson.TH.html#Arity1"><span class="hs-identifier hs-var">Arity1</span></a><span>
</span><a name="line-1968"></a><a name="fromJSON2Class"><a href="Data.Aeson.TH.html#fromJSON2Class"><span class="hs-identifier">fromJSON2Class</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-var">JSONClass</span></a><span> </span><a href="Data.Aeson.TH.html#From"><span class="hs-identifier hs-var">From</span></a><span> </span><a href="Data.Aeson.TH.html#Arity2"><span class="hs-identifier hs-var">Arity2</span></a><span>
</span><a name="line-1969"></a><span>
</span><a name="line-1970"></a><span class="hs-identifier">jsonClassName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-1971"></a><a name="jsonClassName"><a href="Data.Aeson.TH.html#jsonClassName"><span class="hs-identifier">jsonClassName</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-var">JSONClass</span></a><span> </span><a href="Data.Aeson.TH.html#To"><span class="hs-identifier hs-var">To</span></a><span>   </span><a href="Data.Aeson.TH.html#Arity0"><span class="hs-identifier hs-var">Arity0</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">ToJSON</span><span>
</span><a name="line-1972"></a><span class="hs-identifier">jsonClassName</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-var">JSONClass</span></a><span> </span><a href="Data.Aeson.TH.html#To"><span class="hs-identifier hs-var">To</span></a><span>   </span><a href="Data.Aeson.TH.html#Arity1"><span class="hs-identifier hs-var">Arity1</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">ToJSON1</span><span>
</span><a name="line-1973"></a><span class="hs-identifier">jsonClassName</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-var">JSONClass</span></a><span> </span><a href="Data.Aeson.TH.html#To"><span class="hs-identifier hs-var">To</span></a><span>   </span><a href="Data.Aeson.TH.html#Arity2"><span class="hs-identifier hs-var">Arity2</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">ToJSON2</span><span>
</span><a name="line-1974"></a><span class="hs-identifier">jsonClassName</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-var">JSONClass</span></a><span> </span><a href="Data.Aeson.TH.html#From"><span class="hs-identifier hs-var">From</span></a><span> </span><a href="Data.Aeson.TH.html#Arity0"><span class="hs-identifier hs-var">Arity0</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">FromJSON</span><span>
</span><a name="line-1975"></a><span class="hs-identifier">jsonClassName</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-var">JSONClass</span></a><span> </span><a href="Data.Aeson.TH.html#From"><span class="hs-identifier hs-var">From</span></a><span> </span><a href="Data.Aeson.TH.html#Arity1"><span class="hs-identifier hs-var">Arity1</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">FromJSON1</span><span>
</span><a name="line-1976"></a><span class="hs-identifier">jsonClassName</span><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-var">JSONClass</span></a><span> </span><a href="Data.Aeson.TH.html#From"><span class="hs-identifier hs-var">From</span></a><span> </span><a href="Data.Aeson.TH.html#Arity2"><span class="hs-identifier hs-var">Arity2</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">FromJSON2</span><span>
</span><a name="line-1977"></a><span>
</span><a name="line-1978"></a><span class="hs-identifier">jsonFunValName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#JSONFun"><span class="hs-identifier hs-type">JSONFun</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-1979"></a><a name="jsonFunValName"><a href="Data.Aeson.TH.html#jsonFunValName"><span class="hs-identifier">jsonFunValName</span></a></a><span> </span><a href="Data.Aeson.TH.html#ToJSON"><span class="hs-identifier hs-var">ToJSON</span></a><span>     </span><a href="Data.Aeson.TH.html#Arity0"><span class="hs-identifier hs-var">Arity0</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">toJSON</span><span>
</span><a name="line-1980"></a><span class="hs-identifier">jsonFunValName</span><span> </span><a href="Data.Aeson.TH.html#ToJSON"><span class="hs-identifier hs-var">ToJSON</span></a><span>     </span><a href="Data.Aeson.TH.html#Arity1"><span class="hs-identifier hs-var">Arity1</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">liftToJSON</span><span>
</span><a name="line-1981"></a><span class="hs-identifier">jsonFunValName</span><span> </span><a href="Data.Aeson.TH.html#ToJSON"><span class="hs-identifier hs-var">ToJSON</span></a><span>     </span><a href="Data.Aeson.TH.html#Arity2"><span class="hs-identifier hs-var">Arity2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">liftToJSON2</span><span>
</span><a name="line-1982"></a><span class="hs-identifier">jsonFunValName</span><span> </span><a href="Data.Aeson.TH.html#ToEncoding"><span class="hs-identifier hs-var">ToEncoding</span></a><span> </span><a href="Data.Aeson.TH.html#Arity0"><span class="hs-identifier hs-var">Arity0</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">toEncoding</span><span>
</span><a name="line-1983"></a><span class="hs-identifier">jsonFunValName</span><span> </span><a href="Data.Aeson.TH.html#ToEncoding"><span class="hs-identifier hs-var">ToEncoding</span></a><span> </span><a href="Data.Aeson.TH.html#Arity1"><span class="hs-identifier hs-var">Arity1</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">liftToEncoding</span><span>
</span><a name="line-1984"></a><span class="hs-identifier">jsonFunValName</span><span> </span><a href="Data.Aeson.TH.html#ToEncoding"><span class="hs-identifier hs-var">ToEncoding</span></a><span> </span><a href="Data.Aeson.TH.html#Arity2"><span class="hs-identifier hs-var">Arity2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">liftToEncoding2</span><span>
</span><a name="line-1985"></a><span class="hs-identifier">jsonFunValName</span><span> </span><a href="Data.Aeson.TH.html#ParseJSON"><span class="hs-identifier hs-var">ParseJSON</span></a><span>  </span><a href="Data.Aeson.TH.html#Arity0"><span class="hs-identifier hs-var">Arity0</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">parseJSON</span><span>
</span><a name="line-1986"></a><span class="hs-identifier">jsonFunValName</span><span> </span><a href="Data.Aeson.TH.html#ParseJSON"><span class="hs-identifier hs-var">ParseJSON</span></a><span>  </span><a href="Data.Aeson.TH.html#Arity1"><span class="hs-identifier hs-var">Arity1</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">liftParseJSON</span><span>
</span><a name="line-1987"></a><span class="hs-identifier">jsonFunValName</span><span> </span><a href="Data.Aeson.TH.html#ParseJSON"><span class="hs-identifier hs-var">ParseJSON</span></a><span>  </span><a href="Data.Aeson.TH.html#Arity2"><span class="hs-identifier hs-var">Arity2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">liftParseJSON2</span><span>
</span><a name="line-1988"></a><span>
</span><a name="line-1989"></a><span class="hs-identifier">jsonFunListName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#JSONFun"><span class="hs-identifier hs-type">JSONFun</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-1990"></a><a name="jsonFunListName"><a href="Data.Aeson.TH.html#jsonFunListName"><span class="hs-identifier">jsonFunListName</span></a></a><span> </span><a href="Data.Aeson.TH.html#ToJSON"><span class="hs-identifier hs-var">ToJSON</span></a><span>     </span><a href="Data.Aeson.TH.html#Arity0"><span class="hs-identifier hs-var">Arity0</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">toJSONList</span><span>
</span><a name="line-1991"></a><span class="hs-identifier">jsonFunListName</span><span> </span><a href="Data.Aeson.TH.html#ToJSON"><span class="hs-identifier hs-var">ToJSON</span></a><span>     </span><a href="Data.Aeson.TH.html#Arity1"><span class="hs-identifier hs-var">Arity1</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">liftToJSONList</span><span>
</span><a name="line-1992"></a><span class="hs-identifier">jsonFunListName</span><span> </span><a href="Data.Aeson.TH.html#ToJSON"><span class="hs-identifier hs-var">ToJSON</span></a><span>     </span><a href="Data.Aeson.TH.html#Arity2"><span class="hs-identifier hs-var">Arity2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">liftToJSONList2</span><span>
</span><a name="line-1993"></a><span class="hs-identifier">jsonFunListName</span><span> </span><a href="Data.Aeson.TH.html#ToEncoding"><span class="hs-identifier hs-var">ToEncoding</span></a><span> </span><a href="Data.Aeson.TH.html#Arity0"><span class="hs-identifier hs-var">Arity0</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">toEncodingList</span><span>
</span><a name="line-1994"></a><span class="hs-identifier">jsonFunListName</span><span> </span><a href="Data.Aeson.TH.html#ToEncoding"><span class="hs-identifier hs-var">ToEncoding</span></a><span> </span><a href="Data.Aeson.TH.html#Arity1"><span class="hs-identifier hs-var">Arity1</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">liftToEncodingList</span><span>
</span><a name="line-1995"></a><span class="hs-identifier">jsonFunListName</span><span> </span><a href="Data.Aeson.TH.html#ToEncoding"><span class="hs-identifier hs-var">ToEncoding</span></a><span> </span><a href="Data.Aeson.TH.html#Arity2"><span class="hs-identifier hs-var">Arity2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">liftToEncodingList2</span><span>
</span><a name="line-1996"></a><span class="hs-identifier">jsonFunListName</span><span> </span><a href="Data.Aeson.TH.html#ParseJSON"><span class="hs-identifier hs-var">ParseJSON</span></a><span>  </span><a href="Data.Aeson.TH.html#Arity0"><span class="hs-identifier hs-var">Arity0</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">parseJSONList</span><span>
</span><a name="line-1997"></a><span class="hs-identifier">jsonFunListName</span><span> </span><a href="Data.Aeson.TH.html#ParseJSON"><span class="hs-identifier hs-var">ParseJSON</span></a><span>  </span><a href="Data.Aeson.TH.html#Arity1"><span class="hs-identifier hs-var">Arity1</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">liftParseJSONList</span><span>
</span><a name="line-1998"></a><span class="hs-identifier">jsonFunListName</span><span> </span><a href="Data.Aeson.TH.html#ParseJSON"><span class="hs-identifier hs-var">ParseJSON</span></a><span>  </span><a href="Data.Aeson.TH.html#Arity2"><span class="hs-identifier hs-var">Arity2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">liftParseJSONList2</span><span>
</span><a name="line-1999"></a><span>
</span><a name="line-2000"></a><span class="hs-identifier">jsonFunValOrListName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-comment">-- e.g., toJSONList if True, toJSON if False</span><span>
</span><a name="line-2001"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#JSONFun"><span class="hs-identifier hs-type">JSONFun</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-2002"></a><a name="jsonFunValOrListName"><a href="Data.Aeson.TH.html#jsonFunValOrListName"><span class="hs-identifier">jsonFunValOrListName</span></a></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#jsonFunValName"><span class="hs-identifier hs-var">jsonFunValName</span></a><span>
</span><a name="line-2003"></a><span class="hs-identifier">jsonFunValOrListName</span><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeson.TH.html#jsonFunListName"><span class="hs-identifier hs-var">jsonFunListName</span></a><span>
</span><a name="line-2004"></a><span>
</span><a name="line-2005"></a><span class="hs-identifier">arityInt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-2006"></a><a name="arityInt"><a href="Data.Aeson.TH.html#arityInt"><span class="hs-identifier">arityInt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromEnum</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">arity</span><span>
</span><a name="line-2007"></a><span>
</span><a name="line-2008"></a><span class="hs-identifier">allowExQuant</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-type">JSONClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2009"></a><a name="allowExQuant"><a href="Data.Aeson.TH.html#allowExQuant"><span class="hs-identifier">allowExQuant</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#JSONClass"><span class="hs-identifier hs-var">JSONClass</span></a><span> </span><a href="Data.Aeson.TH.html#To"><span class="hs-identifier hs-var">To</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2010"></a><span class="hs-identifier">allowExQuant</span><span> </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2011"></a><span>
</span><a name="line-2012"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-2013"></a><span class="hs-comment">-- StarKindStatus</span><span>
</span><a name="line-2014"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-2015"></a><span>
</span><a name="line-2016"></a><span class="hs-comment">-- | Whether a type is not of kind *, is of kind *, or is a kind variable.</span><span>
</span><a name="line-2017"></a><span class="hs-keyword">data</span><span> </span><a name="StarKindStatus"><a href="Data.Aeson.TH.html#StarKindStatus"><span class="hs-identifier">StarKindStatus</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="NotKindStar"><a href="Data.Aeson.TH.html#NotKindStar"><span class="hs-identifier">NotKindStar</span></a></a><span>
</span><a name="line-2018"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a name="KindStar"><a href="Data.Aeson.TH.html#KindStar"><span class="hs-identifier">KindStar</span></a></a><span>
</span><a name="line-2019"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a name="IsKindVar"><a href="Data.Aeson.TH.html#IsKindVar"><span class="hs-identifier">IsKindVar</span></a></a><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-2020"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier hs-type">Eq</span><span>
</span><a name="line-2021"></a><span>
</span><a name="line-2022"></a><span class="hs-comment">-- | Does a Type have kind * or k (for some kind variable k)?</span><span>
</span><a name="line-2023"></a><span class="hs-identifier">canRealizeKindStar</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#StarKindStatus"><span class="hs-identifier hs-type">StarKindStatus</span></a><span>
</span><a name="line-2024"></a><a name="canRealizeKindStar"><a href="Data.Aeson.TH.html#canRealizeKindStar"><span class="hs-identifier">canRealizeKindStar</span></a></a><span> </span><a name="local-6989586621679152733"><a href="#local-6989586621679152733"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679152733"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2025"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="Data.Aeson.TH.html#hasKindStar"><span class="hs-identifier hs-var">hasKindStar</span></a><span> </span><a href="#local-6989586621679152733"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#KindStar"><span class="hs-identifier hs-var">KindStar</span></a><span>
</span><a name="line-2026"></a><span class="hs-cpp">#if MIN_VERSION_template_haskell(2,8,0)</span><span>
</span><a name="line-2027"></a><span>    </span><span class="hs-identifier hs-var">SigT</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">VarT</span><span> </span><a name="local-6989586621679152734"><a href="#local-6989586621679152734"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#IsKindVar"><span class="hs-identifier hs-var">IsKindVar</span></a><span> </span><a href="#local-6989586621679152734"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-2028"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-2029"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeson.TH.html#NotKindStar"><span class="hs-identifier hs-var">NotKindStar</span></a><span>
</span><a name="line-2030"></a><span>
</span><a name="line-2031"></a><span class="hs-comment">-- | Returns 'Just' the kind variable 'Name' of a 'StarKindStatus' if it exists.</span><span>
</span><a name="line-2032"></a><span class="hs-comment">-- Otherwise, returns 'Nothing'.</span><span>
</span><a name="line-2033"></a><span class="hs-identifier">starKindStatusToName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeson.TH.html#StarKindStatus"><span class="hs-identifier hs-type">StarKindStatus</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Name</span><span>
</span><a name="line-2034"></a><a name="starKindStatusToName"><a href="Data.Aeson.TH.html#starKindStatusToName"><span class="hs-identifier">starKindStatusToName</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Aeson.TH.html#IsKindVar"><span class="hs-identifier hs-var">IsKindVar</span></a><span> </span><a name="local-6989586621679152735"><a href="#local-6989586621679152735"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679152735"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2035"></a><span class="hs-identifier">starKindStatusToName</span><span> </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2036"></a><span>
</span><a name="line-2037"></a><span class="hs-comment">-- | Concat together all of the StarKindStatuses that are IsKindVar and extract</span><span>
</span><a name="line-2038"></a><span class="hs-comment">-- the kind variables' Names out.</span><span>
</span><a name="line-2039"></a><span class="hs-identifier">catKindVarNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Data.Aeson.TH.html#StarKindStatus"><span class="hs-identifier hs-type">StarKindStatus</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Name</span><span class="hs-special">]</span><span>
</span><a name="line-2040"></a><a name="catKindVarNames"><a href="Data.Aeson.TH.html#catKindVarNames"><span class="hs-identifier">catKindVarNames</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapMaybe</span><span> </span><a href="Data.Aeson.TH.html#starKindStatusToName"><span class="hs-identifier hs-var">starKindStatusToName</span></a><span>
</span><a name="line-2041"></a></pre></body></html>